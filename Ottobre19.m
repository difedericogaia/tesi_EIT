%trattenere il respiro
baseline=[236.86,392.53,267.36,464.37,324.65,280.16,637.77,1689.33,1232.56,518.99,497.24,2684.94,2129.94,923.54,415.79,224.50,242.72,789.16,549.54,247.34,149.88,323.59,459.98,359.05,294.93,207.39,374.74,332.44,340.55,218.00,1241.91,1479.55,1335.17,1210.40,211.53,403.45,524.14,569.36,417.02,259.98]';
hold_data=[250.68,288.11,373.62,444.46,322.61,276.63,1082.61,2228.14,2073.51,646.01,438.55,1199.76,932.50,647.45,375.45,378.48,687.31,856.24,563.69,235.65,138.52,330.97,455.37,337.64,287.25,199.64,371.08,324.01,342.60,218.70,1164.61,1490.75,1347.09,1141.88,204.40,374.38,532.46,594.30,403.79,253.83;
252.32,296.46,370.96,442.65,322.61,287.32,980.31,2730.19,2420.79,622.37,482.25,1265.89,927.15,662.61,375.45,382.42,719.34,819.60,556.38,249.87,145.58,324.16,467.93,338.82,300.86,204.86,366.39,324.49,351.89,219.81,1241.91,1571.10,1317.01,1155.71,204.75,371.67,544.53,576.65,407.10,251.21;
249.80,288.18,375.31,453.24,322.46,278.84,979.95,2600.80,1905.07,619.51,419.32,1155.12,948.46,605.49,369.69,345.95,671.41,876.11,582.87,225.25,127.87,311.89,448.86,343.15,276.19,191.93,365.27,318.39,349.57,206.41,1046.63,1398.69,1230.78,948.46,172.17,360.67,500.00,598.49,403.90,225.41;
230.39,293.11,366.21,442.85,310.88,228.49,989.20,2389.08,1761.50,546.78,377.29,1187.80,948.46,536.99,307.67,331.72,704.27,843.30,563.66,188.41,112.72,314.96,445.63,322.26,256.29,177.34,366.09,318.45,327.73,204.39,957.00,1525.96,1155.71,867.43,151.36,332.08,452.81,561.52,407.11,213.64;
220.77,284.76,366.65,422.76,308.74,215.44,967.16,2371.14,1864.37,500.86,388.03,1114.86,882.31,503.72,305.54,336.24,697.47,866.31,556.74,184.86,113.21,317.41,447.52,326.30,263.91,181.53,359.48,308.92,329.95,204.46,1016.80,1450.86,1180.23,910.78,153.38,332.08,469.01,550.01,407.10,214.35;
233.05,288.06,379.01,448.02,306.81,241.98,1019.21,2294.01,1868.08,547.19,405.21,1108.59,899.79,564.95,344.61,357.65,690.10,893.21,576.32,214.94,127.27,329.69,475.41,328.46,290.58,196.52,365.20,320.54,338.26,215.25,1122.31,1456.11,1245.57,1030.67,188.63,345.80,504.89,589.76,420.10,251.21;
252.38,296.50,371.44,466.07,320.50,286.19,966.47,2420.79,2317.30,588.25,471.02,1468.59,944.11,653.30,376.81,406.29,720.76,839.11,594.50,247.72,150.68,334.30,451.07,340.88,300.94,211.82,369.81,321.70,346.07,225.83,1102.43,1456.11,1185.57,1155.71,229.36,365.94,559.62,553.62,427.09,271.35;
246.66,301.72,370.87,460.41,320.37,297.70,1035.91,2488.21,2348.67,581.37,508.85,1460.83,947.33,708.08,365.28,422.76,750.46,822.55,588.63,250.25,155.18,327.55,451.07,342.30,311.94,218.92,387.39,324.01,352.55,229.91,1199.76,1728.20,1356.95,1181.48,229.40,382.76,573.50,573.43,420.10,286.55;
255.94,296.38,368.34,473.18,316.54,294.96,1005.99,2894.78,2399.51,633.09,507.28,1485.12,985.73,751.43,390.85,444.69,726.81,822.55,561.52,250.94,154.81,331.60,468.01,343.89,321.85,216.28,369.81,320.09,353.26,234.95,1151.33,1390.44,1263.20,1247.78,232.12,388.59,588.94,569.36,413.02,293.00;
256.22,293.08,359.45,475.92,318.21,298.17,1050.36,2548.90,2310.24,660.85,498.20,1543.12,996.46,765.27,388.31,445.63,743.81,840.91,555.47,255.43,155.68,325.07,466.92,338.50,326.94,216.25,378.02,328.58,365.04,235.14,1163.11,1680.25,1272.49,1247.78,231.67,388.50,590.39,556.18,406.48,288.14;
257.30,293.04,361.55,469.42,322.21,292.06,1115.92,2491.14,1802.35,616.28,508.68,1689.33,1016.01,732.72,402.08,434.15,765.01,780.35,579.88,249.58,155.65,324.42,451.07,340.88,316.20,220.97,385.77,318.11,355.60,233.04,1177.42,1571.10,1328.89,1247.78,228.43,374.38,611.66,550.30,406.65,287.89;
255.00,296.49,374.10,475.35,316.49,290.39,1020.82,2491.14,2703.52,616.23,517.40,1386.37,1016.01,722.40,388.31,440.23,761.55,777.56,566.47,253.25,153.84,320.57,454.37,341.78,327.68,220.81,379.77,330.69,349.33,233.04,1066.58,1602.21,1320.93,1131.00,231.71,374.38,591.76,545.42,416.54,286.21;
253.15,293.11,359.45,456.45,324.60,296.43,1098.63,2191.24,1777.29,637.77,505.70,1543.12,1036.33,754.02,391.63,445.44,723.12,826.06,560.95,253.25,153.84,333.67,470.60,342.97,319.30,217.16,391.19,326.06,365.75,231.96,1191.64,1665.13,1335.17,1188.11,232.62,379.46,621.28,562.20,413.02,281.83]';

%% calcolo reference
img=inv_solve(inv_model, baseline, hold_data(:,1));
show_fem(img)
K2=max(img.elem_data);
K1=min(img.elem_data);
colbar = linspace(K1,K2,10);
t_v=colbar; %ticks values
Y = (K2-K1)./2;
X = (K2+K1)./2; 
%%
k=1;
i=1;
while i<13
    img=inv_solve(inv_model, baseline, hold_data(:,k));
    subplot(3,4,i)
    frame=i;
    title(['Frame ',num2str(frame)])
    img.calc_colours.ref_level= X;
    img.calc_colours.clim= Y;
    cb = colorbar; 
    t_l=linspace(1,255,10);
    set(cb,'YTick', t_l'); set(cb,'YTickLabel', t_v');
    %maxima2=[maxima2, max(img.elem_data)];
    show_fem(img,[1,1]) 
    k=k+1;
    i=i+1;
end