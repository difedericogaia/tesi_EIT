%% 11/09/2023 
% variazioni nella baseline
baseline=[893.16,743.15,795.13,850.36,888.34,916.72,950.36,953.03,1056.18,1105.68;
997.55,855.05,906.33,939.48,917.09,927.97,947.23,969.29,1008.13,1068.85;
1605.08,1346.27,1392.95,1676.14,1585.23,1667.77,1675.52,1788.41,1855.28,1937.11;
1333.28,1181.48,1177.91,1386.52,1323.09,1354.50,1357.86,1417.54,1496.05,1555.09;
1131.28,980.39,963.10,994.48,1046.54,1103.51,1166.19,1221.75,1356.59,1433.53;
677.70,575.90,592.71,638.36,647.77,675.66,691.77,730.65,752.52,808.29;
2058.40,1530.41,1771.97,1821.52,2062.12,2204.03,2363.82,2635.85,2734.77,3259.89;
2655.27,1979.04,2011.11,2086.61,2241.71,2413.94,2624.86,3184.54,3308.80,4026.97;
2692.87,1916.35,2011.53,2549.46,2505.92,2906.76,3390.55,3884.34,4660.92,5707.03;
1246.92,1105.64,1093.23,1195.57,1228.99,1285.85,1343.38,1492.67,1595.09,1835.26;
1598.11,1283.45,1409.92,1629.53,1659.41,1723.80,1760.45,1870.75,2053.40,2087.94;
2766.41,1795.36,2130.12,2431.44,2543.09,2608.89,2757.50,2870.51,2918.17,2812.17;
3291.88,2863.05,2536.57,2773.05,3866.86,4924.88,4565.30,4441.56,3457.48,2829.18;
2305.79,1893.46,1940.79,2133.07,2227.30,2433.62,2550.09,2827.20,2789.55,2866.68;
904.40,761.45,788.82,843.78,911.26,920.92,923.54,940.99,1003.99,1069.20;
829.19,715.54,713.86,755.38,789.81,819.62,842.93,876.09,914.39,938.61;
1760.39,1386.86,1454.19,1641.24,1696.97,1785.61,1773.55,1667.27,1487.34,1407.89;
1376.43,1173.66,1238.11,1510.11,1393.74,1396.39,1403.55,1485.34,1437.25,1470.92;
982.76,877.96,865.05,911.61,958.80,963.63,938.40,967.44,1011.74,1042.45;
679.34,627.39,628.07,693.09,681.51,702.00,713.85,757.01,779.87,850.49;
1237.78,994.37,1051.53,1073.56,1112.38,1209.84,1309.78,1433.00,1508.00,1776.02;
1452.38,1177.23,1311.34,1439.78,1475.06,1478.99,1576.96,1646.24,1756.86,2074.67;
1835.89,1353.52,1422.29,1574.89,1541.58,1577.46,1569.49,1627.68,1681.14,1930.38;
2092.76,1688.96,1667.22,1650.62,1958.14,2089.05,2171.49,2417.02,2661.94,3196.53;
1634.17,1393.75,1378.71,1385.95,1510.16,1617.49,1848.44,1935.76,2059.69,2546.16;
706.14,630.85,629.86,664.02,675.57,697.80,713.98,762.49,819.50,858.52;
1427.61,1153.64,1148.21,1173.64,1278.96,1291.24,1387.89,1430.56,1523.43,1702.17;
2346.18,1746.09,1784.72,1848.40,2148.27,2338.48,2673.47,3245.23,3348.82,4026.97;
2507.72,1837.05,1771.97,1841.94,2158.19,2494.18,2887.35,3297.03,3413.48,4565.24;
859.13,725.05,721.48,786.07,772.28,809.35,822.33,838.26,908.91,985.47;
1174.07,927.31,994.02,1107.49,1086.16,1108.27,1091.57,1100.61,1092.02,1139.09;
2973.78,1946.75,2076.10,2449.86,2364.12,2652.60,2334.29,2287.22,1982.65,1834.06;
3802.07,2587.83,2436.75,3205.18,3203.63,3114.77,2561.71,2221.54,1984.06,1716.89;
2006.78,1397.27,1507.00,1665.88,1685.91,1615.75,1478.38,1479.24,1468.87,1433.02;
1184.30,1097.44,1063.58,1190.42,1180.59,1237.74,1260.96,1346.51,1353.94,1443.65;
1270.36,1130.03,1129.58,1251.94,1229.40,1347.80,1447.66,1548.84,1665.78,1804.34;
2286.90,1626.18,1744.96,1931.25,1978.79,2192.44,2334.29,2848.87,2653.88,3085.23;
1532.86,1339.25,1263.32,1428.29,1383.36,1414.70,1342.74,1494.52,1481.06,1595.27;
1437.11,1203.59,1277.75,1347.87,1428.92,1482.06,1553.78,1739.56,1842.28,2110.37;
699.51,600.68,616.58,662.85,656.73,682.83,697.42,747.55,789.72,861.07];
data=[882.17,781.22,789.40,861.88,865.14,917.23,937.75,975.31,1030.74,1113.49;
1004.03,895.40,885.83,951.60,922.60,940.65,948.31,975.65,1010.36,1092.57;
1535.14,1404.31,1413.79,1633.99,1667.64,1669.13,1703.28,1745.92,1813.83,1917.58;
1322.58,1154.08,1221.43,1261.62,1274.31,1341.84,1342.16,1368.91,1480.62,1554.76;
1130.52,930.30,962.28,1110.72,1039.41,1078.84,1169.25,1238.75,1329.38,1458.34;
681.16,606.27,596.22,630.83,655.42,664.73,687.61,716.56,741.51,804.85;
2091.31,1488.08,1711.69,1717.22,1922.75,2178.01,2309.36,2482.62,2718.27,3518.79;
2511.65,1815.77,1949.79,2402.08,2185.93,2376.94,2582.53,2872.15,3413.48,3936.77;
2682.34,1836.41,1987.29,2147.13,2803.35,2712.99,3205.00,3884.34,4702.69,5369.29;
1248.15,1026.69,1088.43,1201.79,1217.71,1288.59,1368.74,1468.51,1576.34,1888.92;
1591.69,1346.27,1412.78,1604.46,1646.50,1815.19,1837.03,2103.82,1985.83,2168.00;
2793.61,2187.93,2152.89,2190.02,2562.51,2748.55,2667.08,3144.96,2867.28,2974.49;
3366.09,2781.08,2505.94,2885.57,3586.12,4484.80,4524.76,3961.10,3539.76,3173.45;
2325.43,1930.16,1921.16,2057.47,2213.97,2475.21,2685.47,2770.43,2968.90,2806.41;
932.23,819.94,794.49,828.21,885.82,929.00,930.17,983.06,999.35,1057.64;
829.74,736.48,709.06,778.21,785.62,796.69,834.83,890.83,918.31,948.85;
1762.49,1487.06,1424.94,1702.05,1696.97,1734.84,1767.30,1599.60,1548.66,1507.45;
1390.93,1170.74,1286.34,1336.14,1449.66,1443.58,1440.22,1516.86,1477.55,1482.71;
996.68,827.65,872.73,906.67,997.85,950.70,943.26,974.15,1020.56,1035.86;
685.86,625.96,626.63,659.18,671.87,703.55,712.21,725.47,784.25,841.20;
1247.58,1067.01,1048.55,1100.93,1170.18,1238.34,1336.22,1450.25,1515.73,1705.60;
1451.07,1252.90,1299.33,1534.31,1422.30,1534.71,1528.83,1635.82,1786.53,2114.45;
1812.43,1501.21,1411.49,1643.78,1536.06,1525.33,1556.30,1683.92,1797.46,1877.07;
2006.78,1626.18,1679.52,1842.54,1933.97,2145.91,2273.29,2621.98,2725.56,3221.57;
1616.13,1428.42,1357.06,1419.12,1510.16,1682.71,1815.69,1969.15,2077.30,2440.54;
709.23,628.98,619.83,661.49,657.33,682.70,703.40,776.91,807.81,859.43;
1427.61,1201.43,1163.32,1158.78,1273.90,1360.81,1385.85,1379.78,1542.90,1671.62;
2422.12,1677.60,1803.71,1858.14,2021.52,2327.70,2523.08,2961.04,3497.41,3769.70;
2461.95,1823.09,1790.55,2103.09,2087.63,2515.91,2776.30,3204.90,3497.41,4174.70;
854.01,712.20,713.06,732.70,760.31,792.31,832.49,850.92,898.40,975.94;
1153.97,1004.97,970.72,1061.92,1097.24,1127.75,1098.08,1103.71,1182.75,1180.27;
2857.86,2074.37,2115.49,2273.96,2445.62,2701.92,2363.82,2383.76,2091.22,1918.65;
3617.61,2483.30,2613.54,2554.63,2985.52,2940.71,2489.84,2170.61,2036.96,1754.58;
2005.14,1516.14,1507.00,1646.33,1667.99,1586.20,1495.74,1520.99,1507.15,1489.82;
1201.34,1014.15,1042.18,1142.64,1242.68,1227.21,1293.28,1338.46,1437.32,1453.53;
1292.77,1135.33,1121.02,1260.99,1248.44,1314.41,1454.63,1502.54,1627.92,1775.54;
2249.19,1808.68,1749.85,1840.00,1999.91,2233.70,2334.29,2607.10,2651.77,2951.96;
1517.54,1236.87,1283.74,1331.72,1321.48,1377.49,1372.01,1461.31,1569.31,1572.98;
1422.06,1247.44,1294.33,1466.78,1441.93,1551.01,1560.02,1658.87,1861.08,2136.91;
702.55,625.96,623.08,679.22,659.30,684.38,711.09,748.96,769.74,857.87];
img=eit_adj(baseline,data);



%% buco 6cm verso elettrodo 1
data=[892.26,774.97,786.00,853.74,828.50,844.29,886.07,946.53,989.22,1051.59;
722.68,638.19,659.05,698.38,686.37,707.03,717.51,774.55,785.79,853.50;
1014.61,900.90,906.33,959.95,949.93,1001.12,1017.56,1064.01,1149.08,1211.82;
695.45,601.14,627.26,701.53,682.91,698.14,723.41,765.91,807.45,860.02;
581.05,518.14,525.40,582.78,570.49,587.11,590.83,607.03,641.78,695.05;
767.59,641.91,681.98,706.35,715.93,743.24,751.55,801.58,829.00,922.13;
2199.92,1704.63,1834.06,2209.36,2073.76,2142.80,2237.79,2207.47,2588.35,2552.26;
1822.20,1576.07,1623.00,1743.98,1814.49,1835.39,1865.96,1892.47,2281.14,2439.28;
1577.75,1263.41,1349.42,1540.83,1578.05,1621.92,1755.89,1894.36,2039.45,2444.01;
662.24,576.35,595.60,629.54,644.66,652.69,674.61,722.56,757.45,822.04;
2081.46,1549.69,1705.58,2163.40,1984.98,2021.50,2008.79,2210.22,2281.14,2305.09;
2742.32,2016.16,2151.36,2835.77,2782.24,2670.89,2663.45,2621.98,2789.55,2965.42;
2519.21,2157.93,2047.73,2145.00,2634.40,2857.42,3233.82,3247.61,3228.30,3284.16;
1131.28,940.88,1026.28,1131.81,1085.61,1153.66,1157.91,1227.65,1376.02,1484.83;
857.23,751.77,750.58,795.45,805.13,847.10,853.04,924.21,958.93,1055.77;
925.43,821.90,809.22,825.46,862.10,888.47,922.33,975.50,1025.79,1079.26;
1543.80,1332.46,1310.59,1442.79,1469.12,1595.27,1693.76,1686.13,1695.50,1807.02;
767.59,680.08,679.52,706.07,736.72,740.54,779.06,814.64,863.60,903.36;
722.68,621.59,645.78,688.69,666.92,707.03,719.24,755.45,825.86,879.74;
756.84,661.83,700.77,768.40,758.48,760.78,789.38,841.43,884.05,977.63;
1372.27,1121.46,1175.21,1334.09,1275.39,1351.86,1497.26,1625.19,1799.96,1982.24;
975.86,837.28,871.70,916.82,887.05,927.12,980.55,1055.70,1121.40,1219.40;
1000.39,835.46,880.93,924.71,949.03,984.26,1014.71,1040.52,1103.15,1209.48;
2149.71,1669.84,1747.67,2076.90,1983.81,2043.70,2334.29,2682.37,2611.80,2888.35;
1870.42,1633.58,1667.22,1812.06,1814.49,1931.70,2038.20,2094.19,2382.21,2608.80;
579.66,502.70,523.02,573.62,555.76,578.99,585.46,619.40,645.70,690.56;
709.75,631.03,616.40,640.25,647.25,689.51,699.63,742.20,790.84,824.98;
1880.11,1363.38,1463.93,1490.97,1710.73,1772.77,1968.61,2197.59,2480.95,2984.80;
2605.49,1748.85,1987.29,2517.21,2443.80,2607.17,2907.78,3189.78,4001.74,4571.43;
904.40,743.18,776.91,877.61,863.94,888.54,903.96,947.63,1019.70,1124.87;
603.36,522.07,531.06,566.72,561.67,573.52,602.24,612.59,648.85,678.09;
1687.26,1464.76,1328.15,1468.44,1531.13,1553.64,1596.51,1501.83,1374.78,1444.05;
2808.51,1928.67,2202.61,2805.73,2314.52,2274.24,2097.80,1953.45,1767.25,1704.42;
1805.07,1442.12,1402.76,1651.80,1558.88,1482.69,1457.59,1402.24,1343.62,1342.90;
1353.27,1110.25,1186.11,1434.11,1356.79,1360.39,1333.77,1323.84,1367.50,1328.86;
670.95,582.54,618.59,676.37,643.20,667.20,685.94,716.46,748.85,825.95;
1148.69,1008.08,1021.55,1038.96,1070.67,1121.71,1126.70,1218.22,1328.42,1449.36;
759.07,646.39,667.70,688.33,704.77,729.22,739.87,799.98,821.76,898.99;
955.01,802.80,833.83,881.79,893.24,926.75,965.78,1042.40,1112.27,1217.21;
572.82,505.35,526.20,566.88,548.28,564.87,572.67,607.58,652.38,693.53];
img=eit_adj(baseline,data);


%% 
data=[887.85,795.90,800.18,823.37,853.55,844.83,886.07,922.40,990.45,1057.71;
726.49,645.80,654.72,689.33,679.51,701.51,723.83,779.82,792.59,859.42;
1001.00,906.09,899.67,926.91,965.77,991.74,1018.16,1078.02,1149.08,1229.98;
702.28,626.62,633.88,699.39,671.70,700.95,730.43,758.46,801.41,871.27;
578.60,513.35,528.18,578.77,570.25,574.15,588.15,603.07,660.19,699.84;
760.11,666.96,689.35,739.64,713.95,747.02,762.99,783.99,839.00,926.28;
2240.75,1696.36,1868.65,2097.11,2037.09,2137.10,2122.82,2274.05,2381.91,2692.64;
1800.30,1489.87,1634.56,1841.19,1816.27,1770.48,1870.02,1892.47,2092.67,2439.28;
1598.29,1258.17,1357.00,1393.13,1546.98,1682.71,1755.89,1922.48,2012.93,2249.86;
667.71,569.22,601.75,639.94,648.71,653.43,677.78,709.08,751.95,819.87;
2045.90,1494.26,1722.13,1917.28,2011.74,1940.32,2002.02,2011.25,2129.46,2376.14;
2781.85,1891.18,2273.40,2694.92,2451.45,2559.91,2723.92,2766.50,2640.46,2859.06;
2478.30,2015.95,2076.10,2271.99,2777.44,2920.56,3116.41,3095.10,3228.30,3284.16;
1131.28,995.77,1035.78,1056.55,1070.67,1144.57,1174.50,1266.42,1329.85,1464.96;
841.52,758.83,747.42,823.41,815.35,851.26,869.12,924.28,962.24,1040.83;
931.73,801.32,823.16,861.56,859.36,885.02,944.22,1002.05,1055.76,1091.44;
1556.86,1249.60,1300.56,1477.15,1503.28,1543.82,1715.50,1696.31,1797.46,1779.91;
775.20,640.81,670.37,732.02,716.89,750.31,787.50,817.18,870.67,918.67;
726.19,647.48,647.16,676.36,679.91,711.80,718.60,778.74,812.20,869.47;
757.11,680.47,700.77,778.17,745.95,777.00,802.91,848.49,901.15,983.16;
1399.03,1132.13,1155.73,1262.58,1323.95,1377.49,1512.88,1683.92,1703.04,1986.97;
968.53,815.30,872.48,915.33,898.76,927.12,973.13,1045.59,1095.69,1188.29;
1013.29,803.78,877.38,991.21,954.97,1013.34,1020.83,1066.42,1101.96,1198.63;
2062.36,1827.50,1782.99,1746.65,2067.36,2174.51,2271.32,2570.60,2541.06,2959.23;
1921.07,1482.23,1676.75,1756.67,1941.93,1966.71,2028.52,2172.74,2228.54,2531.99;
584.20,509.20,524.37,569.08,565.40,576.20,580.50,613.29,630.20,697.61;
717.44,617.21,620.21,642.86,658.06,677.69,695.35,752.21,778.98,828.40;
1877.11,1545.09,1410.42,1468.36,1696.97,1760.87,2004.91,2188.57,2456.46,3112.29;
2655.27,2155.85,2099.28,2517.21,2571.34,2750.56,2765.58,3485.22,3731.82,4530.61;
899.67,794.38,784.22,854.51,865.40,890.79,903.36,935.89,987.65,1089.87;
607.99,545.96,536.32,552.97,559.85,573.98,598.60,630.71,640.00,680.59;
1667.21,1456.78,1364.70,1554.47,1454.84,1494.93,1548.50,1460.16,1366.17,1346.32;
2761.64,2041.22,2236.88,2380.83,2382.72,2163.38,2110.31,1830.60,1707.53,1609.25;
1758.05,1442.90,1430.80,1653.53,1541.21,1463.92,1478.38,1344.04,1320.23,1319.61;
1353.27,1186.29,1207.91,1340.21,1324.88,1383.11,1364.51,1374.70,1451.21,1454.46;
673.49,606.10,622.45,665.62,650.78,679.07,688.21,714.26,762.70,819.39;
1112.88,980.39,1029.80,1091.11,1096.72,1139.37,1161.35,1216.93,1334.99,1461.03;
740.92,642.51,675.36,723.09,697.03,734.32,739.72,803.66,850.13,914.29;
969.04,851.45,857.30,855.72,913.73,932.66,984.30,1049.41,1123.10,1196.40;
575.18,505.75,528.22,551.42,558.27,559.49,570.46,610.56,647.76,686.68];
img=eit_adj(baseline,data);

%% calibrazione 0-1,2-3
baseline=[502.04,493.81,487.44,487.06,506.66,493.70,490.39,490.47,509.41,496.56;
499.11,478.27,491.21,497.96,503.90,506.45,505.16,499.80,508.12,488.24;
881.50,890.22,870.07,883.22,912.32,946.00,921.55,863.54,905.26,932.79;
731.58,733.89,731.57,771.54,736.14,742.62,721.66,750.82,721.44,744.06;
625.23,631.09,605.20,649.37,618.18,641.61,658.61,661.60,678.95,685.71;
398.48,391.71,392.51,371.36,401.29,389.11,389.23,393.45,401.28,381.81;
1247.77,1249.46,1173.91,1288.26,1295.01,1366.24,1319.52,1333.63,1306.31,1294.72;
1544.61,1231.84,1273.08,1235.12,1416.99,1413.45,1490.02,1405.04,1493.21,1349.27;
1596.93,1248.53,1307.70,1218.99,1479.31,1660.55,1787.26,1635.40,1774.79,1554.18;
638.63,658.97,625.66,634.75,634.83,665.83,644.34,660.25,678.70,704.79;
985.06,913.76,933.80,916.77,1006.89,1090.30,1072.46,1141.16,1039.72,1048.90;
1627.24,1557.94,1449.45,1747.70,1573.92,1616.34,1731.40,1530.11,1645.73,1370.18;
2105.88,1949.65,1707.98,1971.03,2113.67,2454.16,2310.51,2196.34,2149.45,1585.16;
1192.14,1155.65,1129.78,1284.55,1276.86,1278.28,1295.73,1381.21,1327.95,1286.22;
484.45,468.64,477.94,485.21,489.22,501.13,498.75,512.09,493.18,490.71;
473.47,459.14,457.86,451.02,466.79,483.23,484.27,482.65,478.22,457.12;
1038.44,894.88,931.15,1001.64,1031.72,1097.82,1071.53,1043.51,1028.56,899.51;
762.92,769.69,744.98,760.56,803.21,800.51,797.14,780.84,797.82,836.53;
498.84,475.29,485.32,504.87,493.10,509.96,509.34,511.44,513.22,496.28;
396.92,412.26,396.71,381.96,410.83,409.50,411.81,401.80,416.08,403.17;
726.72,733.23,695.76,632.66,726.93,729.23,769.31,817.07,789.92,776.47;
837.45,828.00,823.36,798.56,891.01,886.42,880.46,828.31,885.44,874.13;
1001.47,960.90,924.33,931.41,908.96,906.76,881.39,863.54,863.34,841.02;
1232.39,1226.42,1103.93,1076.27,1187.76,1227.08,1313.15,1266.22,1241.32,1210.41;
973.86,973.45,963.85,1067.40,1004.56,1065.48,1048.61,1101.46,1075.38,1030.22;
416.41,398.63,396.13,370.98,396.97,405.18,402.48,401.89,402.40,406.55;
810.89,790.95,685.61,643.82,745.88,752.67,737.82,755.04,777.43,799.54;
1430.60,1272.36,1104.01,1156.20,1154.35,1299.66,1145.94,1486.86,1652.02,1937.72;
1607.13,1206.60,1378.56,1251.48,1427.57,1612.72,1652.86,1748.48,2040.72,2173.07;
461.94,481.01,440.64,430.92,463.75,459.44,466.64,444.68,447.22,457.24;
649.68,600.64,616.28,609.61,649.76,619.31,602.24,552.04,517.30,461.89;
1771.08,1271.38,1418.04,1448.17,1703.94,1601.98,1596.27,1894.95,1496.72,1345.80;
2562.39,2102.14,1917.77,2668.66,2343.62,2160.22,2050.29,1704.81,1505.32,1427.30;
1150.11,1132.22,1064.66,912.98,1010.45,986.39,978.38,902.53,907.35,878.70;
701.56,736.83,696.67,715.88,702.55,735.58,753.33,762.56,773.06,768.07;
649.53,614.45,642.03,666.02,676.20,689.25,707.88,696.21,710.87,715.65;
1208.96,1191.22,1131.45,1153.51,1237.06,1303.62,1231.41,1194.94,1222.31,1162.35;
866.28,835.81,768.19,739.12,813.10,779.83,799.02,753.73,783.81,750.79;
840.02,828.41,825.99,923.06,864.15,900.56,866.43,902.35,897.30,972.01;
402.23,406.17,398.55,386.32,401.31,400.45,396.97,402.21,407.19,403.60];

data=[516.92,520.07,499.03,463.10,503.90,508.10,515.69,506.36,504.04,496.39;
420.01,415.44,419.43,393.18,417.37,419.05,411.81,407.28,414.97,405.31;
597.71,575.68,581.07,539.72,581.38,608.24,596.41,590.48,606.09,602.08;
411.74,407.57,405.31,389.34,411.59,406.67,405.67,400.54,406.81,394.90;
336.84,354.47,335.47,325.46,345.07,344.49,339.89,329.53,340.18,340.05;
432.76,433.27,433.81,400.90,425.53,438.17,430.27,426.04,422.11,424.10;
1212.38,1141.94,1148.38,1228.59,1348.13,1281.29,1295.73,1259.41,1259.84,1271.37;
1087.65,935.78,1037.60,1131.81,1031.72,1083.66,1032.29,1078.94,1110.27,1087.58;
956.81,939.76,866.54,807.87,906.73,966.73,1033.29,1012.72,1025.05,1030.22;
382.43,380.69,378.36,365.79,385.03,388.74,382.09,383.28,390.62,384.69;
1116.04,944.29,1068.01,1061.43,1125.97,1225.89,1290.67,1268.73,1265.14,1219.87;
1668.87,1319.48,1399.90,1660.34,1545.75,1560.82,1467.57,1393.53,1455.82,1367.31;
1570.65,1206.60,1311.74,1245.25,1455.85,1573.25,1531.11,1644.12,1666.44,1554.18;
657.91,691.72,638.37,691.68,668.17,670.44,690.75,670.93,706.81,721.25;
496.45,496.53,488.04,470.54,500.76,514.47,501.82,496.66,509.53,498.22;
526.46,499.27,497.23,478.59,521.26,525.42,528.39,524.59,529.37,505.23;
925.79,867.21,859.60,901.84,928.82,969.20,971.11,905.27,971.79,886.02;
441.91,463.63,431.26,399.67,446.14,436.72,450.19,430.50,446.25,436.49;
418.13,416.16,413.00,409.79,415.24,416.66,413.90,415.37,415.54,399.76;
435.69,441.54,434.59,441.03,450.86,465.98,454.01,452.59,459.82,444.53;
781.32,826.28,752.31,711.60,801.99,827.45,853.62,865.08,852.92,829.04;
565.39,583.74,557.12,509.81,545.50,552.31,563.70,553.39,558.15,551.48;
588.74,546.56,564.89,592.15,581.59,598.07,581.09,577.03,573.27,545.15;
1233.94,1249.46,1113.47,1009.11,1172.15,1244.84,1259.54,1234.03,1186.62,1169.58;
1127.61,1154.28,1081.80,1091.84,1231.19,1209.17,1158.99,1246.77,1128.85,1105.63;
335.52,351.35,334.99,315.78,335.34,335.78,329.46,329.70,332.27,322.39;
409.76,422.52,407.94,380.19,402.05,408.98,400.56,408.46,398.39,393.59;
1078.20,1078.29,957.08,992.48,1022.69,1065.48,1129.93,1135.57,1134.19,1193.67;
1555.90,1421.55,1369.23,1518.62,1507.73,1635.80,1582.63,1666.16,1591.82,1375.69;
517.75,518.85,507.08,525.98,518.30,515.09,523.81,535.40,514.60,512.95;
340.63,346.85,336.01,322.27,332.35,336.87,335.93,326.70,333.60,321.31;
935.96,965.42,896.62,790.68,913.06,937.01,971.11,988.94,968.83,958.60;
1564.28,1382.21,1433.49,1781.67,1603.12,1535.76,1511.45,1315.82,1474.86,1196.27;
987.17,929.41,924.33,877.91,934.89,857.99,871.39,845.95,800.37,804.09;
758.07,729.05,733.77,729.76,760.55,798.02,815.16,849.71,814.54,872.24;
380.58,398.72,389.64,389.75,387.20,389.20,389.70,378.17,386.07,388.73;
657.91,672.40,636.26,649.89,674.79,671.24,669.94,671.83,674.49,687.81;
433.14,436.98,431.23,413.65,432.33,425.40,427.80,428.41,431.97,424.33;
562.60,557.70,542.64,549.40,554.94,555.29,560.69,553.55,610.34,604.35;
334.41,335.76,333.94,330.09,336.39,327.34,330.77,325.05,336.31,326.60];
img = eit_adj(baseline,data);


%% calibrazione 0412
baseline=[919.33,778.57,859.21,888.97,897.84,898.95,929.16,977.00,1009.94,1073.21;
949.38,840.56,889.01,963.76,950.79,908.10,935.93,946.58,999.32,1108.40;
1650.31,1273.82,1493.39,1631.70,1669.87,1685.56,1868.31,1938.24,2039.72,2188.11;
1408.17,1171.97,1278.95,1491.03,1436.01,1370.86,1370.56,1358.31,1431.35,1582.82;
1128.41,985.78,1039.66,1083.17,1141.70,1150.62,1212.59,1247.89,1348.34,1410.05;
706.37,620.53,655.49,666.85,664.08,685.27,696.60,707.72,750.54,800.58;
2141.20,1657.31,1864.02,2185.20,2270.79,2160.17,2499.53,2484.71,2545.50,2788.52;
2627.22,1925.26,2277.78,2698.43,2253.79,2153.52,2214.66,2287.98,2495.72,2532.95;
3032.91,2014.91,2338.70,2268.89,2576.84,2789.80,2855.38,3037.94,3040.28,3221.96;
1168.87,998.06,1063.33,1105.08,1178.55,1166.83,1188.59,1283.23,1382.30,1543.51;
1769.12,1498.76,1534.45,1611.50,1764.05,1888.59,2072.35,2012.46,2402.38,2386.64;
3048.03,2439.35,2493.70,2556.84,2667.84,2494.63,2446.74,2546.03,2553.63,2667.33;
4291.73,2710.72,3115.88,3986.92,3740.65,3915.90,3922.16,4061.95,4062.49,3690.79;
2197.44,1565.70,2055.05,2377.43,2284.08,2377.04,2397.48,2583.83,2607.86,2832.23;
915.69,796.92,861.35,897.12,916.44,892.64,919.27,923.89,1004.14,1082.26;
842.47,704.90,760.51,831.59,826.44,829.16,849.35,856.35,917.06,975.21;
1953.71,1624.76,1601.32,1645.62,1887.83,1910.50,1950.84,2130.46,2001.73,2164.58;
1405.12,1216.07,1305.68,1433.88,1385.76,1526.55,1504.92,1579.10,1750.52,1866.86;
960.25,795.37,863.23,917.31,958.27,946.19,943.44,981.87,1065.22,1102.33;
700.17,598.59,643.56,735.99,688.94,718.30,742.68,755.55,783.79,866.30;
1301.82,1154.72,1170.30,1318.14,1282.28,1308.89,1329.88,1387.80,1398.70,1472.09;
1587.09,1272.13,1381.21,1641.10,1498.59,1545.51,1580.61,1615.10,1718.80,1775.71;
1901.31,1580.08,1514.94,1620.10,1648.07,1569.67,1594.96,1495.55,1549.03,1616.91;
2343.53,1689.12,1831.46,2075.49,1943.30,1938.68,1958.77,1908.93,1872.54,1897.45;
1752.21,1611.33,1618.45,1862.82,1742.17,1738.16,1769.13,1756.17,1786.99,1867.01;
737.01,661.67,674.10,706.56,709.74,722.58,742.22,764.38,805.13,884.35;
1477.12,1110.08,1246.45,1327.23,1311.10,1295.56,1347.36,1411.84,1455.24,1575.07;
2579.75,1953.86,2005.90,2029.40,2344.06,2416.48,2470.22,2934.71,2992.18,3442.59;
2983.11,2031.87,2367.08,2412.43,2631.97,2885.52,3226.72,2846.88,3270.24,3557.70;
840.45,712.12,776.19,834.34,831.31,815.14,836.76,868.45,908.05,991.06;
1175.45,982.47,1017.88,1083.09,1090.60,1109.11,1133.53,1088.91,1191.07,1204.55;
3309.95,2237.09,2317.57,2829.22,2635.32,2468.22,2418.22,2299.61,2117.56,2072.72;
4947.17,3125.29,3094.58,3369.07,3229.40,3172.45,2848.81,2538.51,2637.81,2256.36;
2206.63,1672.99,1757.06,1854.51,1733.49,1691.49,1659.98,1575.60,1718.80,1695.74;
1319.21,1020.55,1154.17,1243.31,1227.88,1236.52,1336.87,1375.91,1504.85,1624.15;
1199.42,1064.87,1093.98,1161.16,1239.30,1265.15,1266.77,1272.97,1360.71,1512.23;
2367.16,1835.23,2006.08,2024.10,2188.43,2231.33,2319.54,2392.88,2352.15,2487.99;
1553.10,1233.27,1354.73,1450.18,1461.98,1383.85,1442.11,1445.84,1487.63,1560.92;
1584.43,1218.73,1402.55,1564.33,1592.19,1612.87,1767.17,1799.47,1987.27,2197.07;
733.47,622.42,677.11,704.46,709.74,710.65,720.63,726.15,774.51,851.88];



data=[924.89,769.84,824.79,872.49,901.20,877.06,916.72,955.43,992.72,1062.93;
754.85,644.20,707.55,733.42,757.93,759.95,751.12,749.31,803.75,865.99;
1063.15,893.34,984.65,1097.14,1019.01,1042.09,1097.41,1158.70,1228.95,1336.54;
740.25,666.02,693.55,710.84,709.62,716.86,725.66,750.48,778.87,861.15;
597.97,548.89,563.90,598.86,592.51,599.40,613.78,630.89,680.59,721.38;
791.35,698.34,735.06,766.20,758.68,764.61,777.48,778.76,835.17,906.79;
2087.50,1744.30,1908.98,2283.17,2108.38,2214.43,2430.32,2737.38,2786.85,2765.99;
2059.48,1777.14,1831.18,2017.27,1876.81,1747.57,1730.10,1811.95,1909.03,2047.28;
1731.39,1520.93,1463.24,1571.45,1598.99,1682.40,1705.36,1908.93,1887.92,2138.50;
690.43,615.53,635.24,669.09,679.10,676.91,693.12,699.66,749.10,815.10;
1952.42,1471.68,1740.74,1907.05,1975.06,2176.83,2386.82,2461.75,2483.09,2701.53;
3104.42,2081.61,2442.66,2939.22,2451.53,2454.45,2404.99,2472.97,2468.90,2575.46;
2917.34,2022.30,2241.78,2397.08,2740.89,2642.02,2757.42,2710.60,2801.64,3168.67;
1177.14,1065.14,1081.58,1244.09,1186.60,1181.55,1226.45,1269.75,1424.74,1547.14;
915.28,820.12,846.52,967.89,911.61,881.95,913.89,916.53,1006.23,1066.20;
937.74,807.13,831.23,925.08,924.50,952.17,976.80,990.18,1091.51,1123.77;
1711.95,1296.73,1410.92,1546.66,1594.41,1692.75,1715.87,1926.25,1862.64,2111.86;
809.00,720.89,727.26,791.51,761.71,784.19,813.34,840.52,888.65,975.21;
759.87,652.73,693.61,774.63,738.66,745.97,765.91,790.63,834.20,885.02;
772.62,697.87,716.64,766.61,784.44,800.47,831.11,846.01,903.26,963.97;
1395.31,1129.32,1234.89,1247.74,1355.28,1388.01,1362.14,1414.36,1391.59,1430.57;
1017.69,861.34,905.58,966.14,956.40,967.97,980.52,1007.26,1041.99,1111.43;
1104.91,913.84,957.74,1081.85,1033.09,1023.21,1034.58,998.95,1056.65,1108.52;
2274.40,1927.05,1769.13,2097.09,1888.45,1875.17,1831.15,1730.77,1782.74,1708.65;
2116.48,1532.12,1795.62,1851.80,1972.94,1926.38,1888.31,1787.38,1945.16,1792.48;
600.86,541.81,563.90,620.14,603.36,594.97,601.64,613.65,651.34,700.85;
741.44,657.58,677.22,740.60,717.45,709.85,739.03,751.78,783.79,876.89;
2029.14,1715.98,1621.48,1751.13,1833.60,1864.65,1979.66,2191.71,2347.90,2830.20;
2925.93,1879.38,2287.60,2854.08,2911.55,2761.94,3053.87,2967.53,3368.52,4126.43;
943.98,863.97,864.37,943.57,914.09,924.50,945.43,980.09,1047.72,1130.34;
611.42,516.35,548.00,587.84,582.13,595.59,599.38,631.88,647.73,700.54;
1673.83,1358.29,1449.77,1585.06,1657.50,1583.12,1627.81,1711.61,1602.98,1675.59;
2999.82,1989.66,2387.11,3082.85,2683.22,2495.00,2445.01,2091.49,2310.97,2154.44;
1853.60,1569.84,1543.14,1814.01,1541.45,1556.11,1521.17,1496.68,1498.21,1558.80;
1432.60,1068.57,1208.66,1440.24,1356.83,1365.94,1496.47,1496.68,1555.50,1656.14;
677.93,620.41,640.89,672.84,678.35,684.05,700.72,714.08,759.70,829.62;
1177.14,1068.93,1104.34,1162.33,1155.22,1151.88,1206.58,1243.37,1324.08,1450.03;
778.93,684.58,741.85,783.69,774.74,765.43,781.86,796.25,840.17,895.63;
986.63,900.27,916.91,978.40,951.00,1010.84,1016.14,1064.42,1156.31,1301.23;
600.69,524.28,559.96,573.64,573.65,576.48,594.09,612.64,642.48,693.99];

img = eit_adj(baseline,data);

%% single frequency 30kHz
n_elec = 8;
n_rings= 1;
options = {'no_meas_current','no_rotate_meas'};
amplitude=5; %amplitude of stimulation current, default=10mA
[st, ms]= mk_stim_patterns(n_elec, n_rings, '{ad}','{ad}', options, amplitude);
inv_model= mk_common_model('g2c0',n_elec); %1024 elementi
inv_model.fwd_model.stimulation = st;
inv_model.fwd_model.meas_select = ms;

h0=[766.90,841.76,1293.04,1155.06,918.53,582.73,1516.93,1976.99,1875.69,1041.43,1342.34,2304.12,2316.64,1577.14,821.90,733.10,1355.89,1141.46,844.82,558.06,1053.55,1202.08,1333.11,1619.11,1427.38,632.17,1104.88,1799.50,2030.39,716.37,959.49,2292.74,2560.03,1671.98,1036.18,1042.61,1884.00,1276.26,1225.54,618.08]';
h1=[725.39,638.34,875.63,623.02,517.45,669.15,1627.46,1552.21,1259.91,589.67,1535.06,2224.66,1785.26,973.98,782.89,827.75,1221.92,670.72,641.92,642.91,1119.82,816.10,906.31,1763.72,1595.85,508.70,624.10,1486.34,2068.02,801.64,508.58,1342.27,2090.49,1419.49,1125.09,570.18,964.45,654.78,799.13,492.76]';

img_adj_1=inv_solve(inv_model, h0,h1);

img_adj_1.calc_colours.ref_level=0;

show_fem(img_adj_1,[1,1.012])

%% inserito a metà
h1=[716.14,734.51,1148.89,944.93,717.84,661.07,1763.72,1939.46,1552.21,619.11,1498.81,2359.57,2037.40,1118.91,774.99,775.56,1256.80,789.13,750.61,637.80,1047.96,999.80,1173.46,1915.41,1633.89,570.63,929.83,1842.41,2206.53,747.79,752.65,1843.55,2401.36,1516.93,1036.18,602.78,1156.18,800.79,967.53,557.41]';
img_adj_1=inv_solve(inv_model, h0,h1);

img_adj_1.calc_colours.ref_level=0;

show_fem(img_adj_1,[1,1.012])

%% inserito 3/4
h2=[698.11,704.72,1120.30,986.87,778.30,659.15,1780.39,2080.57,1605.46,650.46,1511.51,2359.57,2082.92,1121.54,754.75,782.70,1267.32,814.15,715.51,637.10,1031.37,999.65,1180.55,1971.39,1610.34,567.37,963.59,2037.62,2240.59,741.21,819.10,1949.99,2455.41,1529.35,1014.73,647.64,1197.22,825.40,982.57,556.95]';
img_adj_1=inv_solve(inv_model, h0,h2);

img_adj_1.calc_colours.ref_level=0;

show_fem(img_adj_1,[1,1.012])

%% inserito tutto
h3=[755.75,828.47,1347.66,1179.91,928.12,595.74,1616.90,1939.46,1829.52,1026.83,1431.10,2301.57,2322.49,1592.69,821.90,746.43,1358.49,1119.24,847.83,576.12,1015.28,1202.26,1370.13,1748.63,1501.09,616.35,1133.98,1908.13,2112.24,719.78,994.15,2372.33,2582.16,1629.48,1014.30,993.62,1848.79,1253.66,1208.83,604.59]';
img_adj_1=inv_solve(inv_model, h0,h3);

img_adj_1.calc_colours.ref_level=0;

show_fem(img_adj_1,[1,1.012])


%% inserimento progressivo
baseline=[759.35,839.76,1379.22,1155.59,994.33,609.76,1631.08,1944.72,2388.10,1105.68,1449.34,2224.58,3245.48,1887.62,877.21,720.26,1525.77,1266.16,903.58,601.98,1051.88,1282.07,1376.83,1663.56,1558.47,651.27,1227.31,2169.01,2564.14,721.22,1029.10,2416.54,2929.34,1780.41,1086.55,1111.27,2005.05,1327.02,1247.22,612.96]';
data=[726.83,651.86,900.41,629.55,535.43,671.57,1710.04,1517.04,1368.07,601.51,1639.43,2173.10,2329.78,1044.53,834.15,809.31,1353.00,679.91,667.03,678.27,1135.21,846.99,927.25,1742.42,1749.55,539.37,648.09,1631.08,2564.14,802.48,517.81,1397.91,2350.59,1555.78,1173.03,589.04,1041.91,668.31,822.65,513.77;
747.99,654.41,901.24,629.55,539.29,671.57,1710.04,1505.92,1359.33,601.98,1627.39,2224.58,2329.78,1039.47,821.73,805.28,1376.17,686.89,673.65,681.13,1163.05,909.03,980.18,1647.02,1742.87,552.41,673.06,1591.41,2564.14,796.88,515.95,1510.03,2552.69,1672.55,1209.98,643.54,1184.18,737.49,915.94,526.83;
775.33,684.03,961.54,671.05,534.15,644.90,1624.08,1553.42,1490.68,661.58,1588.20,2284.64,2471.43,1191.15,865.80,794.59,1464.94,789.15,717.15,638.37,1185.60,950.86,1006.97,1659.77,1675.63,562.72,697.82,1676.30,2527.94,787.49,514.69,1522.64,2488.82,1679.53,1206.62,663.17,1205.62,755.18,920.95,530.51;
778.14,684.03,957.89,671.05,534.15,638.08,1650.08,1541.91,1490.68,658.98,1553.42,2200.20,2595.45,1203.03,870.36,789.15,1460.57,804.73,720.26,638.37,1170.79,975.68,1006.28,1618.74,1634.93,570.99,740.85,1606.43,2527.94,777.30,565.05,1718.07,2593.46,1733.89,1205.62,742.10,1346.90,846.53,998.93,553.18;
766.23,681.85,997.71,712.16,567.56,636.21,1555.78,1519.03,1550.65,709.77,1550.65,2196.57,2624.32,1302.93,857.95,789.15,1447.35,831.78,719.27,624.75,1156.34,1001.81,1016.65,1647.02,1646.64,576.92,750.09,1634.31,2566.07,770.98,560.16,1614.05,2640.96,1702.67,1168.60,728.05,1366.54,834.86,998.93,561.63;
769.71,691.85,998.61,735.10,585.11,627.21,1557.71,1569.81,1606.43,723.02,1553.42,2149.79,2841.76,1350.61,865.80,782.65,1555.78,882.64,728.02,621.68,1163.40,1029.28,1033.75,1588.20,1705.64,584.05,788.50,1672.55,2523.35,774.62,580.91,1718.07,2753.82,1706.63,1221.30,745.34,1397.91,862.85,1036.53,564.12;
753.97,684.03,1009.34,765.71,612.70,623.07,1555.78,1581.96,1756.15,807.68,1536.51,2281.93,2841.76,1467.45,845.89,778.90,1575.91,954.33,707.58,614.59,1170.79,1108.50,1045.28,1525.57,1663.56,597.70,842.68,1724.03,2464.15,772.57,661.52,1908.07,2792.71,1799.85,1196.09,829.88,1560.95,964.98,1094.46,576.39;
727.46,676.95,1037.65,815.65,670.98,616.14,1545.68,1650.08,1864.11,813.69,1539.41,2273.85,2892.11,1467.45,819.72,785.33,1575.91,966.52,715.79,611.34,1128.23,1121.62,1074.90,1606.43,1651.49,608.76,892.62,1766.26,2625.87,767.36,720.49,1926.34,2792.71,1799.85,1182.29,870.83,1657.30,1053.57,1127.94,586.49;
729.30,676.39,1037.65,853.51,761.27,605.36,1505.92,1611.18,1940.96,946.21,1498.39,2149.79,3094.95,1710.04,832.09,772.57,1663.95,1092.56,736.99,591.65,1149.31,1232.08,1081.43,1498.39,1599.86,617.23,971.19,1741.67,2457.36,754.17,801.91,2076.95,2887.29,1855.31,1189.18,970.48,1850.42,1168.60,1194.63,592.28;
754.61,702.16,1111.27,901.13,790.35,598.85,1505.92,1698.61,2028.66,998.93,1498.39,2362.14,3079.86,1759.55,846.99,768.90,1670.02,1141.81,765.26,588.61,1135.21,1239.34,1139.27,1528.20,1607.26,627.21,1044.53,1785.25,2465.01,751.67,846.23,2196.57,2908.79,1865.03,1190.33,1019.33,1966.67,1255.93,1227.31,601.98]';
i=1;
k=1;
while i<11
    img=inv_solve(inv_model, baseline, data(:,k));
    subplot(2,5,i)
    frame=i;
    title(['Frame ',num2str(frame)])
    show_fem(img,[1,1.012]) 
    k=k+1;
    i=i+1;
end
%% inserimento progressivo, paragone frame precedente
%data=[759.35,839.76,1379.22,1155.59,994.33,609.76,1631.08,1944.72,2388.10,1105.68,1449.34,2224.58,3245.48,1887.62,877.21,720.26,1525.77,1266.16,903.58,601.98,1051.88,1282.07,1376.83,1663.56,1558.47,651.27,1227.31,2169.01,2564.14,721.22,1029.10,2416.54,2929.34,1780.41,1086.55,1111.27,2005.05,1327.02,1247.22,612.96;
data=[726.83,651.86,900.41,629.55,535.43,671.57,1710.04,1517.04,1368.07,601.51,1639.43,2173.10,2329.78,1044.53,834.15,809.31,1353.00,679.91,667.03,678.27,1135.21,846.99,927.25,1742.42,1749.55,539.37,648.09,1631.08,2564.14,802.48,517.81,1397.91,2350.59,1555.78,1173.03,589.04,1041.91,668.31,822.65,513.77;
747.99,654.41,901.24,629.55,539.29,671.57,1710.04,1505.92,1359.33,601.98,1627.39,2224.58,2329.78,1039.47,821.73,805.28,1376.17,686.89,673.65,681.13,1163.05,909.03,980.18,1647.02,1742.87,552.41,673.06,1591.41,2564.14,796.88,515.95,1510.03,2552.69,1672.55,1209.98,643.54,1184.18,737.49,915.94,526.83;
775.33,684.03,961.54,671.05,534.15,644.90,1624.08,1553.42,1490.68,661.58,1588.20,2284.64,2471.43,1191.15,865.80,794.59,1464.94,789.15,717.15,638.37,1185.60,950.86,1006.97,1659.77,1675.63,562.72,697.82,1676.30,2527.94,787.49,514.69,1522.64,2488.82,1679.53,1206.62,663.17,1205.62,755.18,920.95,530.51;
778.14,684.03,957.89,671.05,534.15,638.08,1650.08,1541.91,1490.68,658.98,1553.42,2200.20,2595.45,1203.03,870.36,789.15,1460.57,804.73,720.26,638.37,1170.79,975.68,1006.28,1618.74,1634.93,570.99,740.85,1606.43,2527.94,777.30,565.05,1718.07,2593.46,1733.89,1205.62,742.10,1346.90,846.53,998.93,553.18;
766.23,681.85,997.71,712.16,567.56,636.21,1555.78,1519.03,1550.65,709.77,1550.65,2196.57,2624.32,1302.93,857.95,789.15,1447.35,831.78,719.27,624.75,1156.34,1001.81,1016.65,1647.02,1646.64,576.92,750.09,1634.31,2566.07,770.98,560.16,1614.05,2640.96,1702.67,1168.60,728.05,1366.54,834.86,998.93,561.63;
769.71,691.85,998.61,735.10,585.11,627.21,1557.71,1569.81,1606.43,723.02,1553.42,2149.79,2841.76,1350.61,865.80,782.65,1555.78,882.64,728.02,621.68,1163.40,1029.28,1033.75,1588.20,1705.64,584.05,788.50,1672.55,2523.35,774.62,580.91,1718.07,2753.82,1706.63,1221.30,745.34,1397.91,862.85,1036.53,564.12;
753.97,684.03,1009.34,765.71,612.70,623.07,1555.78,1581.96,1756.15,807.68,1536.51,2281.93,2841.76,1467.45,845.89,778.90,1575.91,954.33,707.58,614.59,1170.79,1108.50,1045.28,1525.57,1663.56,597.70,842.68,1724.03,2464.15,772.57,661.52,1908.07,2792.71,1799.85,1196.09,829.88,1560.95,964.98,1094.46,576.39;
727.46,676.95,1037.65,815.65,670.98,616.14,1545.68,1650.08,1864.11,813.69,1539.41,2273.85,2892.11,1467.45,819.72,785.33,1575.91,966.52,715.79,611.34,1128.23,1121.62,1074.90,1606.43,1651.49,608.76,892.62,1766.26,2625.87,767.36,720.49,1926.34,2792.71,1799.85,1182.29,870.83,1657.30,1053.57,1127.94,586.49;
729.30,676.39,1037.65,853.51,761.27,605.36,1505.92,1611.18,1940.96,946.21,1498.39,2149.79,3094.95,1710.04,832.09,772.57,1663.95,1092.56,736.99,591.65,1149.31,1232.08,1081.43,1498.39,1599.86,617.23,971.19,1741.67,2457.36,754.17,801.91,2076.95,2887.29,1855.31,1189.18,970.48,1850.42,1168.60,1194.63,592.28;
754.61,702.16,1111.27,901.13,790.35,598.85,1505.92,1698.61,2028.66,998.93,1498.39,2362.14,3079.86,1759.55,846.99,768.90,1670.02,1141.81,765.26,588.61,1135.21,1239.34,1139.27,1528.20,1607.26,627.21,1044.53,1785.25,2465.01,751.67,846.23,2196.57,2908.79,1865.03,1190.33,1019.33,1966.67,1255.93,1227.31,601.98]';
i=1;
k=2;
while i<10
    img=inv_solve(inv_model, data(:,1), data(:,k));
    subplot(2,4,i)
    frame=i;
    title(['Frame ',num2str(frame)])
    show_fem(img,[1,1.012]) 
    k=k+1;
    i=i+1;
end


%% inserimento progressivo 2
data=[747.32,650.46,896.54,644.88,544.18,674.25,1670.29,1553.42,1376.83,603.67,1693.05,2471.43,2352.81,1044.53,824.83,814.99,1380.42,689.80,669.88,681.13,1142.24,850.99,936.28,1698.19,1755.68,535.88,651.16,1643.46,2497.65,807.61,523.27,1430.04,2408.14,1564.98,1222.34,591.09,1027.11,663.61,819.51,514.47;
736.30,652.43,906.69,635.55,544.18,673.68,1718.65,1591.41,1379.22,596.05,1684.41,2408.54,2373.87,1044.53,828.94,810.87,1384.33,684.82,679.37,669.53,1200.80,879.29,975.52,1855.31,1762.35,562.26,717.55,1706.63,2658.99,801.85,545.09,1486.64,2447.28,1624.08,1183.33,583.36,1036.69,680.01,878.07,545.73;
738.87,659.55,978.58,725.35,558.47,676.95,1767.05,1679.53,1467.45,620.75,1584.00,2434.84,2595.45,1173.03,873.78,786.81,1447.35,799.68,774.03,664.85,1163.58,996.44,1056.38,1702.67,1718.07,586.10,771.95,1738.07,2527.94,764.76,526.50,1535.58,2528.40,1618.74,1213.94,624.61,1175.43,771.78,969.39,562.43;
807.67,719.42,1068.41,747.57,552.86,656.98,1734.64,1676.30,1528.20,627.76,1555.78,2471.43,2649.40,1186.32,890.20,781.54,1516.24,869.82,782.97,637.33,1170.51,1052.48,1106.18,1689.47,1658.34,601.01,789.45,1752.15,2636.25,761.21,539.15,1657.30,2613.07,1738.07,1237.39,674.25,1336.92,874.45,1056.22,572.35;
825.71,773.20,1140.20,768.34,553.34,631.96,1701.97,1724.03,1611.18,688.42,1555.78,2304.26,2759.19,1379.22,931.57,767.79,1550.44,909.44,820.39,636.61,1170.79,1070.50,1120.17,1659.77,1680.74,582.01,798.97,1770.68,2632.08,758.64,542.25,1782.18,2733.22,1770.68,1228.68,753.97,1523.04,944.55,1064.26,562.43;
793.40,742.10,1118.42,794.09,583.56,627.21,1555.78,1698.61,1724.03,760.44,1539.41,2278.55,2943.77,1467.45,881.92,784.17,1575.91,962.46,776.59,614.31,1156.07,1134.88,1092.41,1606.43,1663.56,610.99,904.85,1770.68,2554.59,761.21,641.03,1833.50,2808.35,1747.57,1191.30,783.17,1546.95,966.93,1095.88,592.28;
770.36,716.96,1104.18,838.40,643.68,620.75,1541.91,1710.04,1808.56,800.83,1517.04,2330.14,2996.78,1514.66,865.80,767.79,1581.51,988.33,797.30,617.64,1128.23,1128.23,1139.27,1627.39,1663.56,598.85,909.81,1824.09,2554.59,764.76,641.03,1928.79,2864.92,1720.24,1203.03,867.22,1702.81,1085.60,1192.99,602.91;
779.60,757.33,1204.42,913.58,710.67,616.14,1611.18,1777.68,1966.67,908.16,1498.39,2304.26,2943.77,1724.03,895.05,749.65,1608.09,1109.44,857.36,605.82,1114.81,1255.93,1269.47,1623.23,1623.23,627.21,1039.47,2024.39,2675.20,736.61,750.62,2273.85,2844.38,1834.73,1146.72,1003.50,1889.92,1230.80,1267.84,612.00;
753.29,754.61,1306.22,1054.67,920.95,608.76,1600.68,2008.73,2308.45,1095.88,1505.92,2416.54,3326.33,1901.76,863.53,762.97,1635.55,1249.49,847.88,594.44,1108.35,1308.51,1293.02,1611.54,1611.54,640.53,1173.03,1981.80,2597.95,734.22,964.85,2356.16,2992.19,1752.15,1160.90,1095.88,1981.80,1356.97,1312.93,609.71;
756.66,757.33,1324.63,1041.42,910.97,608.76,1654.71,1897.47,2253.03,1056.22,1514.66,2399.04,3293.27,1923.09,853.51,754.50,1657.43,1224.00,823.32,603.57,1095.39,1280.16,1251.00,1643.46,1595.91,638.08,1135.50,2019.21,2636.25,737.53,960.10,2291.81,2947.41,1738.07,1138.18,1083.27,2008.73,1299.85,1277.30,623.36]';
i=1;
k=2;
while i<10
    img=inv_solve(inv_model, data(:,1), data(:,k));
    subplot(2,4,i)
    frame=i;
    title(['Frame ',num2str(frame)])
    show_fem(img,[1,1.012]) 
    k=k+1;
    i=i+1;
end
%% inserimento progressivo 3 (10 frame), stessa colorbar
data=[768.18,678.87,930.50,667.72,560.98,697.73,1772.66,1615.79,1412.49,626.23,1703.66,2425.00,2261.99,1088.92,854.82,847.03,1412.94,715.22,700.47,710.42,1172.07,890.59,971.37,1804.31,1846.74,556.43,678.41,1700.49,2610.02,837.97,538.91,1487.87,2505.45,1618.50,1244.76,616.30,1088.88,692.13,868.76,536.47;
766.19,680.97,935.38,673.04,559.62,698.35,1789.73,1597.72,1435.64,617.58,1768.51,2459.65,2440.78,1071.76,844.25,841.45,1404.94,704.10,692.60,709.19,1186.62,886.67,976.44,1771.62,1806.35,553.72,685.18,1700.49,2647.40,837.97,543.59,1511.12,2548.57,1606.29,1305.01,622.43,1082.28,694.92,866.23,539.42;
800.50,703.99,994.44,694.91,564.70,693.38,1758.10,1630.77,1493.98,614.91,1665.21,2466.84,2513.90,1102.85,890.43,823.19,1450.34,768.98,759.81,711.33,1223.80,981.73,1066.67,1818.45,1819.57,589.52,732.95,1730.72,2610.02,801.46,540.57,1510.93,2613.83,1684.04,1285.38,614.14,1138.77,752.25,960.23,565.36;
798.30,731.02,1071.34,728.95,560.98,691.20,1790.95,1645.93,1471.33,625.02,1665.21,2495.00,2629.72,1186.67,916.69,816.36,1507.99,832.65,814.78,695.33,1231.37,1034.33,1108.99,1858.29,1773.85,600.91,786.91,1776.09,2610.02,786.91,548.03,1585.22,2546.36,1687.37,1268.57,621.99,1211.12,800.50,1014.57,588.26;
812.32,752.26,1136.53,773.51,572.73,683.06,1789.73,1748.02,1504.52,629.05,1676.81,2466.84,2495.00,1209.60,920.39,804.45,1507.99,836.80,821.60,701.16,1208.80,1068.62,1130.18,1804.31,1742.48,608.40,814.10,1780.00,2541.52,775.06,548.64,1558.04,2546.36,1658.59,1262.02,625.52,1219.42,821.54,1032.71,591.81;
818.46,772.91,1141.14,793.29,571.30,685.16,1806.98,1765.56,1528.19,631.35,1661.28,2432.66,2590.28,1214.51,920.39,791.52,1485.24,847.03,836.80,690.44,1186.62,1080.15,1155.72,1832.59,1753.33,624.50,839.07,1828.17,2612.87,784.89,559.55,1597.18,2677.67,1717.16,1244.76,625.99,1234.93,828.53,1050.07,599.03;
822.28,779.11,1169.66,811.21,578.56,686.87,1789.73,1786.06,1603.86,633.14,1606.29,2438.84,2620.05,1214.51,935.45,795.33,1521.84,858.79,839.78,694.12,1179.32,1092.63,1169.66,1804.31,1753.33,632.03,858.02,1838.21,2677.15,778.65,561.32,1623.97,2610.49,1684.04,1253.35,629.56,1244.76,834.81,1083.68,605.53;
822.28,792.44,1184.84,814.10,585.49,683.64,1807.61,1786.06,1566.29,633.65,1618.50,2495.00,2670.00,1256.47,941.90,790.11,1541.04,907.82,870.87,683.64,1201.36,1130.96,1197.49,1888.52,1730.03,642.72,891.57,1899.41,2685.40,770.93,571.84,1667.19,2800.00,1696.82,1253.35,649.67,1313.34,889.06,1108.30,610.86;
848.46,815.38,1221.75,849.44,593.60,670.41,1772.66,1819.57,1603.86,646.78,1603.86,2466.84,2735.42,1309.01,957.77,786.38,1531.44,921.33,879.98,678.91,1186.62,1144.34,1211.12,1838.21,1761.01,641.47,904.52,1878.69,2573.26,772.52,575.23,1651.68,2649.38,1744.32,1229.98,643.00,1315.04,932.64,1137.35,618.56;
853.15,825.40,1262.02,865.62,593.10,666.42,1789.73,1870.77,1703.66,663.87,1618.50,2438.84,2735.42,1351.32,960.39,783.80,1531.44,951.06,886.61,673.45,1186.44,1143.54,1243.52,1804.31,1705.11,647.57,924.11,1937.14,2612.87,763.98,583.72,1757.23,2704.76,1744.32,1245.79,678.31,1411.51,957.09,1150.80,627.15;
855.20,845.10,1277.56,873.35,600.91,665.84,1773.85,1887.26,1739.10,694.92,1603.86,2379.07,2779.69,1405.53,968.57,783.80,1590.68,995.34,921.33,663.20,1186.62,1193.61,1258.17,1790.19,1742.48,651.90,953.74,1953.87,2647.40,757.11,598.10,1801.33,2788.92,1744.32,1229.98,719.60,1511.12,1001.99,1193.11,635.27]';

%K1 = min(data,[],"all");
%K2 = max(data,[],"all");
K1=-1000;
K2=1000;
colbar = linspace(K1,K2,10);
t_v=colbar; %ticks values
Y = (K2-K1)./2;
X = (K2+K1)./2;


i=1;
k=2;

while i<11
    img=inv_solve(inv_model, data(:,1), data(:,k));
    subplot(2,5,i)
    frame=i;
    title(['Frame ',num2str(frame)])
    show_fem(img,[1,1.012]) 
    img.calc_colours.ref_level= X;
    img.calc_colours.clim= Y;
    cb = colorbar; 
    t_l=linspace(1,255,10);
    set(cb,'YTick', t_l'); set(cb,'YTickLabel', t_v');
    %set(img,'LineStyle','none');
    k=k+1;
    i=i+1;
end
%% inv_model
n_elec = 8;
n_rings= 1;
options = {'no_meas_current','no_rotate_meas'};
amplitude=5; %amplitude of stimulation current, default=10mA
[st, ms]= mk_stim_patterns(n_elec, n_rings, '{ad}','{ad}', options, amplitude);
inv_model= mk_common_model('g2c0',n_elec); %1024 elementi
inv_model.fwd_model.stimulation = st;
inv_model.fwd_model.meas_select = ms;
%% stessa colorbar, provo a trovare il max delle immagini
img=inv_solve(inv_model, data(:,1), data(:,2));
K2=max(img.elem_data);
K1=min(img.elem_data);
colbar = linspace(K1,K2,10);
t_v=colbar; %ticks values
Y = (K2-K1)./2;
X = (K2+K1)./2;   

i=1;
k=2;

while i<11
    img=inv_solve(inv_model, data(:,1), data(:,k));
    subplot(2,5,i)
    frame=i;
    title(['Frame ',num2str(frame)])
    show_fem(img,[1,1.012]) 
    img.calc_colours.ref_level= X;
    img.calc_colours.clim= Y;
    cb = colorbar; 
    t_l=linspace(1,255,10);
    set(cb,'YTick', t_l'); set(cb,'YTickLabel', t_v');
    %set(img,'LineStyle','none');
    k=k+1;
    i=i+1;
end

%% inserimento progressivo 4
data=[849.90,704.07,966.17,675.22,592.69,757.08,2125.84,1795.28,1611.40,671.57,2129.17,2733.28,2806.68,1187.91,891.88,1027.14,1675.88,804.73,721.40,804.93,1395.95,999.55,990.65,1911.62,2124.52,610.37,709.72,1841.80,3031.74,973.21,577.70,1499.07,2446.91,1634.63,1273.00,673.34,1213.91,745.64,943.27,565.80;
846.79,703.51,979.38,676.51,596.05,760.84,2104.70,1761.85,1660.59,661.33,2096.16,2597.40,3059.06,1252.46,868.70,1017.25,1825.61,860.94,691.48,776.57,1404.74,1050.48,1072.68,1859.31,1984.44,625.89,788.71,1897.15,3121.58,926.53,689.02,1750.50,2743.21,1766.53,1342.10,897.34,1652.94,1026.54,1202.86,604.35;
860.02,762.06,1228.16,945.35,744.15,709.72,2063.03,1980.14,2103.84,908.41,1902.04,2704.13,3359.15,1626.25,900.63,938.19,1838.21,1084.09,805.78,741.93,1393.20,1231.25,1318.73,1876.57,1894.01,655.98,962.70,2068.92,2971.95,878.09,773.09,2060.60,3278.36,1879.17,1293.04,974.44,1810.25,1121.63,1267.20,605.28;
889.99,849.90,1374.89,1076.91,784.58,708.25,2062.22,2168.70,2314.72,991.55,1883.15,2738.00,3655.15,1779.50,934.86,928.53,1890.58,1162.46,874.74,724.64,1404.74,1269.08,1456.28,1860.20,1928.08,665.51,1049.33,2158.90,3004.52,866.73,797.39,2168.70,3180.66,1913.40,1283.83,1027.47,1929.08,1220.35,1276.44,609.33;
901.09,867.86,1403.34,1138.07,836.20,702.29,2083.76,2286.40,2479.96,1063.09,1864.52,2700.49,3531.29,1879.17,950.61,919.02,1890.58,1224.09,898.29,737.72,1376.33,1300.72,1519.01,1893.07,1909.70,691.63,1156.18,2187.50,3134.27,861.60,867.48,2310.16,3393.73,1879.17,1275.48,1083.15,2003.61,1321.22,1358.43,642.30;
889.21,897.62,1484.62,1204.91,856.64,693.63,2063.03,2214.76,2572.35,1088.07,1838.21,2733.28,3858.81,1913.40,950.61,892.58,1924.79,1264.77,918.46,718.82,1340.99,1359.58,1550.73,1843.96,1894.01,715.19,1174.81,2208.78,3144.24,855.65,864.03,2262.82,3229.95,1928.58,1281.49,1081.75,2042.51,1330.40,1386.10,650.23;
896.82,897.62,1425.09,1212.59,867.72,687.88,2042.51,2170.11,2508.91,1094.53,1838.21,2695.07,4164.19,1957.12,960.49,903.34,1917.44,1338.11,906.50,713.98,1355.44,1388.06,1530.69,1843.38,1876.57,727.24,1169.07,2187.50,3187.35,872.85,833.08,2187.50,3278.36,1959.02,1273.00,1081.75,2063.03,1366.64,1378.49,668.48;
901.09,879.14,1413.57,1116.21,744.91,693.63,2042.51,2102.13,2367.30,968.09,1817.81,2704.13,3721.00,1860.35,974.44,911.11,1938.57,1255.87,912.51,723.73,1384.75,1300.72,1396.95,1843.38,1928.08,696.99,957.79,2091.93,2994.57,884.39,681.59,2036.65,3227.63,1908.58,1282.76,969.35,1859.31,1241.34,1300.72,645.64;
930.30,804.19,1201.10,846.75,629.65,698.24,1876.57,1928.08,1983.72,835.28,1883.15,2667.98,3307.14,1601.47,1002.32,929.93,1877.18,1051.79,845.56,736.78,1484.62,1224.39,1204.46,1721.59,1842.23,685.32,813.94,1836.93,2994.57,898.29,587.42,1652.94,2951.01,1796.74,1288.68,807.68,1542.47,989.96,1193.70,625.89;
917.68,822.52,1149.13,759.46,596.98,722.24,2003.61,1840.51,1826.73,751.67,1893.86,2601.45,3063.03,1430.46,1003.57,980.10,1825.61,950.11,836.52,773.22,1443.58,1117.98,1126.21,1894.33,2022.97,650.81,752.52,1879.17,3069.00,925.17,564.92,1457.14,2446.91,1699.80,1377.53,670.34,1288.68,822.23,1054.69,591.70;
886.59,744.64,1008.50,684.01,590.79,752.96,2104.70,1857.83,1665.67,663.70,2051.00,2772.19,2776.12,1190.08,912.91,1007.55,1724.41,784.34,719.71,802.48,1452.88,976.47,982.21,1929.08,2042.51,615.38,702.29,1828.00,3160.84,968.09,571.08,1456.85,2488.79,1672.64,1282.76,670.34,1193.70,747.93,930.30,574.56]';

img=inv_solve(inv_model, data(:,1), data(:,6));
K2=max(img.elem_data);
K1=min(img.elem_data);
colbar = linspace(K1,K2,10);
t_v=colbar; %ticks values
Y = (K2-K1)./2;
X = (K2+K1)./2;   

i=1;
k=2;

while i<11
    img=inv_solve(inv_model, data(:,1), data(:,k));
    subplot(2,5,i)
    frame=i;
    title(['Frame ',num2str(frame)])
    show_fem(img,[1,1.012]) 
    img.calc_colours.ref_level= X;
    img.calc_colours.clim= Y;
    cb = colorbar; 
    t_l=linspace(1,255,10);
    set(cb,'YTick', t_l'); set(cb,'YTickLabel', t_v');
    %set(img,'LineStyle','none');
    k=k+1;
    i=i+1;
end

%% inserimento progressivo 5 (calibrazione buco aperto)
data=[1226.76,1024.52,1392.00,984.55,859.73,1127.22,3155.44,2701.38,2379.77,952.20,3052.87,4390.68,4104.19,1708.07,1290.54,1416.61,2369.27,1152.57,1053.14,1177.44,2015.45,1420.59,1446.91,2805.45,2961.38,886.77,1034.99,2581.08,4516.68,1430.15,852.84,2148.80,3733.49,2364.50,1912.14,966.67,1721.25,1103.21,1365.95,821.30;
1231.27,1030.67,1431.33,984.55,859.73,1128.15,3153.39,2701.38,2359.91,956.41,3149.98,4390.68,3964.78,1700.14,1279.77,1403.66,2541.01,1255.45,1067.79,1095.57,2114.62,1551.32,1526.43,2611.58,2803.53,893.42,1077.53,2705.04,4490.81,1475.45,886.15,2564.39,4104.19,2676.18,2027.96,1238.08,2224.01,1408.41,1581.46,812.61;
1234.77,1033.75,1525.27,1097.38,919.50,1015.28,2804.97,2913.35,2992.71,1273.60,2816.82,4390.68,4966.36,2301.58,1270.73,1424.26,2937.07,1508.17,1047.74,1056.61,2194.65,1682.85,1530.17,2611.58,2830.56,859.60,1110.06,2975.34,4516.68,1424.26,928.58,2996.22,4824.56,2899.97,2068.29,1350.23,2420.12,1491.13,1557.75,792.28;
1211.66,1035.93,1533.57,1125.16,934.75,1011.48,2752.62,3091.08,3220.37,1334.01,2797.78,4884.37,5507.97,2428.03,1269.17,1407.65,2948.17,1493.51,1060.41,1038.16,2164.20,1620.05,1594.68,2701.38,2831.54,815.80,1160.51,3040.85,4557.38,1429.80,994.07,3056.59,4951.74,2869.90,1973.21,1442.44,2605.78,1556.51,1607.19,785.24;
1205.45,1059.30,1688.23,1296.58,1060.61,1001.10,2912.81,3365.71,3607.01,1477.55,2816.82,4734.19,5788.30,2684.36,1292.18,1385.66,2981.10,1639.62,1149.00,1031.21,2033.43,1683.17,1880.14,2678.69,2779.59,836.17,1383.64,3448.40,4562.54,1383.64,1141.01,3274.07,5182.51,2869.90,1923.28,1584.09,2801.13,1712.59,1670.89,775.01;
1265.53,1189.79,1936.51,1499.24,1182.32,1001.10,2970.47,3523.12,3786.17,1608.14,2743.13,4808.73,5822.40,2811.00,1314.36,1376.40,2937.07,1675.32,1211.66,1041.01,2047.03,1702.07,2070.41,2724.21,2680.37,850.47,1563.17,3385.40,4836.84,1367.03,1182.25,3168.18,5115.60,2743.13,1899.25,1497.63,2654.12,1596.67,1617.46,776.65;
1194.98,1082.74,1755.75,1407.01,1196.83,1025.94,2998.56,3189.18,3404.15,1409.48,2793.50,4731.88,5308.24,2445.20,1254.36,1369.21,2829.57,1547.43,1116.92,1068.28,2033.43,1692.65,1802.35,2701.38,2804.97,866.48,1388.83,3165.76,4518.69,1378.45,1133.83,2845.75,4197.66,2622.71,1873.80,1407.01,2499.86,1540.73,1688.23,825.26;
1219.41,1090.48,1725.04,1366.20,1141.98,1043.92,2969.90,3123.43,3189.18,1289.02,2850.28,4517.69,5047.00,2323.68,1282.88,1357.12,2729.52,1454.49,1119.01,1075.74,2075.07,1628.59,1750.65,2720.70,2857.87,851.27,1306.91,3102.07,4428.97,1406.77,1047.64,2716.32,4266.17,2582.02,1868.95,1307.69,2254.84,1381.51,1525.27,785.88;
1224.84,1082.74,1686.76,1267.63,1034.00,1055.19,3059.08,3155.44,3156.13,1249.97,2875.06,4590.73,5128.77,2245.16,1293.74,1392.94,2719.82,1367.03,1120.35,1090.97,2089.53,1537.04,1702.07,2828.58,2830.56,830.18,1248.48,3065.34,4693.13,1417.32,1018.86,2676.18,4217.13,2519.31,1913.82,1274.91,2189.83,1351.52,1487.35,785.24;
1224.84,1087.03,1644.25,1232.48,1019.22,1062.54,3029.88,3155.44,3029.28,1225.62,2950.13,4453.79,5047.00,2116.78,1304.77,1400.27,2636.18,1306.91,1081.55,1106.64,2089.53,1477.13,1586.31,2904.77,2968.19,836.17,1160.51,3005.64,4428.97,1422.06,929.53,2277.53,3667.81,2291.16,1804.97,982.61,1721.25,1089.55,1364.84,820.16;
1226.76,1016.92,1425.14,991.78,861.10,1129.03,3123.43,2681.21,2379.77,954.58,3081.47,4328.41,4150.14,1713.96,1316.00,1398.30,2413.96,1125.78,1056.16,1149.45,2089.53,1435.56,1435.82,2825.63,2969.90,892.49,1018.19,2609.64,4150.14,1429.80,837.46,2211.06,3827.64,2421.97,1947.92,958.65,1712.59,1107.76,1363.62,825.26]';

img=inv_solve(inv_model, data(:,1), data(:,6));
K2=max(img.elem_data);
K1=min(img.elem_data);
colbar = linspace(K1,K2,10);
t_v=colbar; %ticks values
Y = (K2-K1)./2;
X = (K2+K1)./2;   

i=1;
k=1;

while i<11
    img=inv_solve(inv_model, data(:,k), data(:,k+1));
    subplot(2,5,i)
    frame=i;
    title(['Frame ',num2str(frame)])
    show_fem(img) 
    img.calc_colours.ref_level= X;
    img.calc_colours.clim= Y;
    %cb = colorbar; 
    %t_l=linspace(1,255,10);
    %set(cb,'YTick', t_l'); set(cb,'YTickLabel', t_v');
    %set(img,'LineStyle','none');
    k=k+1;
    i=i+1;
end
%% inserimento progressivo 6
data=[1243.84,1026.57,1420.04,987.35,860.49,1128.02,3079.01,2744.62,2341.43,958.40,3034.49,4618.52,4115.10,1715.93,1289.71,1405.31,2452.68,1163.67,1040.38,1167.26,2117.79,1410.90,1423.50,2901.12,3012.20,870.07,1021.95,2642.37,4437.02,1441.29,858.79,2242.37,3769.85,2439.00,1952.32,960.04,1725.62,1103.52,1360.33,824.81;
1219.56,1022.74,1412.92,985.44,862.56,1130.86,3111.86,2771.93,2419.12,1010.48,3101.54,4691.17,4484.74,1811.53,1233.60,1425.84,2548.09,1188.34,1035.67,1149.94,2046.68,1391.81,1666.44,3208.89,3135.79,805.11,1219.56,3378.89,4966.79,1431.32,1075.67,3012.20,4503.28,2518.20,1836.59,1197.54,2097.16,1221.92,1383.54,773.88;
1167.11,1094.12,1820.61,1407.38,1166.85,1105.49,3388.47,3717.95,3349.41,1228.01,2975.56,4998.71,4998.71,2081.47,1207.40,1375.07,2460.01,1299.87,1114.78,1146.75,1929.99,1458.33,1942.08,3159.59,3044.15,805.78,1429.97,3642.40,4792.02,1400.00,1189.48,3101.54,4723.70,2415.47,1741.25,1262.12,2257.43,1323.85,1474.78,805.11;
1156.42,1146.77,1974.29,1588.82,1303.64,1101.97,3349.41,4011.27,3421.15,1280.50,2975.56,4918.75,4998.71,2230.58,1169.41,1344.19,2530.65,1492.15,1147.90,1128.25,1859.39,1638.07,2172.77,3232.59,2980.67,887.98,1722.26,3741.94,4768.53,1330.71,1397.44,3375.16,4592.26,2454.27,1741.93,1380.47,2478.63,1500.84,1620.63,830.64;
1130.86,1171.11,2097.16,1745.29,1435.28,1097.58,3387.63,4177.17,3714.64,1387.51,2897.97,5082.70,5349.39,2519.06,1191.31,1319.35,2499.69,1527.49,1175.54,1110.61,1870.90,1684.23,2218.86,3195.82,2927.46,916.00,1814.99,3679.86,4855.99,1319.35,1431.61,3367.75,4503.28,2475.36,1712.30,1454.84,2651.75,1616.30,1708.00,865.96;
1193.41,1213.31,2128.39,1702.56,1427.80,1081.21,3387.63,3857.50,3581.60,1396.62,2923.69,4765.04,4918.75,2439.15,1216.93,1322.05,2411.99,1477.93,1174.04,1139.94,1836.99,1684.23,2144.22,3101.54,2927.46,941.58,1663.66,3581.11,4707.91,1328.74,1336.73,3034.49,4365.52,2306.09,1702.40,1347.10,2439.00,1458.03,1639.82,870.07;
1170.15,1152.57,2026.61,1631.96,1362.91,1094.12,3277.46,3673.98,3421.15,1316.21,2897.97,4691.17,5168.11,2364.12,1200.58,1312.81,2427.99,1444.69,1138.01,1136.53,1847.95,1613.35,1905.42,2819.38,3076.51,877.89,1020.89,2690.26,4520.07,1423.60,839.16,2132.13,3546.55,2324.64,1888.03,964.18,1734.48,1097.97,1365.75,827.37;
1239.30,1027.36,1420.04,993.73,860.49,1130.86,3176.00,2721.14,2399.42,954.08,3139.77,4294.82,4119.61,1733.41,1294.33,1389.38,2476.02,1142.94,1038.61,1154.99,2103.14,1430.98,1424.81,2844.04,3015.74,877.89,1030.56,2699.52,4490.57,1458.30,839.56,2103.14,3741.94,2289.78,1878.91,960.80,1706.39,1099.05,1375.10,827.37;
1214.27,1020.53,1417.59,988.20,855.04,1122.58,2959.54,2772.38,2399.42,963.43,2980.67,4419.28,4233.95,1730.40,1294.33,1396.62,2452.68,1138.01,1051.59,1162.08,2103.14,1410.90,1431.35,2923.69,3012.20,875.79,1023.73,2680.48,4365.52,1450.26,834.98,2147.41,3594.01,2362.27,1966.48,964.18,1725.62,1102.45,1372.51,827.37;
1220.42,1013.78,1418.87,990.96,857.07,1138.27,3176.69,2698.68,2417.60,951.50,3001.68,4419.28,4012.66,1741.70,1300.60,1392.65,2452.68,1141.47,1037.48,1158.54,2147.62,1417.19,1424.50,2768.27,2984.67,874.45,1025.86,2715.74,4343.33,1431.32,845.47,2193.92,3978.37,2417.60,1927.67,958.17,1716.80,1099.05,1378.02,819.71;
1219.56,1009.30,1417.59,988.20,858.43,1126.23,3019.28,2821.79,2362.27,954.08,3007.51,4419.28,4121.11,1725.13,1294.33,1384.08,2421.56,1139.44,1044.49,1155.28,2162.36,1417.19,1431.61,2893.79,3049.01,876.56,1021.95,2688.38,4343.33,1441.29,838.30,2147.41,3730.72,2379.90,1950.88,964.18,1725.62,1094.61,1379.31,824.08]';
img=inv_solve(inv_model, data(:,1), data(:,3));
K2=max(img.elem_data);
K1=min(img.elem_data);
colbar = linspace(K1,K2,10);
t_v=colbar; %ticks values
Y = (K2-K1)./2;
X = (K2+K1)./2;   

i=1;
k=1;

while i<11
    img=inv_solve(inv_model, data(:,k), data(:,k+1));
    subplot(2,5,i)
    frame=i;
    title(['Frame ',num2str(frame)])
    show_fem(img) 
    img.calc_colours.ref_level= X;
    img.calc_colours.clim= Y;
    cb = colorbar; 
    t_l=linspace(1,255,10);
    set(cb,'YTick', t_l'); set(cb,'YTickLabel', t_v');
    %set(img,'LineStyle','none');
    k=k+1;
    i=i+1;
end
%% inserimento 7 dal basso
data=[1243.84,1016.77,1405.85,988.20,852.33,1130.86,3079.01,2768.27,2355.50,952.48,2980.67,4551.17,4083.99,1716.85,1288.10,1405.31,2414.56,1179.28,1030.56,1162.08,2088.78,1418.05,1404.63,2821.79,3018.10,860.38,1028.76,2653.35,4379.00,1439.11,851.43,2178.08,3667.60,2381.36,1947.06,968.71,1734.48,1096.83,1372.51,822.96;
1233.83,1020.53,1423.47,988.20,855.71,1133.56,3080.27,2849.00,2399.42,999.26,3012.20,4294.82,3857.50,1725.13,1306.91,1357.87,2466.76,1272.22,1106.80,1123.42,2103.14,1579.92,1648.23,2744.62,2903.22,923.79,1165.63,2776.52,4109.12,1337.43,997.94,2581.09,3920.74,2397.64,1856.08,1168.02,2137.26,1372.51,1649.53,880.79;
1280.74,1195.31,1840.67,1365.75,1081.44,1059.69,3080.27,3143.77,3079.01,1294.03,2768.27,4415.57,4547.12,2364.12,1364.79,1277.44,2557.57,1551.86,1243.31,1085.83,1942.40,1773.04,2031.46,2847.01,2721.14,959.13,1439.11,3085.31,4134.73,1301.76,1099.74,2953.98,4364.63,2433.40,1802.96,1421.99,2555.41,1554.92,1723.75,883.71;
1307.52,1281.74,2041.17,1509.01,1205.83,1046.69,3049.62,3464.59,3278.97,1426.12,2693.62,4294.82,4908.54,2542.59,1369.93,1259.34,2483.23,1602.98,1274.04,1087.24,1942.40,1783.13,2172.77,2847.01,2650.94,973.76,1585.42,3186.39,4109.12,1301.76,1200.04,3007.51,4364.63,2379.90,1801.96,1482.92,2625.48,1639.82,1786.00,899.97;
1318.76,1325.05,2099.15,1588.82,1277.23,1040.48,2960.66,3351.03,3426.33,1510.08,2712.09,4177.17,4840.06,2655.16,1378.78,1253.39,2565.52,1636.79,1278.40,1070.84,1967.46,1859.53,2233.69,2847.01,2698.68,997.29,1635.80,3060.66,4004.35,1284.62,1248.34,2975.56,4468.34,2437.75,1814.74,1561.96,2768.27,1725.62,1886.01,927.00;
1318.76,1331.37,2170.34,1633.55,1345.73,1039.61,2904.27,3209.95,3505.08,1583.16,2693.62,4011.27,4840.06,2756.03,1396.62,1222.00,2540.65,1751.10,1325.95,1073.85,1954.89,1942.40,2248.58,2770.55,2628.99,1030.56,1715.93,3025.22,4042.87,1253.39,1360.95,3095.78,4293.97,2435.88,1824.52,1630.19,2794.88,1787.84,1962.56,957.53;
1331.37,1327.15,2130.05,1605.46,1337.66,1037.38,2876.49,3244.28,3314.02,1576.08,2598.84,4011.27,4998.71,2756.03,1418.66,1220.32,2565.52,1751.10,1301.76,1067.83,1980.11,1992.83,2201.56,2741.96,2747.30,1044.49,1681.77,3001.39,4004.35,1261.86,1331.09,2918.87,4130.93,2379.90,1801.96,1592.41,2847.01,1787.84,1974.29,973.99;
1336.60,1314.76,2044.47,1574.02,1344.27,1033.48,2904.27,3019.28,3208.53,1564.88,2664.87,4121.11,4620.64,2660.41,1389.38,1231.73,2483.23,1743.13,1269.68,1072.19,1993.17,2006.33,2126.32,2693.62,2582.94,1060.00,1585.42,2785.30,3820.99,1261.86,1286.47,2811.70,4130.93,2454.27,1810.64,1546.22,2668.54,1736.28,1950.88,966.08;
1341.85,1254.02,2028.58,1532.42,1298.83,1042.68,2877.00,3019.28,3176.00,1451.15,2788.33,4012.66,4551.17,2639.80,1371.76,1239.13,2476.02,1661.33,1249.15,1096.60,2006.16,1894.14,2028.58,2671.41,2675.11,1036.30,1524.16,2827.12,3978.37,1274.04,1219.50,2712.09,4112.86,2303.85,1820.61,1421.99,2475.36,1599.40,1848.43,938.27;
1343.04,1275.91,2000.11,1502.37,1240.50,1042.68,2904.27,3049.01,3080.27,1385.85,2715.96,3960.22,4477.00,2405.53,1402.01,1259.34,2476.02,1521.43,1278.40,1087.24,1980.27,1752.66,2028.58,2816.01,2747.30,956.13,1434.39,2933.96,3952.23,1299.87,1100.08,2756.03,4437.02,2475.36,1858.97,1347.10,2412.75,1532.42,1708.00,880.79;
1316.21,1243.84,1891.22,1394.60,1091.25,1057.95,2904.27,3208.53,3047.19,1229.33,2788.33,4354.83,4620.64,2255.58,1382.20,1286.41,2452.68,1310.87,1193.70,1165.20,2074.53,1684.23,1793.40,2872.40,2849.00,993.57,1219.56,2634.87,3915.57,1299.87,907.81,2274.82,3782.59,2395.27,1924.60,957.43,1752.25,1100.08,1383.54,827.37]';

img=inv_solve(inv_model, data(:,1), data(:,5));
K2=max(img.elem_data);
K1=min(img.elem_data);
colbar = linspace(K1,K2,10);
t_v=colbar; %ticks values
Y = (K2-K1)./2;
X = (K2+K1)./2;   

i=1;
k=1;

while i<11
    img=inv_solve(inv_model, data(:,k), data(:,k+1));
    subplot(2,5,i)
    frame=i;
    title(['Frame ',num2str(frame)])
    show_fem(img) 
    img.calc_colours.ref_level= X;
    img.calc_colours.clim= Y;
    cb = colorbar; 
    t_l=linspace(1,255,10);
    set(cb,'YTick', t_l'); set(cb,'YTickLabel', t_v');
    %set(img,'LineStyle','none');
    k=k+1;
    i=i+1;
end


%% inserimento 8 (calibrazione pieno)
data=[861.15,709.14,985.04,682.29,600.81,789.64,2140.40,1926.14,1650.52,658.88,2073.97,3026.06,2881.07,1202.41,894.00,950.59,1677.82,795.18,719.66,813.60,1389.82,974.22,996.74,1926.14,2071.19,611.04,705.98,1779.57,3033.49,1012.43,593.42,1524.50,2606.46,1629.31,1345.14,670.73,1199.09,779.62,957.55,574.42;
868.18,704.45,995.16,687.77,596.03,794.25,2184.53,1944.05,1662.36,667.10,2115.30,3162.49,2896.10,1252.66,897.25,940.03,1693.50,796.63,742.47,809.96,1363.73,983.24,1124.07,2077.55,2049.57,605.62,814.32,2028.24,3033.49,980.65,691.32,1721.43,2805.34,1640.30,1298.87,784.42,1363.73,868.11,1032.79,567.84;
818.62,735.76,1247.61,915.52,792.78,768.17,2277.42,2492.89,2162.35,820.57,2073.97,3309.48,3469.75,1503.86,828.77,921.37,1725.53,924.68,766.78,793.18,1281.46,1062.61,1315.58,2057.28,2052.65,606.65,992.14,2349.34,3140.88,970.47,820.74,2028.24,3121.06,1652.33,1238.71,891.67,1533.01,944.35,1059.00,573.14;
798.21,762.68,1311.94,1003.60,860.17,765.73,2380.86,2577.38,2327.42,894.00,2031.60,3256.69,3473.47,1587.27,830.55,907.72,1709.40,966.23,772.30,788.67,1280.34,1106.92,1366.45,2161.90,2052.65,616.56,1052.00,2373.68,3234.61,953.20,860.71,2122.29,3158.97,1678.45,1237.53,926.99,1577.04,993.23,1093.75,579.32;
815.86,780.05,1362.38,1049.60,895.85,765.09,2302.83,2641.46,2434.30,924.94,2052.65,3309.48,3651.46,1657.07,838.99,892.65,1759.82,1028.72,790.26,780.63,1297.11,1137.66,1421.93,2161.90,1953.78,623.76,1101.52,2349.34,3086.44,944.79,913.27,2203.34,3294.25,1652.33,1231.29,992.14,1705.41,1074.43,1154.11,585.64;
835.77,820.04,1418.36,1116.71,955.52,743.76,2353.98,2740.78,2615.98,1030.44,1973.50,3353.11,3717.15,1881.29,852.35,895.72,1765.43,1115.97,826.80,769.48,1280.34,1163.71,1524.50,2097.20,1942.09,629.03,1194.74,2458.10,3129.21,953.20,967.37,2277.16,3234.61,1720.07,1209.32,1048.57,1856.29,1110.35,1200.24,595.93;
842.37,835.77,1469.33,1165.65,1000.24,735.76,2253.86,2819.21,2581.20,1067.13,1990.32,3154.07,3717.15,1934.31,870.17,885.30,1825.19,1129.71,833.22,763.03,1288.69,1189.31,1513.65,2057.28,1990.32,634.88,1209.91,2511.38,3065.70,948.36,990.24,2326.58,3418.80,1720.07,1238.20,1079.24,1923.60,1151.79,1192.96,593.16;
835.77,833.53,1458.64,1171.44,1001.45,735.76,2353.98,2746.30,2611.21,1068.43,1973.50,3469.75,3924.27,1930.45,854.19,895.07,1812.72,1139.60,823.12,755.49,1280.34,1176.12,1513.49,2098.02,1973.50,625.35,1223.79,2484.65,3212.24,944.79,976.53,2409.01,3294.25,1749.83,1223.91,1100.09,1871.72,1153.02,1179.72,585.64;
832.14,823.54,1466.52,1179.72,1001.45,738.61,2353.98,2847.06,2614.38,1032.79,2010.82,3531.84,3717.15,1817.12,847.44,905.81,1782.71,1052.99,810.69,769.48,1272.05,1114.33,1441.53,2119.10,2031.60,596.94,1175.79,2479.20,3309.48,956.83,941.74,2203.34,3196.85,1664.41,1189.31,1016.34,1759.82,1070.72,1134.01,581.64;
828.53,806.95,1427.14,1110.35,942.34,748.98,2327.42,2740.78,2519.89,977.95,2071.19,3256.69,3717.15,1754.02,852.35,916.79,1765.43,971.35,805.56,768.47,1287.45,1032.22,1394.15,2077.55,2049.57,571.01,1030.44,2422.82,3220.39,996.13,861.42,2158.98,3196.85,1650.52,1237.53,903.44,1519.78,916.37,979.03,529.36;
797.56,757.27,1287.45,976.02,833.36,765.73,2353.98,2671.94,2328.54,866.73,2115.30,3462.33,3653.63,1522.68,835.24,930.63,1800.25,900.13,766.78,786.33,1337.35,983.24,1268.72,2118.68,2089.84,549.28,914.60,2311.86,3072.78,1000.00,743.54,1970.09,3140.88,1762.01,1298.09,812.39,1388.27,858.94,961.38,533.08]';


img=inv_solve(inv_model, data(:,1), data(:,5));
K2=max(img.elem_data);
K1=min(img.elem_data);
colbar = linspace(K1,K2,10);
t_v=colbar; %ticks values
Y = (K2-K1)./2;
X = (K2+K1)./2;   

i=1;
k=1;

while i<11
    img=inv_solve(inv_model, data(:,k), data(:,k+1));
    subplot(2,5,i)
    frame=i;
    title(['Frame ',num2str(frame)])
    show_fem(img) 
    img.calc_colours.ref_level= X;
    img.calc_colours.clim= Y;
    cb = colorbar; 
    t_l=linspace(1,255,10);
    set(cb,'YTick', t_l'); set(cb,'YTickLabel', t_v');
    %set(img,'LineStyle','none');
    k=k+1;
    i=i+1;
end
%% inserimento 9
data=[872.07,713.34,1022.87,689.18,594.14,792.28,2140.40,1926.46,1650.52,664.19,2112.35,3068.27,2813.24,1204.50,899.40,950.59,1667.29,797.65,726.59,809.96,1380.06,988.12,987.48,1944.05,2108.59,602.75,709.46,1796.50,3018.07,1010.96,590.13,1513.03,2538.26,1616.46,1329.59,673.13,1196.34,769.20,948.07,578.80;
864.31,711.24,999.38,692.44,595.55,785.13,2140.40,1962.13,1736.04,690.51,2085.79,3022.36,2896.10,1285.04,873.19,912.24,1593.27,851.92,760.47,807.50,1320.73,1090.24,1201.25,2056.51,2108.59,647.55,881.43,2085.79,3012.57,961.76,732.72,1791.74,2656.78,1587.89,1223.91,814.32,1427.14,900.06,1079.24,594.01;
832.14,768.80,1257.01,925.13,783.67,771.27,2277.42,2408.07,2117.41,804.71,2067.64,3068.27,3159.67,1435.24,853.31,910.27,1677.82,934.61,763.61,786.33,1291.32,1100.78,1303.23,2036.09,2035.91,638.16,954.40,2127.42,3018.07,956.83,764.89,1845.00,2795.56,1589.68,1253.71,824.95,1466.52,931.51,1113.01,599.25;
825.70,783.23,1288.69,966.23,813.48,765.09,2278.47,2402.49,2162.35,807.34,1997.73,3114.98,3256.69,1468.98,854.23,900.13,1720.52,968.18,785.98,786.33,1293.05,1149.25,1337.35,2075.96,2019.38,650.04,1003.60,2175.30,3140.88,945.95,814.17,2034.22,2949.46,1678.45,1253.89,844.53,1466.52,990.08,1134.01,608.01;
832.86,794.25,1363.73,1013.15,850.38,760.27,2278.47,2511.38,2302.83,837.06,2071.19,3256.69,3473.47,1480.48,860.17,882.27,1725.53,991.27,792.72,785.25,1311.94,1148.37,1373.15,2056.51,1986.47,643.93,1049.60,2327.42,3083.17,930.54,857.09,2131.72,3134.69,1705.41,1246.53,862.82,1529.81,990.08,1138.15,612.58;
835.77,797.56,1373.15,1048.57,890.76,765.09,2353.98,2611.21,2354.56,846.56,2052.65,3209.29,3591.18,1522.68,839.91,884.03,1709.40,998.40,789.34,792.11,1255.69,1161.82,1418.36,2075.96,2045.75,650.04,1111.38,2353.98,3329.85,939.72,905.07,2175.30,3134.69,1666.06,1217.80,884.28,1566.23,1013.15,1172.66,603.16;
838.69,820.04,1418.36,1093.75,937.66,761.34,2327.42,2671.94,2435.59,885.59,2049.57,3209.29,3469.75,1639.42,849.45,879.24,1736.97,1022.97,810.69,787.37,1269.13,1167.77,1449.27,2118.68,2063.32,650.04,1153.02,2353.98,3196.85,926.99,945.09,2178.98,3214.45,1640.30,1217.88,914.60,1638.73,1054.29,1177.24,606.02;
836.47,836.47,1448.05,1112.30,979.03,768.17,2303.37,2544.10,2522.03,894.00,2013.72,3162.49,3591.18,1671.54,859.18,888.33,1720.52,1038.65,817.85,781.65,1247.61,1174.67,1501.06,2098.02,2007.21,654.03,1200.24,2407.45,3196.85,919.01,949.50,2246.25,3158.97,1654.74,1224.89,943.38,1733.25,1065.86,1191.75,613.51;
839.42,839.42,1466.52,1172.66,983.01,762.03,2277.42,2619.57,2522.03,945.95,1993.48,3256.69,3529.88,1757.16,862.12,875.08,1709.40,1091.31,826.80,779.58,1254.19,1180.75,1523.55,2077.15,1937.54,660.33,1212.76,2407.45,3045.37,922.50,985.11,2236.22,3272.19,1640.30,1232.04,993.23,1759.82,1107.92,1220.34,618.52;
846.09,840.74,1519.78,1185.73,1006.75,743.76,2278.47,2544.10,2581.20,994.96,1995.96,3210.76,3591.18,1786.64,857.20,866.84,1698.27,1129.71,834.25,776.01,1255.69,1220.34,1546.42,2037.22,1950.13,662.16,1263.84,2435.59,3214.45,918.04,1013.82,2345.31,3272.19,1679.92,1210.90,1021.78,1856.29,1123.12,1241.05,619.10;
839.42,849.82,1531.57,1194.02,1017.46,746.05,2328.54,2635.73,2614.38,1019.32,1976.25,3159.67,3717.15,1845.00,873.19,862.77,1698.27,1125.50,858.14,760.83,1241.05,1214.99,1558.00,2037.22,1915.10,662.61,1273.25,2491.51,3134.69,911.16,1018.75,2340.16,3313.53,1680.98,1203.96,1048.57,1873.48,1123.12,1213.95,610.57]';


img=inv_solve(inv_model, data(:,1), data(:,11));
K2=max(img.elem_data);
K1=min(img.elem_data);
colbar = linspace(K1,K2,10);
t_v=colbar; %ticks values
Y = (K2-K1)./2;
X = (K2+K1)./2;   

i=1;
k=1;

while i<11
    img=inv_solve(inv_model, data(:,k), data(:,k+1));
    subplot(2,5,i)
    frame=i;
    title(['Frame ',num2str(frame)])
    show_fem(img) 
    img.calc_colours.ref_level= X;
    img.calc_colours.clim= Y;
    cb = colorbar; 
    t_l=linspace(1,255,10);
    set(cb,'YTick', t_l'); set(cb,'YTickLabel', t_v');
    %set(img,'LineStyle','none');
    k=k+1;
    i=i+1;
end
%% single images
a=10; b=a+1;
img=inv_solve(inv_model, data(:,1), data(:,b));
frame=a;
title(['Frame ',num2str(frame)])
show_fem(img) 
img.calc_colours.ref_level= X;
img.calc_colours.clim= Y;
cb = colorbar; 
t_l=linspace(1,255,10);
set(cb,'YTick', t_l'); set(cb,'YTickLabel', t_v');

%% 10
data=[816.16,665.66,943.49,644.53,553.89,737.31,2001.75,1834.71,1528.56,628.41,1978.27,2788.82,2769.15,1140.38,832.14,869.14,1559.29,739.55,674.22,750.77,1315.50,906.66,949.26,1800.47,1954.46,568.21,658.32,1702.16,2731.03,935.45,571.17,1478.32,2585.39,1558.13,1286.90,711.34,1233.93,796.89,946.52,541.80;
763.67,649.25,1016.18,764.09,678.29,701.02,1999.30,2171.42,2063.96,815.62,1957.51,2941.94,3194.84,1421.26,780.21,862.86,1759.84,894.17,669.72,715.65,1298.34,1003.10,1074.80,1851.45,1929.66,537.74,807.65,1999.30,2918.88,921.93,711.99,1937.02,3059.49,1745.58,1295.06,875.43,1497.10,933.72,999.22,512.10;
754.68,655.90,1083.63,852.13,752.59,690.19,2022.28,2270.63,2251.50,876.92,1957.51,3155.72,3476.36,1546.70,759.95,872.28,1804.35,946.09,662.73,703.64,1325.05,1018.91,1099.32,1816.28,1861.39,531.18,863.63,2083.25,3043.57,910.94,746.96,2076.84,3197.33,1764.99,1286.47,924.09,1558.13,965.88,1027.70,515.15;
751.51,664.09,1096.69,848.92,766.61,675.01,2042.15,2270.63,2251.50,896.01,1899.99,3083.09,3536.73,1588.16,762.41,864.78,1804.35,955.06,667.85,703.64,1313.77,1034.42,1098.58,1833.77,1933.70,530.30,871.17,2080.50,3060.22,918.26,755.63,2030.11,3138.26,1762.48,1254.22,925.06,1635.14,984.97,1034.42,513.20;
747.08,662.16,1127.17,871.17,781.13,674.15,1981.43,2298.87,2304.45,935.45,1899.99,3072.70,3738.64,1643.33,766.61,864.78,1798.10,965.88,667.85,691.12,1306.04,1052.02,1137.11,1832.20,1857.78,529.95,899.11,2083.25,3080.85,918.26,764.72,2096.50,3154.92,1794.26,1238.26,974.25,1647.87,1000.34,1038.42,513.20;
739.72,655.90,1128.34,875.43,788.17,671.06,1961.34,2312.28,2358.65,940.43,1929.66,3031.44,3597.98,1683.51,767.41,860.45,1837.23,997.92,670.44,691.12,1323.40,1035.21,1105.77,1833.77,1929.66,525.59,891.07,2080.50,3118.00,923.05,761.68,2141.55,3177.54,1762.48,1286.79,984.97,1688.88,1006.90,1028.64,497.27;
751.51,665.16,1120.20,882.27,784.64,659.70,1981.43,2348.69,2416.87,975.88,1933.70,3135.90,3733.33,1712.42,769.13,861.68,1892.18,990.49,673.45,676.35,1323.40,1040.25,1157.36,1784.78,1819.80,517.08,907.28,2104.05,3177.54,921.93,776.70,2188.56,3216.65,1842.47,1278.57,1016.18,1736.04,1038.42,1021.91,496.50;
754.68,671.62,1140.08,891.07,795.29,651.10,1961.34,2294.55,2442.06,998.00,1954.46,3020.16,3733.33,1738.58,771.66,867.87,1871.32,1016.39,674.22,671.84,1352.86,1057.97,1137.78,1769.21,1842.47,521.65,912.79,2083.25,3025.08,936.58,789.07,2136.07,3367.27,1794.26,1269.99,1010.48,1734.18,1022.89,1045.30,502.50;
736.65,653.50,1107.74,887.54,795.29,655.37,1924.02,2353.33,2387.57,998.00,1864.35,3020.16,3733.33,1776.73,769.13,867.87,1934.99,1041.71,656.58,675.32,1369.81,1069.37,1098.58,1723.27,1893.05,515.92,884.02,2080.50,3177.54,943.04,786.22,2141.55,3177.54,1873.15,1278.36,1005.91,1706.19,1049.37,1054.37,500.41;
744.01,640.91,1031.39,840.94,782.84,650.55,1886.69,2197.16,2330.11,962.46,1845.66,3170.22,3597.98,1696.17,788.93,885.72,1906.66,1020.61,648.10,669.19,1341.22,1057.97,1046.82,1692.33,1896.86,517.42,852.13,1916.80,3025.08,952.01,804.32,2219.92,3460.42,1954.46,1366.49,1003.64,1706.19,1016.18,1045.30,500.41;
772.21,647.39,1028.64,823.98,785.50,643.99,1833.77,2152.13,2199.86,945.45,1880.56,2903.18,3472.09,1628.50,787.27,867.87,1871.32,973.50,659.08,674.51,1361.32,1029.47,1025.19,1662.53,1809.00,521.09,805.37,1869.32,2857.55,936.58,738.17,2060.39,3280.35,1937.02,1375.74,915.61,1608.64,965.88,1011.53,497.52]';
img=inv_solve(inv_model, data(:,1), data(:,4));
K2=max(img.elem_data);
K1=min(img.elem_data);
colbar = linspace(K1,K2,10);
t_v=colbar; %ticks values
Y = (K2-K1)./2;
X = (K2+K1)./2;   

i=1;
k=1;

while i<11
    img=inv_solve(inv_model, data(:,k), data(:,k+1));
    subplot(2,5,i)
    frame=i;
    title(['Frame ',num2str(frame)])
    show_fem(img) 
    img.calc_colours.ref_level= X;
    img.calc_colours.clim= Y;
    cb = colorbar; 
    t_l=linspace(1,255,10);
    set(cb,'YTick', t_l'); set(cb,'YTickLabel', t_v');
    %set(img,'LineStyle','none');
    k=k+1;
    i=i+1;
end
%% 11 
data=[811.94,676.70,947.52,652.96,554.34,737.92,1924.02,1783.62,1556.59,623.37,2037.82,2623.62,2636.59,1129.80,845.21,869.14,1559.29,740.48,678.77,748.53,1317.01,927.49,941.00,1818.12,1967.71,563.98,689.17,1752.12,2715.09,915.61,627.48,1678.55,2941.94,1707.46,1321.10,777.52,1342.94,866.94,994.80,523.90;
770.19,659.70,1026.65,750.84,661.01,676.17,1904.20,2080.50,2063.96,846.23,1883.28,2941.94,3301.22,1480.71,792.54,860.45,1772.60,913.66,674.95,702.71,1325.05,1029.47,1080.24,1800.47,1893.05,527.83,807.65,1902.44,2903.80,910.94,724.85,2018.50,3238.91,1781.89,1338.59,925.95,1594.93,962.62,1038.42,511.01;
775.55,680.20,1091.19,856.21,755.04,666.58,1923.29,2167.26,2252.08,929.28,1913.23,2949.75,3476.36,1625.43,790.84,853.14,1804.35,984.78,686.87,688.33,1296.67,1051.25,1135.31,1766.96,1838.66,541.81,876.25,1978.27,3006.22,914.60,770.43,2076.84,3118.00,1764.99,1330.06,974.25,1645.82,1016.18,1054.37,516.94;
778.91,682.82,1134.20,888.36,796.11,657.25,1886.69,2171.42,2331.40,973.08,1864.35,3135.90,3808.40,1708.85,789.91,861.68,1843.26,1026.76,687.26,675.32,1317.01,1079.35,1158.00,1736.04,1823.80,522.30,908.20,1959.81,3031.44,913.51,811.24,2193.38,3238.91,1864.35,1303.84,1000.34,1750.48,1054.37,1077.18,506.51;
766.28,685.45,1148.43,917.42,840.06,646.35,1885.32,2219.92,2386.19,1022.87,1861.39,2980.95,3808.40,1809.00,796.18,845.96,1898.42,1086.04,688.07,666.37,1313.77,1099.93,1164.49,1678.55,1776.73,531.54,940.28,1957.51,2903.80,914.60,849.94,2167.26,3255.47,1880.56,1330.06,1040.91,1850.16,1095.55,1102.21,513.20;
772.87,692.29,1151.88,917.42,844.06,633.51,1832.20,2237.68,2356.65,1038.05,1827.21,3090.58,3667.54,1877.18,809.02,857.40,1898.42,1090.93,699.63,651.88,1325.05,1110.87,1164.49,1662.53,1773.31,526.59,947.52,1885.32,2918.88,913.51,843.14,2182.72,3389.85,1913.23,1347.90,1054.37,1848.23,1102.21,1108.92,509.08;
785.69,703.22,1141.28,900.00,828.22,630.05,1834.71,2104.05,2358.65,1028.83,1830.01,2990.44,3799.98,1857.78,830.16,854.35,1871.32,1054.61,706.20,655.14,1333.12,1081.02,1151.53,1662.53,1762.48,516.57,900.81,1919.68,2968.89,921.93,792.10,2034.39,3413.90,1877.18,1312.21,999.22,1721.70,1027.70,1044.37,501.45;
787.81,697.72,1095.55,876.25,780.18,645.05,1834.71,2149.60,2249.76,945.45,1827.21,2997.27,3476.36,1683.51,834.13,866.00,1877.69,1006.23,698.43,669.19,1380.20,1040.99,1106.32,1692.33,1809.00,513.60,854.41,1883.28,3004.15,930.51,758.38,1954.46,3238.91,1883.28,1329.82,964.83,1645.82,1000.34,1033.52,500.00;
794.08,692.88,1090.14,830.84,743.81,651.10,1816.28,2080.50,2176.65,919.33,1845.66,2903.18,3597.98,1667.82,834.13,873.54,1892.18,967.49,692.81,666.56,1371.52,1046.82,1063.96,1609.91,1809.00,520.45,797.61,1827.21,2903.80,926.78,699.31,1978.27,3095.10,1864.35,1366.49,915.61,1545.29,980.65,1005.91,502.92;
820.96,703.22,1061.58,780.93,696.48,649.25,1833.77,2021.85,2107.85,870.26,1893.05,2848.09,3358.55,1563.26,846.23,876.73,1871.32,942.47,691.60,676.35,1392.21,1004.44,1015.67,1678.55,1791.04,530.63,743.42,1809.00,2918.88,931.66,631.75,1830.01,2918.88,1830.01,1347.40,848.08,1474.88,938.59,1036.15,524.36;
827.78,688.65,1000.34,706.99,609.29,662.16,1800.47,1921.84,1981.43,796.11,1832.20,2784.41,3145.37,1355.19,880.25,848.92,1671.97,810.69,707.44,735.39,1380.20,919.55,946.41,1768.36,1933.70,570.43,655.37,1658.33,2701.94,934.24,543.98,1425.44,2464.99,1498.64,1295.29,622.20,1138.72,721.61,914.60,547.71]';


img=inv_solve(inv_model, data(:,1), data(:,5));
K2=max(img.elem_data);
K1=min(img.elem_data);
colbar = linspace(K1,K2,10);
t_v=colbar; %ticks values
Y = (K2-K1)./2;
X = (K2+K1)./2;   

i=1;
k=2;

while i<11
    img=inv_solve(inv_model, data(:,1), data(:,k));
    subplot(2,5,i)
    frame=i;
    title(['Frame ',num2str(frame)])
    show_fem(img) 
    img.calc_colours.ref_level= X;
    img.calc_colours.clim= Y;
    cb = colorbar; 
    t_l=linspace(1,255,10);
    set(cb,'YTick', t_l'); set(cb,'YTickLabel', t_v');
    %set(img,'LineStyle','none');
    k=k+1;
    i=i+1;
end
%% 12
data=[965.62,890.62,1362.84,990.72,848.71,701.15,1965.15,2268.32,2522.10,1186.32,1954.28,2928.59,3759.78,2009.35,1000.35,900.47,2125.12,1238.61,864.43,724.93,1497.46,1334.11,1420.18,1881.40,1914.12,635.78,1005.26,2062.99,2923.94,973.82,817.65,2275.33,3572.89,2067.53,1427.50,1176.72,2091.85,1281.01,1328.65,617.05;
970.24,882.79,1371.97,990.72,848.71,709.34,1982.45,2291.05,2530.08,1173.77,1875.93,3143.46,3970.37,2085.08,995.25,913.35,2055.78,1266.67,858.88,733.57,1518.11,1333.91,1375.72,1834.18,1881.40,654.45,1000.00,1989.56,2974.75,975.87,823.49,2138.11,3485.82,1992.98,1436.29,1144.26,2067.53,1245.61,1362.84,640.00;
936.60,844.65,1298.72,972.38,869.54,704.83,1929.79,2157.74,2445.30,1134.52,1923.59,2970.42,4065.38,2005.35,972.85,917.71,2018.79,1264.00,829.61,728.79,1497.46,1375.72,1317.56,1774.33,1914.12,674.22,971.60,1915.28,2923.94,973.82,820.82,2229.59,2747.79,1800.49,1427.50,1122.39,1995.93,1236.58,1335.92,644.68;
920.26,828.50,1237.99,912.66,779.04,715.31,1965.46,2268.32,2365.78,1043.27,1941.92,3052.68,3847.19,1884.02,996.47,930.96,2078.57,1133.65,820.92,746.25,1583.31,1250.43,1279.84,1849.26,1930.68,602.05,828.97,1722.73,3314.85,997.72,687.61,2056.50,3311.09,1929.79,1517.25,1019.96,1811.80,1165.58,1282.40,617.05;
933.01,851.86,1232.89,837.53,689.96,722.60,2000.87,2174.31,2339.71,1001.55,1957.67,2965.02,3730.51,1852.53,995.25,916.50,2070.83,1100.19,838.45,752.18,1572.37,1209.22,1279.75,1979.24,1965.46,621.59,874.46,2227.08,3184.63,1017.34,665.75,1946.16,3163.52,1965.15,1467.41,938.49,1649.49,1089.25,1230.42,644.68;
937.32,852.52,1186.97,800.52,626.13,752.64,2096.40,2073.40,1913.54,794.78,2012.71,2847.11,3282.26,1559.53,1021.30,909.03,1954.74,1025.90,826.04,764.56,1561.18,1243.50,1216.18,1848.22,1983.09,674.42,804.01,1985.18,3015.22,997.72,609.95,1789.16,3001.73,1865.26,1517.83,884.28,1633.88,1056.93,1202.28,637.89;
949.04,820.28,1166.70,795.44,639.50,753.29,2019.47,2056.50,2000.87,855.24,2029.58,3001.73,3439.56,1604.62,1004.24,931.81,1989.56,989.60,822.49,779.34,1570.93,1175.14,1182.41,1930.98,1999.88,652.70,775.63,2032.69,3028.32,993.68,591.50,1760.55,2965.02,1930.98,1517.83,814.86,1521.52,1025.28,1162.98,621.05;
965.62,845.35,1149.86,737.63,611.85,791.60,2157.74,2113.14,1878.11,750.43,2151.55,3008.46,3285.18,1389.74,992.57,960.55,1851.88,904.74,795.61,806.35,1547.77,1070.95,1087.15,1981.16,2088.83,629.20,738.14,1864.45,3046.82,1041.47,611.46,1630.20,2750.79,1719.78,1456.26,693.54,1230.42,810.70,1010.67,603.69;
897.85,747.13,1038.15,710.11,615.24,818.96,2137.10,2056.50,1714.56,684.44,2106.93,3046.82,3008.46,1253.26,930.96,961.91,1747.96,809.55,745.97,832.59,1497.46,1023.33,1032.92,2015.41,2096.40,627.64,733.54,1912.24,3049.75,1032.20,609.59,1641.13,2717.47,1680.35,1467.41,693.54,1222.92,804.83,1026.44,603.69;
902.53,741.58,1042.54,713.32,618.66,821.64,2157.74,2018.79,1741.60,684.44,2190.39,3075.83,2932.75,1243.19,945.58,950.97,1742.91,803.72,745.97,831.43,1528.10,1018.95,1037.94,1979.24,2201.32,631.72,738.41,1916.58,3001.18,1047.49,608.10,1595.16,2715.81,1693.12,1457.79,695.44,1228.96,802.31,1008.78,606.98;
898.53,746.58,1043.52,721.15,622.63,825.06,2245.78,2017.44,1703.94,691.10,2143.37,3028.32,3012.96,1247.17,936.52,952.35,1759.20,807.12,744.69,836.27,1517.83,1013.90,1013.56,2037.91,2179.42,626.63,735.61,1926.39,3151.18,1046.02,604.42,1583.31,2748.21,1680.35,1429.31,695.44,1244.26,801.52,1008.78,606.44]';



img=inv_solve(inv_model, data(:,1), data(:,7));
K2=max(img.elem_data);
K1=min(img.elem_data);
colbar = linspace(K1,K2,10);
t_v=colbar; %ticks values
Y = (K2-K1)./2;
X = (K2+K1)./2;   

i=1;
k=2;

while i<11
    img=inv_solve(inv_model, data(:,1), data(:,k));
    subplot(2,5,i)
    frame=i;
    title(['Frame ',num2str(frame)])
    show_fem(img) 
    img.calc_colours.ref_level= X;
    img.calc_colours.clim= Y;
    cb = colorbar; 
    t_l=linspace(1,255,10);
    set(cb,'YTick', t_l'); set(cb,'YTickLabel', t_v');
    %set(img,'LineStyle','none');
    k=k+1;
    i=i+1;
end
%% 13 
data=[891.90,735.50,1058.01,717.93,619.64,822.35,2179.42,2037.91,1688.33,687.53,2129.09,3008.46,2914.18,1271.57,929.79,958.42,1700.68,823.95,743.06,841.39,1487.38,1033.38,1032.56,2156.50,2178.56,627.64,739.11,1985.18,3083.67,1051.71,616.75,1594.99,2786.26,1667.66,1447.73,691.10,1241.09,798.24,1012.90,605.59;
893.09,733.37,1045.81,730.04,620.13,831.96,2223.44,2000.87,1730.69,713.32,2170.92,3085.49,2932.75,1265.46,927.63,958.42,1792.48,816.47,748.89,839.98,1518.11,1110.87,1004.65,1929.79,2137.10,635.84,739.77,1950.28,3015.79,1032.20,638.83,1865.26,3046.82,1880.85,1528.55,830.49,1489.76,972.38,1139.07,612.25;
924.48,762.57,1073.93,760.71,650.74,750.43,2018.79,2073.40,2055.06,872.50,2050.07,2892.47,3333.80,1581.76,934.29,958.42,2047.41,1018.23,756.07,767.67,1583.64,1189.47,1100.60,1848.22,2037.91,617.68,790.88,1985.18,3063.89,1026.73,685.29,1965.15,3311.09,2036.86,1539.35,937.54,1625.22,1056.93,1182.31,589.08;
900.35,756.78,1124.62,806.34,699.24,732.76,2037.91,2094.12,2179.42,937.54,1998.23,3052.68,3730.51,1669.49,926.51,966.74,2085.64,1064.40,765.14,752.18,1606.76,1196.30,1134.70,1833.41,2019.47,599.13,829.69,2058.84,3033.49,1026.73,729.21,2094.12,3521.32,2094.12,1518.11,998.68,1800.49,1128.72,1173.41,570.51;
893.86,748.21,1140.35,843.91,744.73,718.53,1947.38,2242.04,2366.87,1010.67,1973.50,3174.02,3861.37,1838.91,937.62,954.93,2149.29,1124.26,776.65,731.61,1595.16,1196.09,1183.44,1803.39,1947.99,575.63,890.46,2166.71,3135.16,1032.20,781.21,2266.39,3688.38,2154.43,1507.61,1108.53,1908.35,1165.58,1158.88,557.44;
894.56,786.65,1218.15,927.15,832.38,703.67,1999.88,2339.71,2588.17,1096.15,2012.71,3174.02,4152.69,1985.18,932.06,957.11,2191.48,1166.37,785.29,727.90,1583.31,1222.88,1243.66,1896.56,2019.47,567.67,960.83,2280.70,3398.33,1030.75,835.26,2387.66,3717.72,2174.31,1507.61,1145.62,1979.24,1197.75,1191.87,556.27;
875.80,781.10,1230.42,942.01,859.00,708.76,2000.87,2383.74,2683.74,1144.26,1957.67,3085.49,4233.30,1989.40,923.23,948.97,2158.57,1178.68,783.50,724.08,1550.07,1222.88,1257.38,1818.71,2000.87,599.13,1005.49,2229.59,3117.50,1017.34,847.65,2415.39,3585.19,2094.12,1487.24,1193.52,2070.83,1253.30,1267.68,588.57;
897.85,798.63,1267.68,979.98,876.40,704.26,2019.47,2387.66,2683.74,1187.91,1989.40,3085.49,4233.30,2125.12,925.33,924.09,2166.50,1227.32,813.98,723.20,1528.69,1272.42,1333.52,1880.85,1930.98,615.73,1030.64,2280.70,3360.10,1010.57,871.78,2390.48,3705.06,2073.40,1429.31,1175.31,2015.41,1245.61,1258.41,587.77;
900.35,801.19,1289.20,981.93,869.54,701.15,2037.91,2383.74,2589.61,1109.88,2012.71,3276.44,4152.69,2009.35,913.35,944.29,2125.32,1178.68,794.65,740.38,1497.46,1202.89,1309.47,1964.21,1965.46,582.98,1004.24,2254.95,3459.04,1012.02,861.77,2313.97,3636.68,2052.92,1438.74,1121.11,1910.65,1176.72,1210.87,581.16;
883.50,778.66,1246.81,953.66,859.00,718.53,2037.91,2383.74,2443.50,1076.26,2012.71,3367.17,3996.45,1902.07,907.07,942.20,2040.71,1122.27,778.04,749.21,1517.83,1189.88,1257.71,1946.16,2037.91,607.09,964.41,2301.80,3320.88,1008.13,807.13,2238.80,3472.78,1962.65,1428.95,1041.47,1756.51,1118.41,1191.87,590.39;
851.14,754.50,1197.75,919.45,822.71,739.77,2136.30,2356.00,2339.71,975.14,2110.42,3085.49,3730.51,1706.50,881.39,944.29,1974.93,949.51,736.12,807.45,1518.11,1018.43,1033.47,2073.40,2116.26,633.78,732.13,1912.24,3117.50,1032.20,604.78,1618.44,2748.21,1667.47,1438.00,697.90,1230.42,804.83,1021.14,604.52]';



img=inv_solve(inv_model, data(:,1), data(:,5));
K2=max(img.elem_data);
K1=min(img.elem_data);
colbar = linspace(K1,K2,10);
t_v=colbar; %ticks values
Y = (K2-K1)./2;
X = (K2+K1)./2;   

i=1;
k=2;

while i<11
    img=inv_solve(inv_model, data(:,1), data(:,k));
    subplot(2,5,i)
    frame=i;
    title(['Frame ',num2str(frame)])
    show_fem(img) 
    img.calc_colours.ref_level= X;
    img.calc_colours.clim= Y;
    cb = colorbar; 
    t_l=linspace(1,255,10);
    set(cb,'YTick', t_l'); set(cb,'YTickLabel', t_v');
    %set(img,'LineStyle','none');
    k=k+1;
    i=i+1;
end
%% 14
data=[888.02,736.65,1032.81,713.32,615.73,819.64,2137.10,2018.79,1712.27,685.71,2125.12,3008.46,2992.84,1235.21,929.79,948.97,1737.47,821.46,743.06,832.67,1485.21,1031.56,1051.23,2019.47,2154.43,645.83,799.80,1989.40,2953.79,996.47,670.55,1804.12,3046.82,1818.71,1467.02,845.91,1510.09,1022.24,1228.96,650.63;
921.00,823.02,1246.81,882.02,726.69,756.18,2095.64,2242.04,2291.05,944.48,1969.71,2887.49,3490.20,1718.00,965.56,886.17,1915.28,1109.09,839.98,768.80,1437.27,1279.06,1383.79,2018.79,1946.16,699.24,983.79,2106.93,2981.84,944.48,769.89,2076.35,3367.17,1929.79,1410.64,979.98,1855.95,1175.31,1361.38,665.14;
922.86,885.14,1389.24,1022.24,802.31,748.21,2134.69,2387.66,2556.91,1000.35,1976.68,2887.49,3928.42,1879.89,986.41,875.17,1928.61,1222.61,907.79,756.33,1436.29,1392.24,1518.11,2019.47,1878.11,729.40,1104.98,2280.70,2904.02,924.30,792.84,2268.32,3472.78,1880.85,1410.99,1104.98,2085.08,1328.65,1440.28,697.35;
957.98,974.13,1569.81,1139.07,891.39,722.60,2113.14,2383.74,2589.61,1124.64,1902.07,2821.27,3596.66,2009.35,997.72,855.05,1976.05,1355.59,947.63,733.57,1408.21,1477.09,1595.16,1930.68,1928.31,765.26,1237.99,2259.69,2789.38,920.98,886.22,2363.59,3534.00,1912.38,1374.86,1114.79,2170.92,1378.36,1542.74,721.30;
969.45,974.89,1570.93,1157.59,883.37,715.31,2075.24,2285.12,2530.08,1111.83,1898.11,2928.59,3930.92,2120.38,1039.05,855.05,1928.61,1368.78,946.23,744.22,1437.27,1497.18,1618.44,1914.12,1878.11,776.68,1190.68,2218.02,2981.84,908.15,842.03,2390.48,3472.78,1912.38,1367.04,1113.37,2106.93,1395.76,1556.49,732.82;
978.03,974.13,1576.80,1135.09,859.86,719.95,2055.06,2288.57,2589.61,1088.48,1916.58,2892.47,3928.42,2025.79,1026.73,845.85,1928.61,1333.08,944.29,738.41,1409.25,1467.02,1539.35,1849.78,1861.25,779.77,1100.08,2106.93,2830.12,924.30,781.21,2200.88,3311.09,1897.41,1410.64,1030.64,1973.50,1304.41,1502.68,720.60;
982.79,925.20,1423.56,1019.02,799.04,717.93,1982.45,2096.40,2365.78,1022.71,1890.68,2821.27,3543.15,1931.13,1013.39,865.55,1928.61,1228.04,894.45,748.27,1495.80,1383.79,1350.27,1818.71,1863.12,774.33,918.59,1887.61,2749.50,944.48,705.17,1849.78,2932.75,1834.18,1447.73,861.88,1658.36,1145.62,1401.80,720.60;
987.58,905.90,1323.70,854.05,658.45,751.05,1999.88,2018.79,1999.88,813.25,1973.50,2750.79,3596.66,1597.84,1077.94,869.47,1839.29,1100.19,915.23,770.79,1494.70,1294.09,1358.42,1914.12,1865.26,727.96,849.57,1923.59,2777.81,952.59,622.13,1706.40,2887.49,1804.12,1477.09,804.01,1552.46,1073.49,1319.98,696.66;
989.02,894.56,1284.67,851.14,645.33,758.44,2073.40,2019.47,1946.16,744.05,1973.50,2847.11,3189.98,1441.20,1038.80,890.30,1864.45,989.60,860.52,791.35,1538.44,1249.46,1294.53,2000.87,1999.88,713.32,837.53,1957.67,2936.40,952.59,618.65,1654.71,2892.47,1775.26,1447.11,712.70,1399.65,971.39,1203.64,670.83;
961.80,868.20,1212.04,785.98,619.16,794.07,2200.88,2075.24,1816.23,708.76,2046.52,2852.85,3052.68,1367.67,1006.73,912.13,1839.29,912.13,826.04,815.72,1570.93,1169.26,1195.73,2001.20,2035.12,667.44,778.04,1938.90,3113.13,996.47,606.26,1594.99,2821.27,1733.27,1438.49,685.71,1271.27,845.91,1082.15,627.46;
891.29,761.99,1072.86,718.53,618.14,824.32,2269.28,1981.16,1731.98,679.13,2143.37,2970.42,3012.96,1271.57,942.20,947.63,1705.58,811.98,745.97,832.67,1506.48,1036.70,1032.11,2038.26,2176.86,627.11,737.63,1873.21,3001.18,1026.73,609.95,1548.84,2717.47,1693.32,1448.11,694.87,1228.96,801.52,1010.67,605.06]';
img=inv_solve(inv_model, data(:,1), data(:,4));
K2=max(img.elem_data);
K1=min(img.elem_data);
colbar = linspace(K1,K2,10);
t_v=colbar; %ticks values
Y = (K2-K1)./2;
X = (K2+K1)./2;   

i=1;
k=2;

while i<11
    img=inv_solve(inv_model, data(:,1), data(:,k));
    subplot(2,5,i)
    frame=i;
    title(['Frame ',num2str(frame)])
    show_fem(img) 
    img.calc_colours.ref_level= X;
    img.calc_colours.clim= Y;
    cb = colorbar; 
    t_l=linspace(1,255,10);
    set(cb,'YTick', t_l'); set(cb,'YTickLabel', t_v');
    %set(img,'LineStyle','none');
    k=k+1;
    i=i+1;
end

%% 15
data=[898.53,741.01,1047.99,715.31,616.69,812.95,2269.28,2019.47,1702.31,685.71,2147.86,3008.46,2957.52,1249.06,934.29,954.30,1721.36,827.54,743.89,838.83,1494.70,1027.04,1027.04,2037.91,2134.69,627.11,728.55,1916.58,3117.50,1029.42,615.21,1594.49,2715.81,1692.52,1447.11,715.31,1237.99,796.55,1034.84,591.17;
920.26,820.28,1218.15,870.41,751.96,763.67,2199.56,2333.39,2199.56,887.37,2029.58,3008.46,3490.20,1666.42,965.40,880.87,1833.92,1120.18,857.79,783.79,1417.82,1301.99,1428.34,2057.22,1964.21,720.56,1046.94,2288.57,3135.16,928.69,789.80,2095.64,3215.06,1818.71,1383.14,966.64,1756.51,1182.31,1359.72,689.85;
925.20,897.10,1482.51,1068.22,842.27,747.57,2222.53,2465.78,2445.91,956.12,2000.70,2928.59,3730.51,1844.19,981.44,858.88,1833.92,1212.15,906.50,771.96,1391.46,1383.79,1550.07,1983.09,1964.21,760.71,1164.34,2280.70,3015.79,915.63,845.06,2242.04,3311.09,1833.41,1349.26,1015.89,1944.34,1266.34,1473.38,708.78;
948.26,963.92,1589.16,1178.00,910.13,737.63,2178.56,2516.82,2620.62,1024.03,2025.79,3012.96,3730.51,1916.58,1002.90,848.55,1833.92,1281.18,954.30,767.75,1383.14,1457.03,1642.04,1965.15,1912.38,765.96,1287.69,2306.85,2904.02,909.17,964.56,2387.66,3367.17,1803.39,1349.26,1098.87,2029.58,1343.22,1525.02,720.60;
961.03,974.13,1626.99,1245.61,986.41,733.54,2156.50,2440.49,2684.53,1039.05,1935.30,2922.39,4001.73,2025.79,993.95,842.14,1839.29,1311.19,957.11,756.33,1399.82,1467.55,1653.96,2037.91,1832.14,785.28,1289.20,2333.39,2947.96,908.15,981.75,2339.71,3413.00,1818.71,1349.26,1061.42,2067.53,1335.92,1534.85,736.92;
956.46,981.93,1641.13,1246.81,996.47,732.13,2136.30,2417.72,2530.08,1083.96,1923.59,2852.85,3861.37,2166.71,1004.24,849.58,1839.29,1323.65,950.97,754.26,1374.11,1477.36,1653.96,1965.46,1895.15,795.44,1272.88,2234.64,3063.89,896.64,1013.90,2360.33,3267.76,1804.12,1309.47,1114.79,2032.69,1361.38,1525.02,737.68;
957.98,960.19,1614.26,1245.61,1039.05,730.65,2076.35,2337.07,2530.08,1085.43,1938.90,2856.69,3793.12,2058.84,1017.34,849.58,1844.19,1326.72,942.94,749.21,1391.46,1467.02,1641.13,1947.38,1895.15,783.54,1287.69,2218.02,2981.84,907.07,1003.90,2266.39,3311.09,1760.55,1325.71,1082.15,2029.58,1334.25,1521.52,732.82;
961.03,957.26,1603.35,1183.68,966.64,744.73,2176.86,2363.59,2528.75,978.90,1954.28,2965.02,3548.67,1916.58,987.47,858.88,1816.23,1240.97,913.91,764.56,1436.29,1392.24,1538.44,1947.38,1879.75,759.08,1146.86,2190.39,2953.79,923.23,804.40,1981.16,3038.69,1774.33,1350.27,762.27,1507.82,1077.50,1332.40,710.69;
961.80,927.98,1417.82,965.62,734.22,777.38,2223.44,2310.91,2055.06,722.60,2005.35,2928.59,3335.33,1502.47,1026.73,875.17,1792.48,1025.90,907.79,800.59,1464.29,1293.46,1429.31,2076.71,1998.23,736.09,951.04,2129.09,2968.80,939.94,700.69,1834.43,3008.46,1761.00,1392.79,723.98,1419.76,1005.49,1272.88,694.14;
940.96,908.53,1355.13,904.43,708.16,794.07,2291.05,2266.39,2001.20,706.21,2046.52,3012.96,3282.26,1435.86,997.72,879.19,1785.03,972.38,868.36,819.27,1465.46,1228.85,1302.35,2056.50,1981.16,707.35,896.30,1869.96,2737.57,938.82,716.80,1618.44,2588.17,1528.55,1350.27,809.87,1395.76,919.95,1150.90,652.84;
965.62,845.35,1160.04,797.29,685.71,797.98,2136.30,1897.41,1758.30,708.76,2106.93,2896.47,2970.42,1303.63,972.85,912.13,1759.20,879.60,801.32,835.12,1505.49,1094.09,1105.84,2000.87,2176.86,628.65,732.76,1884.02,3001.18,1033.56,599.69,1583.64,2683.74,1680.35,1429.31,698.00,1247.17,794.97,1012.90,596.17]';


img=inv_solve(inv_model, data(:,1), data(:,4));
K2=max(img.elem_data);
K1=min(img.elem_data);
colbar = linspace(K1,K2,10);
t_v=colbar; %ticks values
Y = (K2-K1)./2;
X = (K2+K1)./2;   

i=1;
k=2;

while i<11
    img=inv_solve(inv_model, data(:,1), data(:,k));
    subplot(2,5,i)
    frame=i;
    title(['Frame ',num2str(frame)])
    show_fem(img) 
    img.calc_colours.ref_level= X;
    img.calc_colours.clim= Y;
    cb = colorbar; 
    t_l=linspace(1,255,10);
    set(cb,'YTick', t_l'); set(cb,'YTickLabel', t_v');
    %set(img,'LineStyle','none');
    k=k+1;
    i=i+1;
end



%% example function for the same color bar
load('soil.mat')
load('root.mat')
root_elemental_data = root.elem_data;
soil_elemental_data = soil.elem_data;
K1 = min([root_elemental_data; soil_elemental_data]);
K2 = max([root_elemental_data; soil_elemental_data]);
colbar = linspace(K1,K2,6);
t_v=colbar; %ticks values
Y = (K2-K1)./2;
X = (K2+K1)./2;

figure(1);
subplot(1,2,1);
hh= show_fem(soil);
soil.calc_colours.ref_level= X;
soil.calc_colours.clim= Y;
cb = colorbar; 
t_l=linspace(1,255,6);
set(cb,'YTick', t_l'); set(cb,'YTickLabel', t_v');
set(hh,'LineStyle','none');

subplot(1,2,2);
hh=show_fem(root);
root.calc_colours.ref_level= X;
root.calc_colours.clim= Y;
cb = colorbar; 
t_l=linspace(1,255,6);
set(cb,'YTick', t_l'); set(cb,'YTickLabel', t_v');
set(hh,'LineStyle','none');
%% 

function img = eit_adj(baseline,frame)
n_elec = 8;
n_rings= 1;
options = {'no_meas_current','no_rotate_meas'};
amplitude=5; %amplitude of stimulation current, default=10mA
[st, ms]= mk_stim_patterns(n_elec, n_rings, '{ad}','{ad}', options, amplitude);
inv_model= mk_common_model('g2c0',n_elec); %1024 elementi
inv_model.fwd_model.stimulation = st;
inv_model.fwd_model.meas_select = ms;

v0=[];
v1=[];
for n=1:10
    %per ogni frequenza seleziono tutte le misure
    %e le metto nelle colonne di v0, v1
    v0(n,:)=baseline(:,n);
    v1(n,:)=frame(:,n);
end
v0=v0';
v1=v1';
disp(v0)
i=1;
k=1;
while i<11
    img=inv_solve(inv_model, v0(:,k), v1(:,k));
    subplot(2,5,i)
    frequency=(i)*10;
    title([num2str(frequency),' kHz'])
    show_fem(img,[1,1.012]) 
    k=k+1;
    i=i+1;
end
end 


