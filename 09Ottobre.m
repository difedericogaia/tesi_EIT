n_elec = 8;
n_rings= 1;
options = {'no_meas_current','no_rotate_meas'};
amplitude=5; %amplitude of stimulation current, default=10mA
[st, ms]= mk_stim_patterns(n_elec, n_rings, '{ad}','{ad}', options, amplitude);
inv_model= mk_common_model('g2c0',n_elec); %1024 elementi
inv_model.fwd_model.stimulation = st;
inv_model.fwd_model.meas_select = ms;
show_fem(inv_model.fwd_model,[1,1.017])
%%
% pieno
data=[295.41,604.33,404.54,656.06,417.42,252.91,509.12,1248.66,740.93,421.90,440.99,1750.78,1127.01,747.47,368.43,280.69,284.79,351.37,334.53,178.32,244.22,768.72,890.49,857.76,635.70,243.21,432.84,414.72,399.25,240.03,1089.77,1100.89,1047.23,1226.12,211.88,351.85,466.29,514.49,423.19,274.90]';
% no aria
baseline=[298.27,388.31,528.00,652.18,389.25,277.18,764.02,1491.64,915.50,509.26,637.57,2253.26,1242.53,918.76,420.32,490.26,1062.75,1206.15,740.77,301.38,177.94,393.31,529.23,419.21,351.06,284.66,435.06,398.83,401.53,258.67,1157.12,1113.63,1159.59,1369.42,284.73,369.36,493.53,507.95,432.59,341.58]';
img=inv_solve(inv_model, baseline, data);
show_fem(img,[1,1])

%% 
baseline=[447.74,595.99,771.08,950.67,618.84,437.39,1291.77,2454.43,1866.49,809.47,990.80,3438.76,2583.77,1515.55,716.20,710.74,1277.91,1543.98,1137.00,434.43,272.29,652.43,913.50,695.76,556.73,415.90,705.41,655.49,636.88,415.47,1976.84,3079.15,2634.83,2254.59,388.96,669.53,940.03,1010.70,794.90,534.27]';
data_in=[447.74,595.85,784.20,912.51,626.35,423.02,1295.96,2514.53,1621.83,803.63,950.67,3493.16,2634.83,1466.21,675.43,693.05,1246.80,1533.32,1062.13,412.63,258.64,630.04,899.60,695.50,538.21,401.74,693.96,642.67,640.97,398.47,2190.90,2916.09,2377.10,1980.07,351.83,688.64,920.10,1025.88,780.60,504.00]';
data=[481.44,815.86,542.84,993.25,599.95,492.25,986.41,2759.83,1621.83,862.73,993.09,5119.53,3909.21,2086.71,764.83,452.62,465.23,1330.76,1008.17,440.51,297.28,675.78,907.46,1389.21,1104.85,442.55,741.27,651.64,643.52,511.08,1963.25,2642.51,2511.21,1621.83,490.37,698.35,997.22,1522.14,639.94,574.71;
465.12,783.65,554.65,916.86,638.17,493.59,957.25,2635.78,1618.27,809.88,852.32,4061.28,3129.17,1707.81,710.61,422.76,456.21,529.04,506.73,300.04,455.87,1236.89,1413.81,1502.08,1082.23,401.74,698.45,643.87,632.08,473.59,2016.35,2821.14,2518.70,1411.45,404.94,669.53,944.23,1508.32,641.80,491.49;
431.41,798.18,553.98,903.12,634.46,452.68,937.31,2372.20,1592.96,780.97,786.07,3438.76,3032.91,1599.98,689.24,410.93,455.07,535.34,507.63,295.00,389.67,1184.62,908.13,688.78,533.11,391.78,718.87,648.75,630.24,405.42,2086.71,2733.83,2160.23,2058.78,334.61,660.63,916.38,1098.35,771.51,486.60;
449.80,617.80,747.68,909.50,638.40,429.64,1203.48,2533.86,1613.86,786.53,953.15,3863.20,2951.72,1575.10,734.08,703.59,1092.10,1330.76,989.38,433.03,271.74,1216.35,1402.86,1440.54,1127.74,408.64,710.03,645.91,647.70,480.09,2064.28,2821.14,2479.54,1438.05,433.06,688.52,993.09,1389.63,659.05,546.20;
464.57,798.18,551.32,927.31,646.32,506.43,943.09,2568.58,1726.87,809.88,857.94,4248.53,3148.57,1618.94,722.69,430.16,451.87,531.61,503.31,305.95,480.24,1165.05,1408.08,1443.83,1115.72,419.59,711.94,655.95,656.21,497.25,2102.07,2865.59,2298.99,1519.93,448.15,698.19,957.02,1408.08,658.71,555.16;
464.86,801.12,557.37,983.21,646.83,493.60,938.34,2357.69,1734.18,786.71,884.07,4019.90,3019.87,1713.83,727.31,434.74,453.82,539.72,506.26,303.21,453.82,1219.09,1392.16,1479.74,1111.17,416.02,719.39,665.49,655.31,485.34,2075.40,2629.11,2534.72,1571.44,437.39,656.06,985.50,1400.12,641.14,536.43;
467.34,822.18,551.82,921.21,622.67,496.83,944.23,2289.52,1618.27,764.69,854.39,4252.54,3561.97,1606.66,733.17,429.50,461.87,528.46,511.47,308.49,459.78,1236.89,1430.80,1471.01,1135.16,417.34,712.39,639.71,642.67,487.07,2051.52,2985.91,2612.18,1570.22,438.29,678.18,959.64,1389.63,641.48,528.32;
465.23,809.88,556.29,924.33,630.55,501.59,925.82,2449.81,1588.96,798.15,867.06,3909.21,3050.56,1645.53,736.21,434.74,453.34,542.69,511.47,309.44,465.86,1158.82,1392.16,1424.56,1123.05,417.52,696.34,666.21,641.74,486.95,2131.31,2766.44,2651.23,1536.91,435.67,673.25,942.17,1411.60,645.70,546.00;
460.62,861.02,564.01,934.86,634.46,501.59,915.54,2643.47,1581.47,775.55,857.84,4061.28,3032.91,1618.94,739.93,435.65,454.09,536.78,522.72,310.40,466.43,1268.10,1405.61,1443.83,1132.34,416.02,696.50,651.64,647.70,494.86,2088.13,2481.94,2481.94,1455.94,434.77,678.42,946.21,1446.36,637.63,531.07;
460.50,815.98,548.03,924.33,656.06,506.43,944.23,2289.52,1613.86,772.81,882.30,3884.47,3506.60,1672.98,725.76,426.01,453.82,531.31,510.68,312.61,467.08,1246.80,1383.22,1443.83,1106.54,419.59,705.50,648.08,648.54,485.51,2121.76,2712.72,2426.33,1554.08,438.29,674.28,990.80,1418.71,645.35,528.20;
462.92,854.26,548.03,974.73,646.59,507.38,958.26,2372.20,1613.86,794.12,874.62,4071.82,3484.28,1656.82,738.52,428.28,455.61,539.37,515.21,310.62,470.18,1229.44,1410.28,1380.88,1115.72,419.47,707.77,661.05,637.63,489.39,2187.06,2670.93,2555.39,1487.25,436.53,677.90,951.08,1400.12,655.71,536.75;
466.62,828.14,554.22,963.17,642.59,514.85,945.20,2372.20,1678.88,800.47,887.85,4289.19,3032.91,1651.38,727.89,433.73,456.21,533.53,520.48,312.78,458.55,1172.31,1390.33,1475.52,1099.53,415.90,729.02,643.18,640.20,495.67,2187.06,2731.70,2362.50,1519.93,433.08,681.96,946.61,1367.72,637.63,539.71;
467.64,809.88,559.45,973.23,638.40,509.85,960.20,2429.32,1601.48,807.01,865.32,5359.87,3484.28,1745.19,738.52,428.08,462.67,543.36,1113.69,445.51,472.09,1252.31,1405.61,1458.04,1136.85,416.02,705.50,669.98,639.39,488.62,1970.01,2573.02,2479.54,1589.80,438.29,668.92,971.41,1371.61,651.54,531.18;
460.74,810.02,557.60,934.86,650.89,509.83,909.70,2619.66,1656.82,764.48,882.30,4684.18,3148.57,1645.53,750.29,427.86,460.62,536.78,508.85,312.02,457.99,1255.92,1324.89,1445.09,1120.61,423.16,705.41,654.42,636.88,497.14,2167.64,2447.51,2568.58,1471.51,432.10,702.50,1000.65,1522.14,642.09,530.78;
462.67,803.87,551.11,976.43,655.49,500.66,932.48,2357.69,1704.44,789.14,885.63,4478.34,3354.80,1659.44,718.52,434.55,473.19,549.10,1078.73,457.93,272.44,632.80,902.24,710.61,571.08,421.49,707.77,648.08,643.52,424.35,2111.36,2981.74,2466.11,2047.92,391.72,687.41,978.08,1023.07,770.07,536.75]';

img=inv_solve(inv_model, baseline, data_in);
K2=max(img.elem_data);
K1=min(img.elem_data);
colbar = linspace(K1,K2,10);
t_v=colbar; %ticks values
Y = (K2-K1)./2;
X = (K2+K1)./2;  
i=1;
k=2;
while i<16
    img=inv_solve(inv_model, data(:,1), data(:,k));
    subplot(3,5,i)
    frame=i;
    title(['Frame ',num2str(frame)])

    img.calc_colours.ref_level= X;
    img.calc_colours.clim= Y;
    cb = colorbar; 
    t_l=linspace(1,255,10);
    set(cb,'YTick', t_l'); set(cb,'YTickLabel', t_v');
    %minima2=[minima2,min(img.elem_data)];
    %set(img,'LineStyle','none');
        show_fem(img,[1,1]) 
    k=k+1;
    i=i+1;
end


%%
k=1;
i=1;
while i<16
    img=inv_solve(inv_model, data(:,1), data(:,k+1));
    subplot(3,5,i)
    frame=i;
    title(['Frame ',num2str(frame)])
    img.calc_colours.ref_level= 0;
    show_fem(img,[1,1]) 
    k=k+1;
    i=i+1;
end

%% baseline
baseline=[232.83,388.31,264.37,466.07,318.45,289.16,607.02,1605.34,1208.72,516.66,496.24,2684.94,2197.27,866.44,418.02,229.94,623.43,714.03,532.00,242.55,153.57,340.97,494.39,391.74,319.32,213.37,374.74,338.67,337.32,223.83,1218.22,1660.76,1335.17,1274.45,222.26,388.50,547.03,592.47,410.25,265.61]';
data=[250.68,288.11,373.62,444.46,322.61,276.63,1082.61,2228.14,2073.51,646.01,438.55,1199.76,932.50,647.45,375.45,378.48,687.31,856.24,563.69,235.65,138.52,330.97,455.37,337.64,287.25,199.64,371.08,324.01,342.60,218.70,1164.61,1490.75,1347.09,1141.88,204.40,374.38,532.46,594.30,403.79,253.83;
252.32,296.46,370.96,442.65,322.61,287.32,980.31,2730.19,2420.79,622.37,482.25,1265.89,927.15,662.61,375.45,382.42,719.34,819.60,556.38,249.87,145.58,324.16,467.93,338.82,300.86,204.86,366.39,324.49,351.89,219.81,1241.91,1571.10,1317.01,1155.71,204.75,371.67,544.53,576.65,407.10,251.21;
249.80,288.18,376.31,453.24,322.46,278.84,979.95,2600.80,1905.07,619.51,419.32,1155.12,948.46,605.49,369.69,345.95,671.41,876.11,582.87,225.25,127.87,311.89,448.86,343.15,276.19,191.93,365.27,318.39,349.57,206.41,1046.63,1398.69,1230.78,948.46,172.17,360.67,500.00,598.49,403.90,225.41;
230.39,293.11,366.21,442.85,310.88,228.49,989.20,2389.08,1761.50,546.78,377.29,1187.80,948.46,536.99,307.67,331.72,704.27,843.30,563.66,188.41,112.72,314.96,445.63,322.26,256.29,177.34,366.09,318.45,327.73,204.39,957.00,1525.96,1155.71,867.43,151.36,332.08,452.81,561.52,407.11,213.64;
220.77,284.76,366.65,422.76,308.74,215.44,967.16,2371.14,1864.37,500.86,388.03,1114.86,882.31,503.72,305.54,336.24,697.47,866.31,556.74,184.86,113.21,317.41,447.52,326.30,263.91,181.53,359.48,308.92,329.95,204.46,1016.80,1450.86,1180.23,910.78,153.38,332.08,469.01,550.01,407.10,214.35;
233.05,288.06,379.01,448.02,306.81,241.98,1019.21,2294.01,1868.08,547.19,405.21,1108.59,899.79,564.95,344.61,357.65,690.10,893.21,576.32,214.94,127.27,329.69,475.41,328.46,290.58,196.52,365.20,320.54,338.26,215.25,1122.31,1456.11,1245.57,1030.67,188.63,345.80,504.89,589.76,420.10,251.21;
252.38,296.50,371.44,466.07,320.50,286.19,966.47,2420.79,2317.30,588.25,471.02,1468.59,944.11,653.30,376.81,406.29,720.76,839.11,594.50,247.72,150.68,334.30,451.07,340.88,300.94,211.82,369.81,321.70,346.07,225.83,1102.43,1456.11,1185.57,1155.71,229.36,365.94,559.62,553.62,427.09,271.35;
246.66,301.72,370.87,460.41,320.37,297.70,1035.91,2488.21,2348.67,581.37,508.85,1460.83,947.33,708.08,365.28,422.76,750.46,822.55,588.63,250.25,155.18,327.55,451.07,342.30,311.94,218.92,387.39,324.01,352.55,229.91,1199.76,1728.20,1356.95,1181.48,229.40,382.76,573.50,573.43,420.10,286.55;
255.94,296.38,368.34,473.18,316.54,294.96,1005.99,2894.78,2399.51,633.09,507.28,1485.12,985.73,751.43,390.85,444.69,726.81,822.55,561.52,250.94,154.81,331.60,468.01,343.89,321.85,216.28,369.81,320.09,353.26,234.95,1151.33,1390.44,1263.20,1247.78,232.12,388.59,588.94,569.36,413.02,293.00;
256.22,293.08,359.45,475.92,318.21,298.17,1050.36,2548.90,2310.24,660.85,498.20,1543.12,996.46,765.27,388.31,445.63,743.81,840.91,555.47,255.43,155.68,325.07,466.92,338.50,326.94,216.25,378.02,328.58,365.04,235.14,1163.11,1680.25,1272.49,1247.78,231.67,388.50,590.39,556.18,406.48,288.14;
257.30,293.04,361.55,469.42,322.21,292.06,1115.92,2491.14,1802.35,616.28,508.68,1689.33,1016.01,732.72,402.08,434.15,765.01,780.35,579.88,249.58,155.65,324.42,451.07,340.88,316.20,220.97,385.77,318.11,355.60,233.04,1177.42,1571.10,1328.89,1247.78,228.43,374.38,611.66,550.30,406.65,287.89;
255.00,296.49,374.10,475.35,316.49,290.39,1020.82,2491.14,2703.52,616.23,517.40,1386.37,1016.01,722.40,388.31,440.23,761.55,777.56,566.47,253.25,153.84,320.57,454.37,341.78,327.68,220.81,379.77,330.69,349.33,233.04,1066.58,1602.21,1320.93,1131.00,231.71,374.38,591.76,545.42,416.54,286.21;
253.15,293.11,359.45,456.45,324.60,296.43,1098.63,2191.24,1777.29,637.77,505.70,1543.12,1036.33,754.02,391.63,445.44,723.12,826.06,560.95,253.25,153.84,333.67,470.60,342.97,319.30,217.16,391.19,326.06,365.75,231.96,1191.64,1665.13,1335.17,1188.11,232.62,379.46,621.28,562.20,413.02,281.83]';
img=inv_solve(inv_model, baseline, data(:,3));
K2=max(img.elem_data);
K1=min(img.elem_data);
colbar = linspace(K1,K2,10);
t_v=colbar; %ticks values
Y = (K2-K1)./2;
X = (K2+K1)./2;  
k=1;
i=1;
while i<14
    img=inv_solve(inv_model, baseline, data(:,k));
    subplot(3,5,i)
    frame=i;
    title(['Frame ',num2str(frame)])
    img.calc_colours.ref_level= X;
    img.calc_colours.clim= Y;
    cb = colorbar; 
    t_l=linspace(1,255,10);
    set(cb,'YTick', t_l'); set(cb,'YTickLabel', t_v');

    show_fem(img,[1,1]) 
    k=k+1;
    i=i+1;
end

%% respiro 30
respiro=[221.15,293.11,373.62,446.25,330.83,224.86,784.72,1574.79,1082.61,491.12,471.42,1752.23,1565.96,763.48,369.34,336.74,618.25,749.82,540.55,208.66,128.33,354.04,536.37,399.92,300.86,192.84,368.80,340.27,332.64,211.75,1191.64,1409.20,1249.63,1081.41,182.51,379.87,490.49,607.91,403.89,243.93;
235.78,307.07,357.35,462.37,330.93,252.64,728.28,1764.63,1267.82,491.12,517.93,2418.10,1633.59,810.04,409.62,348.82,546.50,693.19,538.05,233.52,140.54,333.51,496.31,799.84,581.33,203.09,367.60,338.97,336.56,254.17,1135.43,1571.10,1272.49,787.77,224.44,382.71,541.31,761.55,358.57,256.27;
235.07,405.26,271.28,454.87,322.61,280.42,634.78,1614.86,1181.48,524.74,466.83,2684.94,1839.04,907.64,419.15,221.92,239.19,277.60,265.51,164.33,257.53,618.20,752.32,797.42,600.37,207.34,384.82,332.44,335.50,253.42,1192.60,1508.70,1220.98,814.63,230.75,382.71,527.03,752.64,355.53,254.95;
231.30,402.40,276.61,462.05,328.79,272.95,619.46,1725.26,1160.43,509.66,442.39,2037.21,1633.59,823.40,386.11,214.77,239.77,288.63,273.46,156.66,215.03,658.67,699.47,799.84,590.86,197.47,373.46,338.97,334.78,247.94,1163.11,1378.34,1256.73,725.29,198.44,379.93,496.13,795.12,346.21,246.13;
229.61,396.77,270.47,466.07,324.66,267.15,629.64,1725.26,1094.62,481.42,441.52,2221.86,1821.56,794.54,386.11,219.26,236.83,284.97,269.09,160.45,226.08,621.28,715.41,786.10,597.88,199.05,364.13,335.38,337.49,251.42,1191.64,1571.10,1283.60,805.84,220.93,371.55,528.74,761.55,351.21,253.83;
243.16,411.10,274.58,462.05,324.65,285.10,653.30,1905.07,1247.78,532.89,397.41,1508.70,1129.91,716.74,389.05,221.72,605.20,782.89,565.74,243.96,146.96,340.12,516.04,387.32,320.92,207.00,369.81,332.52,347.74,222.77,1089.18,1456.11,1141.31,1244.10,208.51,368.95,568.34,594.30,410.31,258.95;
254.82,298.21,369.25,465.71,337.46,288.59,852.92,2133.62,1686.59,566.16,474.70,1551.57,1005.80,681.76,383.78,369.02,600.78,777.56,542.00,245.57,150.35,339.14,523.73,370.38,324.91,209.72,380.76,326.30,354.23,219.99,1249.63,1571.10,1260.14,1216.85,206.66,371.67,539.75,575.67,400.70,261.22;
249.80,301.61,370.10,456.80,337.35,280.17,942.04,2189.25,1791.32,604.36,448.29,1233.27,966.30,655.70,370.96,353.73,585.29,776.05,534.97,233.77,137.06,348.21,518.99,366.54,311.35,198.04,383.61,326.30,351.89,215.34,1135.43,1451.44,1200.74,1102.69,185.74,382.54,530.86,582.12,410.25,247.57;
251.91,307.02,378.52,465.71,330.83,277.18,965.10,1954.21,1820.42,566.16,429.74,1251.11,984.82,660.63,375.87,351.31,581.37,750.95,535.70,238.44,136.69,341.75,505.28,373.67,306.19,201.45,384.90,324.24,348.96,216.16,1161.02,1565.96,1113.55,1111.71,197.01,366.16,533.35,575.67,417.04,255.85;
255.05,305.20,377.29,469.42,328.82,289.55,917.61,2051.83,1634.42,603.48,469.18,1305.44,1005.60,646.78,392.47,374.41,587.48,727.40,571.19,242.94,150.74,354.54,511.81,382.45,319.68,208.18,373.59,328.76,354.64,222.72,1108.59,1499.64,1329.33,1259.76,212.37,379.96,560.05,588.71,417.02,258.91;
256.22,301.74,365.27,460.41,335.26,299.67,954.51,2431.65,1759.43,617.98,473.46,1437.13,914.68,673.49,384.22,382.71,587.71,733.92,533.35,247.19,149.47,355.59,507.21,382.45,314.83,205.58,378.30,318.11,345.58,222.81,1187.80,1515.93,1274.45,1180.23,202.60,371.67,560.32,574.62,403.79,253.74;
253.74,303.44,371.44,456.80,335.09,284.39,914.68,1942.96,1661.63,617.98,430.27,1245.20,898.68,609.58,373.55,348.94,580.77,733.92,560.95,231.90,134.87,344.39,525.07,371.70,306.50,199.82,373.62,324.60,354.24,218.08,1068.66,1565.96,1246.67,1099.64,186.69,382.54,544.53,582.12,410.25,247.62;
253.63,305.33,362.72,456.96,330.91,287.96,979.95,2491.14,2001.24,584.23,433.33,1222.02,913.67,623.29,385.04,358.70,602.31,743.96,545.42,239.05,142.79,352.49,521.23,384.08,314.22,203.15,372.17,322.21,348.43,217.20,1190.03,1397.13,1317.01,1081.89,203.73,366.06,550.30,574.62,407.06,256.16;
260.17,305.33,365.27,458.44,324.65,290.01,942.04,2371.14,1683.86,612.01,446.30,1288.45,913.67,648.48,393.40,379.80,591.76,765.01,556.18,248.92,150.78,344.76,518.67,381.05,330.03,207.34,373.46,316.35,357.25,223.92,1184.94,1651.27,1185.57,1207.38,214.78,374.26,551.22,594.30,410.25,265.69;
261.50,303.44,359.83,479.88,335.27,289.80,974.63,2228.14,1653.84,628.56,457.40,1447.39,1024.07,661.67,395.94,377.01,587.48,714.58,570.30,244.32,150.30,345.11,537.34,390.38,322.97,210.52,382.34,322.56,357.01,224.93,1108.59,1499.64,1158.06,1112.76,207.75,371.62,584.95,588.71,413.55,262.64;
257.22,299.95,372.33,477.92,337.47,290.17,954.51,1977.30,1942.96,607.74,448.89,1268.20,945.87,648.48,379.40,353.73,571.15,714.58,539.75,233.05,135.16,348.09,522.96,386.92,316.41,202.18,369.81,314.55,343.22,218.15,1164.61,1508.70,1260.14,1099.64,185.58,377.01,534.19,575.67,420.44,246.43]';
img=inv_solve(inv_model, baseline, respiro(:,1));
K2=max(img.elem_data);
K1=min(img.elem_data);
colbar = linspace(K1,K2,10);
t_v=colbar; %ticks values
Y = (K2-K1)./2;
X = (K2+K1)./2;  
maxima=[];
k=1;
i=1;
while i<14
    img=inv_solve(inv_model, baseline, respiro(:,k));
    subplot(3,5,i)
    frame=i;
    title(['Frame ',num2str(frame)])
    img.calc_colours.ref_level= X;
    img.calc_colours.clim= Y;
    cb = colorbar; 
    t_l=linspace(1,255,10);
    set(cb,'YTick', t_l'); set(cb,'YTickLabel', t_v');
    maxima=[maxima, max(img.elem_data)];
    show_fem(img,[1,1]) 
    k=k+1;
    i=i+1;
end
%% secondi 17-31
respiro2=[254.82,298.21,369.25,465.71,337.46,288.59,852.92,2133.62,1686.59,566.16,474.70,1551.57,1005.80,681.76,383.78,369.02,600.78,777.56,542.00,245.57,150.35,339.14,523.73,370.38,324.91,209.72,380.76,326.30,354.23,219.99,1249.63,1571.10,1260.14,1216.85,206.66,371.67,539.75,575.67,400.70,261.22;
249.80,301.61,370.10,456.80,337.35,280.17,942.04,2189.25,1791.32,604.36,448.29,1233.27,966.30,655.70,370.96,353.73,585.29,776.05,534.97,233.77,137.06,348.21,518.99,366.54,311.35,198.04,383.61,326.30,351.89,215.34,1135.43,1451.44,1200.74,1102.69,185.74,382.54,530.86,582.12,410.25,247.57;
251.91,307.02,378.52,465.71,330.83,277.18,965.10,1954.21,1820.42,566.16,429.74,1251.11,984.82,660.63,375.87,351.31,581.37,750.95,535.70,238.44,136.69,341.75,505.28,373.67,306.19,201.45,384.90,324.24,348.96,216.16,1161.02,1565.96,1113.55,1111.71,197.01,366.16,533.35,575.67,417.04,255.85;
255.05,305.20,377.29,469.42,328.82,289.55,917.61,2051.83,1634.42,603.48,469.18,1305.44,1005.60,646.78,392.47,374.41,587.48,727.40,571.19,242.94,150.74,354.54,511.81,382.45,319.68,208.18,373.59,328.76,354.64,222.72,1108.59,1499.64,1329.33,1259.76,212.37,379.96,560.05,588.71,417.02,258.91;
256.22,301.74,365.27,460.41,335.26,299.67,954.51,2431.65,1759.43,617.98,473.46,1437.13,914.68,673.49,384.22,382.71,587.71,733.92,533.35,247.19,149.47,355.59,507.21,382.45,314.83,205.58,378.30,318.11,345.58,222.81,1187.80,1515.93,1274.45,1180.23,202.60,371.67,560.32,574.62,403.79,253.74;
253.74,303.44,371.44,456.80,335.09,284.39,914.68,1942.96,1661.63,617.98,430.27,1245.20,898.68,609.58,373.55,348.94,580.77,733.92,560.95,231.90,134.87,344.39,525.07,371.70,306.50,199.82,373.62,324.60,354.24,218.08,1068.66,1565.96,1246.67,1099.64,186.69,382.54,544.53,582.12,410.25,247.62;
253.63,305.33,362.72,456.96,330.91,287.96,979.95,2491.14,2001.24,584.23,433.33,1222.02,913.67,623.29,385.04,358.70,602.31,743.96,545.42,239.05,142.79,352.49,521.23,384.08,314.22,203.15,372.17,322.21,348.43,217.20,1190.03,1397.13,1317.01,1081.89,203.73,366.06,550.30,574.62,407.06,256.16;
260.17,305.33,365.27,458.44,324.65,290.01,942.04,2371.14,1683.86,612.01,446.30,1288.45,913.67,648.48,393.40,379.80,591.76,765.01,556.18,248.92,150.78,344.76,518.67,381.05,330.03,207.34,373.46,316.35,357.25,223.92,1184.94,1651.27,1185.57,1207.38,214.78,374.26,551.22,594.30,410.25,265.69;
261.50,303.44,359.83,479.88,335.27,289.80,974.63,2228.14,1653.84,628.56,457.40,1447.39,1024.07,661.67,395.94,377.01,587.48,714.58,570.30,244.32,150.30,345.11,537.34,390.38,322.97,210.52,382.34,322.56,357.01,224.93,1108.59,1499.64,1158.06,1112.76,207.75,371.62,584.95,588.71,413.55,262.64;
257.22,299.95,372.33,477.92,337.47,290.17,954.51,1977.30,1942.96,607.74,448.89,1268.20,945.87,648.48,379.40,353.73,571.15,714.58,539.75,233.05,135.16,348.09,522.96,386.92,316.41,202.18,369.81,314.55,343.22,218.15,1164.61,1508.70,1260.14,1099.64,185.58,377.01,534.19,575.67,420.44,246.43;
252.44,305.25,367.07,462.05,339.70,281.03,1020.82,2310.24,1942.96,606.13,441.25,1204.71,897.72,628.51,381.39,361.09,559.02,716.74,524.82,233.05,139.90,349.25,526.56,398.99,595.34,204.39,367.60,322.10,355.97,253.85,1161.02,1369.96,1233.27,771.56,224.40,371.67,544.53,795.12,360.51,261.44;
257.37,398.23,268.27,460.02,332.98,291.11,925.19,2228.14,2317.30,604.36,365.27,1444.52,939.66,624.40,375.45,229.94,245.89,285.13,263.92,157.97,268.81,625.56,753.62,794.54,588.98,206.55,369.81,326.40,351.63,262.00,1112.76,1728.20,1272.49,843.52,237.87,379.96,535.70,819.08,361.20,253.63;
256.09,410.73,267.09,460.41,326.72,274.39,912.37,2371.14,1672.19,594.62,345.44,1215.48,912.37,630.93,362.72,213.88,236.83,283.23,268.74,151.43,217.95,648.69,761.46,774.63,540.94,193.63,371.18,312.57,342.21,246.66,1164.61,1444.52,1194.54,724.85,188.03,360.34,531.45,749.82,368.26,232.62;
234.22,392.53,269.21,460.46,322.61,233.89,857.55,2071.81,1878.07,545.42,317.38,1085.27,899.37,536.37,311.34,209.88,236.47,280.76,272.03,134.66,174.78,644.78,760.21,814.63,520.88,178.64,354.78,322.51,330.93,236.57,959.51,1468.59,1022.65,690.10,159.06,328.00,465.84,742.09,348.15,205.95;
217.97,398.07,271.07,435.51,316.42,205.82,851.86,1778.36,1590.61,493.18,311.69,1091.15,897.72,502.37,292.57,210.14,238.08,284.24,267.83,130.87,174.02,656.77,762.56,787.77,509.38,175.38,358.40,310.74,336.77,240.06,1025.71,1381.84,1095.62,704.00,167.11,331.72,456.83,716.53,357.45,215.24]';
%%
plot(maxima2)
%% 
k=1;
i=1;
maxima2=[];
while i<12
    img=inv_solve(inv_model, baseline, respiro2(:,k));
    subplot(3,5,i)
    frame=i;
    title(['Frame ',num2str(frame)])
    img.calc_colours.ref_level= 0;
    show_fem(img,[1,1])
    maxima2=[maxima2,max(img.elem_data)];
    k=k+1;
    i=i+1;
end
%% reference baseline-respiro2
img=inv_solve(inv_model, baseline, respiro2(:,2));
K2=max(img.elem_data);
K1=min(img.elem_data);
colbar = linspace(K1,K2,10);
t_v=colbar; %ticks values
Y = (K2-K1)./2;
X = (K2+K1)./2;  
maxima2=[];
k=1;
i=1;
while i<12
    img=inv_solve(inv_model, baseline, respiro2(:,k));
    subplot(3,5,i)
    frame=i;
    title(['Frame ',num2str(frame)])
    img.calc_colours.ref_level= X;
    img.calc_colours.clim= Y;
    cb = colorbar; 
    t_l=linspace(1,255,10);
    set(cb,'YTick', t_l'); set(cb,'YTickLabel', t_v');
    maxima2=[maxima2, max(img.elem_data)];
    show_fem(img,[1,1]) 
    k=k+1;
    i=i+1;
end
%% 30 s respiro
full_respiro=[221.15,293.11,373.62,446.25,330.83,224.86,784.72,1574.79,1082.61,491.12,471.42,1752.23,1565.96,763.48,369.34,336.74,618.25,749.82,540.55,208.66,128.33,354.04,536.37,399.92,300.86,192.84,368.80,340.27,332.64,211.75,1191.64,1409.20,1249.63,1081.41,182.51,379.87,490.49,607.91,403.89,243.93;
235.78,307.07,357.35,462.37,330.93,252.64,728.28,1764.63,1267.82,491.12,517.93,2418.10,1633.59,810.04,409.62,348.82,546.50,693.19,538.05,233.52,140.54,333.51,496.31,799.84,581.33,203.09,367.60,338.97,336.56,254.17,1135.43,1571.10,1272.49,787.77,224.44,382.71,541.31,761.55,358.57,256.27;
235.07,405.26,271.28,454.87,322.61,280.42,634.78,1614.86,1181.48,524.74,466.83,2684.94,1839.04,907.64,419.15,221.92,239.19,277.60,265.51,164.33,257.53,618.20,752.32,797.42,600.37,207.34,384.82,332.44,335.50,253.42,1192.60,1508.70,1220.98,814.63,230.75,382.71,527.03,752.64,355.53,254.95;
231.30,402.40,276.61,462.05,328.79,272.95,619.46,1725.26,1160.43,509.66,442.39,2037.21,1633.59,823.40,386.11,214.77,239.77,288.63,273.46,156.66,215.03,658.67,699.47,799.84,590.86,197.47,373.46,338.97,334.78,247.94,1163.11,1378.34,1256.73,725.29,198.44,379.93,496.13,795.12,346.21,246.13;
229.61,396.77,270.47,466.07,324.66,267.15,629.64,1725.26,1094.62,481.42,441.52,2221.86,1821.56,794.54,386.11,219.26,236.83,284.97,269.09,160.45,226.08,621.28,715.41,786.10,597.88,199.05,364.13,335.38,337.49,251.42,1191.64,1571.10,1283.60,805.84,220.93,371.55,528.74,761.55,351.21,253.83;
243.16,411.10,274.58,462.05,324.65,285.10,653.30,1905.07,1247.78,532.89,397.41,1508.70,1129.91,716.74,389.05,221.72,605.20,782.89,565.74,243.96,146.96,340.12,516.04,387.32,320.92,207.00,369.81,332.52,347.74,222.77,1089.18,1456.11,1141.31,1244.10,208.51,368.95,568.34,594.30,410.31,258.95;
254.82,298.21,369.25,465.71,337.46,288.59,852.92,2133.62,1686.59,566.16,474.70,1551.57,1005.80,681.76,383.78,369.02,600.78,777.56,542.00,245.57,150.35,339.14,523.73,370.38,324.91,209.72,380.76,326.30,354.23,219.99,1249.63,1571.10,1260.14,1216.85,206.66,371.67,539.75,575.67,400.70,261.22;
249.80,301.61,370.10,456.80,337.35,280.17,942.04,2189.25,1791.32,604.36,448.29,1233.27,966.30,655.70,370.96,353.73,585.29,776.05,534.97,233.77,137.06,348.21,518.99,366.54,311.35,198.04,383.61,326.30,351.89,215.34,1135.43,1451.44,1200.74,1102.69,185.74,382.54,530.86,582.12,410.25,247.57;
251.91,307.02,378.52,465.71,330.83,277.18,965.10,1954.21,1820.42,566.16,429.74,1251.11,984.82,660.63,375.87,351.31,581.37,750.95,535.70,238.44,136.69,341.75,505.28,373.67,306.19,201.45,384.90,324.24,348.96,216.16,1161.02,1565.96,1113.55,1111.71,197.01,366.16,533.35,575.67,417.04,255.85;
255.05,305.20,377.29,469.42,328.82,289.55,917.61,2051.83,1634.42,603.48,469.18,1305.44,1005.60,646.78,392.47,374.41,587.48,727.40,571.19,242.94,150.74,354.54,511.81,382.45,319.68,208.18,373.59,328.76,354.64,222.72,1108.59,1499.64,1329.33,1259.76,212.37,379.96,560.05,588.71,417.02,258.91;
256.22,301.74,365.27,460.41,335.26,299.67,954.51,2431.65,1759.43,617.98,473.46,1437.13,914.68,673.49,384.22,382.71,587.71,733.92,533.35,247.19,149.47,355.59,507.21,382.45,314.83,205.58,378.30,318.11,345.58,222.81,1187.80,1515.93,1274.45,1180.23,202.60,371.67,560.32,574.62,403.79,253.74;
253.74,303.44,371.44,456.80,335.09,284.39,914.68,1942.96,1661.63,617.98,430.27,1245.20,898.68,609.58,373.55,348.94,580.77,733.92,560.95,231.90,134.87,344.39,525.07,371.70,306.50,199.82,373.62,324.60,354.24,218.08,1068.66,1565.96,1246.67,1099.64,186.69,382.54,544.53,582.12,410.25,247.62;
253.63,305.33,362.72,456.96,330.91,287.96,979.95,2491.14,2001.24,584.23,433.33,1222.02,913.67,623.29,385.04,358.70,602.31,743.96,545.42,239.05,142.79,352.49,521.23,384.08,314.22,203.15,372.17,322.21,348.43,217.20,1190.03,1397.13,1317.01,1081.89,203.73,366.06,550.30,574.62,407.06,256.16;
260.17,305.33,365.27,458.44,324.65,290.01,942.04,2371.14,1683.86,612.01,446.30,1288.45,913.67,648.48,393.40,379.80,591.76,765.01,556.18,248.92,150.78,344.76,518.67,381.05,330.03,207.34,373.46,316.35,357.25,223.92,1184.94,1651.27,1185.57,1207.38,214.78,374.26,551.22,594.30,410.25,265.69;
261.50,303.44,359.83,479.88,335.27,289.80,974.63,2228.14,1653.84,628.56,457.40,1447.39,1024.07,661.67,395.94,377.01,587.48,714.58,570.30,244.32,150.30,345.11,537.34,390.38,322.97,210.52,382.34,322.56,357.01,224.93,1108.59,1499.64,1158.06,1112.76,207.75,371.62,584.95,588.71,413.55,262.64;
257.22,299.95,372.33,477.92,337.47,290.17,954.51,1977.30,1942.96,607.74,448.89,1268.20,945.87,648.48,379.40,353.73,571.15,714.58,539.75,233.05,135.16,348.09,522.96,386.92,316.41,202.18,369.81,314.55,343.22,218.15,1164.61,1508.70,1260.14,1099.64,185.58,377.01,534.19,575.67,420.44,246.43;
252.44,305.25,367.07,462.05,339.70,281.03,1020.82,2310.24,1942.96,606.13,441.25,1204.71,897.72,628.51,381.39,361.09,559.02,716.74,524.82,233.05,139.90,349.25,526.56,398.99,595.34,204.39,367.60,322.10,355.97,253.85,1161.02,1369.96,1233.27,771.56,224.40,371.67,544.53,795.12,360.51,261.44;
257.37,398.23,268.27,460.02,332.98,291.11,925.19,2228.14,2317.30,604.36,365.27,1444.52,939.66,624.40,375.45,229.94,245.89,285.13,263.92,157.97,268.81,625.56,753.62,794.54,588.98,206.55,369.81,326.40,351.63,262.00,1112.76,1728.20,1272.49,843.52,237.87,379.96,535.70,819.08,361.20,253.63;
256.09,410.73,267.09,460.41,326.72,274.39,912.37,2371.14,1672.19,594.62,345.44,1215.48,912.37,630.93,362.72,213.88,236.83,283.23,268.74,151.43,217.95,648.69,761.46,774.63,540.94,193.63,371.18,312.57,342.21,246.66,1164.61,1444.52,1194.54,724.85,188.03,360.34,531.45,749.82,368.26,232.62;
234.22,392.53,269.21,460.46,322.61,233.89,857.55,2071.81,1878.07,545.42,317.38,1085.27,899.37,536.37,311.34,209.88,236.47,280.76,272.03,134.66,174.78,644.78,760.21,814.63,520.88,178.64,354.78,322.51,330.93,236.57,959.51,1468.59,1022.65,690.10,159.06,328.00,465.84,742.09,348.15,205.95;
217.97,398.07,271.07,435.51,316.42,205.82,851.86,1778.36,1590.61,493.18,311.69,1091.15,897.72,502.37,292.57,210.14,238.08,284.24,267.83,130.87,174.02,656.77,762.56,787.77,509.38,175.38,358.40,310.74,336.77,240.06,1025.71,1381.84,1095.62,704.00,167.11,331.72,456.83,716.53,357.45,215.24;
226.90,403.85,268.27,439.26,318.31,218.12,800.62,2199.29,1849.77,487.98,313.56,1041.44,939.66,524.14,311.34,213.47,236.73,284.24,272.49,137.99,182.06,612.53,743.10,845.93,516.46,180.04,360.67,322.59,330.23,240.88,1025.71,1450.86,1058.37,704.27,170.17,334.24,457.11,721.83,360.51,215.67;
233.16,394.99,267.36,437.67,310.79,232.49,915.41,2329.22,1942.96,508.10,320.35,1129.91,899.37,535.70,325.30,209.12,235.29,282.67,265.76,140.23,190.85,644.22,753.62,815.04,527.48,183.31,357.03,318.31,336.24,238.13,1067.50,1378.34,1147.01,739.62,176.70,339.10,496.87,719.34,350.81,218.64;
237.56,412.07,271.54,466.02,320.29,242.77,924.73,2197.27,1942.96,532.89,321.65,1089.18,949.76,537.96,330.23,210.58,236.37,282.56,271.79,143.57,196.40,650.51,699.47,791.04,521.23,186.10,361.61,312.63,333.03,240.29,1020.82,1410.80,1123.65,755.00,184.09,343.49,490.96,716.53,348.43,221.46;
235.82,394.99,270.62,442.39,316.59,239.31,899.79,2465.11,1764.63,520.88,328.59,1138.78,899.79,549.00,344.01,214.36,236.15,282.43,266.89,144.58,196.07,621.28,753.62,840.46,538.29,186.85,361.83,320.29,337.84,244.40,1041.66,1311.40,1051.90,739.62,187.39,341.36,486.75,719.34,350.94,223.45;
241.09,399.03,269.91,466.23,318.58,245.47,999.67,2249.47,2076.90,548.75,331.08,1147.01,884.28,576.65,336.56,213.13,239.97,276.24,265.76,144.80,198.78,600.82,738.47,768.35,526.14,184.03,359.31,324.42,346.69,242.17,1105.76,1302.07,1081.65,738.85,188.01,348.30,486.75,739.39,348.56,227.41;
240.78,399.36,276.11,451.56,316.54,247.03,982.65,1977.30,2514.98,548.66,330.53,1199.76,915.99,555.17,350.55,214.91,239.97,277.73,265.76,145.92,198.79,644.22,712.17,795.12,518.24,188.82,366.43,316.54,333.51,244.08,1043.38,1415.09,1120.16,779.99,185.29,353.35,516.46,729.23,359.95,227.17;
243.47,398.07,268.05,434.46,320.44,238.19,986.27,2590.82,2150.43,542.36,320.02,1276.03,915.99,573.43,350.12,220.20,236.66,276.37,265.76,143.96,207.33,654.79,719.91,780.35,505.14,187.30,365.28,314.41,333.59,250.12,1117.77,1508.05,1246.67,797.13,195.39,353.55,495.20,726.52,355.80,231.50;
244.89,402.21,267.09,437.67,322.51,251.22,991.42,2781.90,2122.63,562.03,328.78,1181.48,966.30,604.53,365.75,216.42,237.93,277.31,265.26,149.54,218.12,646.78,742.71,768.70,554.10,192.91,367.60,326.40,337.84,249.09,1114.86,1515.93,1123.65,771.04,204.46,370.74,534.97,765.01,350.52,247.32;
252.00,403.15,266.89,448.04,324.49,290.38,919.22,2310.24,2456.62,618.56,356.59,1347.09,947.33,672.85,391.47,219.83,242.57,281.51,265.26,158.30,242.67,635.22,737.17,795.12,566.05,204.09,373.46,322.46,355.31,253.80,1181.48,1359.33,1300.40,853.39,238.64,370.92,557.13,791.04,363.57,261.66;
253.69,409.06,268.49,462.05,326.72,294.85,1016.80,2641.86,2249.47,613.58,361.96,1373.88,1020.82,673.49,387.52,226.80,246.06,279.24,274.15,161.16,262.34,648.69,739.62,754.27,560.32,209.12,374.55,326.06,349.99,260.78,1191.64,1400.77,1260.14,873.95,240.81,376.52,577.56,822.55,353.69,262.97]';

k=1;
i=1;

while i<11
    img=inv_solve(inv_model, baseline, full_respiro(:,k));
    subplot(2,5,i)
    frame=i;
    title(['Frame ',num2str(frame)])
    img.calc_colours.ref_level= 0;
    show_fem(img,[1,1])
    %maxima2=[maxima2,max(img.elem_data)];
    k=k+1;
    i=i+1;
end
%%
k=k+1;
i=k;
img=inv_solve(inv_model, baseline, full_respiro(:,k));
frame=i;
title(['Frame ',num2str(frame)])
img.calc_colours.ref_level= 0;
img.calc_colours.clim= Y;
    cb = colorbar; 
    t_l=linspace(1,255,10);
    set(cb,'YTick', t_l'); set(cb,'YTickLabel', t_v');
show_fem(img,[1,1])
%% full respiro reference inspiration
k=1;
i=1;
maxima3=[];
while i<32
    img=inv_solve(inv_model, baseline, full_respiro(:,k));
    %subplot(3,5,i)
    %frame=i;
    %title(['Frame ',num2str(frame)])
    img.calc_colours.ref_level= X;
    img.calc_colours.clim= Y;
    cb = colorbar; 
    t_l=linspace(1,255,10);
    set(cb,'YTick', t_l'); set(cb,'YTickLabel', t_v');
    maxima3=[maxima3, max(img.elem_data)];
    %show_fem(img,[1,1]) 
    k=k+1;
    i=i+1;
end
plot(maxima3)
%%
plot(maxima3(7:31))
%% full inspiration
%empty
baseline=[255.00,296.49,374.10,475.35,316.49,290.39,1020.82,2491.14,2703.52,616.23,517.40,1386.37,1016.01,722.40,388.31,440.23,761.55,777.56,566.47,253.25,153.84,320.57,454.37,341.78,327.68,220.81,379.77,330.69,349.33,233.04,1066.58,1602.21,1320.93,1131.00,231.71,374.38,591.76,545.42,416.54,286.21]';
data=[251.21,294.78,376.64,464.07,316.54,300.75,1066.35,2564.79,2045.29,599.22,478.50,1318.75,998.91,648.02,396.40,397.34,702.15,884.80,587.13,250.00,147.25,319.89,454.35,339.70,297.02,206.29,375.87,328.15,349.99,219.95,1126.36,1415.63,1282.39,1210.40,210.42,371.67,540.55,573.43,406.99,256.32]';
img=inv_solve(inv_model, baseline, data);
show_fem(img,[1,1])
K2=max(img.elem_data);
K1=min(img.elem_data);
colbar = linspace(K1,K2,10);
t_v=colbar; %ticks values
Y = (K2-K1)./2;
X = (K2+K1)./2;  
%%
data=[232.83,388.31,264.37,466.07,318.45,289.16,607.02,1605.34,1208.72,516.66,496.24,2684.94,2197.27,866.44,418.02,229.94,623.43,714.03,532.00,242.55,153.57,340.97,494.39,391.74,319.32,213.37,374.74,338.67,337.32,223.83,1218.22,1660.76,1335.17,1274.45,222.26,388.50,547.03,592.47,410.25,265.61;
237.95,301.72,362.72,479.65,320.57,270.52,753.29,1911.68,1124.73,502.90,573.18,2696.04,1868.08,853.74,419.04,397.59,618.96,714.03,544.19,243.56,153.54,346.30,516.48,407.24,316.45,209.08,386.16,341.21,340.55,223.89,1219.94,1571.10,1335.17,1219.60,222.29,388.56,544.53,564.95,403.89,266.99;
235.07,301.69,356.98,460.63,322.61,270.39,772.87,1652.12,1134.32,518.99,585.14,2418.10,2129.94,886.39,430.27,388.50,585.60,708.29,547.03,241.28,157.64,366.30,554.69,414.36,331.91,211.66,371.18,338.67,340.97,226.75,1184.94,1529.34,1170.35,1288.04,220.15,382.76,545.42,562.20,400.64,269.53;
239.05,303.52,358.97,455.10,330.38,268.59,772.87,1637.75,1124.73,504.89,569.07,2418.10,2211.52,959.68,425.68,231.79,244.96,276.98,270.48,163.56,261.60,665.06,753.05,777.56,628.56,209.93,373.62,340.90,340.12,262.00,1215.82,1590.61,1390.44,892.27,245.98,385.64,528.74,779.54,350.67,265.55;
238.21,410.35,271.07,458.71,326.72,288.93,606.00,1689.33,1317.01,521.23,473.14,2845.37,1803.46,947.81,408.59,225.37,242.65,757.88,566.47,171.22,262.34,623.84,739.62,797.42,602.81,209.88,372.17,334.87,338.75,260.78,1218.22,1541.03,1328.89,895.53,241.89,394.54,529.50,740.62,355.36,265.61;
236.86,396.77,263.75,473.97,328.58,294.15,644.02,1930.54,1160.43,528.48,479.57,2418.10,1967.10,884.80,414.80,226.36,241.57,280.89,265.81,165.75,263.46,648.69,690.10,792.08,621.28,211.38,387.39,340.27,336.95,259.12,1219.94,1378.34,1378.84,884.67,237.78,385.64,545.42,733.62,346.47,268.53;
234.00,401.90,264.64,458.44,322.59,289.55,663.28,1634.42,1328.89,523.70,486.16,2431.65,2050.19,899.79,420.03,224.39,242.65,282.30,264.73,165.74,265.71,648.69,690.10,777.56,607.19,213.47,387.39,335.13,340.12,259.95,1219.94,1415.09,1200.74,894.98,239.83,403.45,531.45,731.83,353.63,269.88;
234.95,394.01,264.87,458.71,322.10,288.93,627.94,1905.07,1176.49,514.17,501.91,2439.89,1922.39,939.98,416.76,225.25,241.51,274.20,264.73,166.27,254.05,650.51,740.62,764.67,587.71,209.03,374.55,342.30,339.52,261.63,1218.22,1565.96,1288.04,863.36,240.16,388.59,529.50,750.95,353.63,267.07;
236.86,392.53,267.36,464.37,324.65,280.16,637.77,1689.33,1232.56,518.99,497.24,2684.94,2129.94,923.54,415.79,224.50,242.72,789.16,549.54,247.34,149.88,323.59,459.98,359.05,294.93,207.39,374.74,332.44,340.55,218.00,1241.91,1479.55,1335.17,1210.40,211.53,403.45,524.14,569.36,417.02,259.98;
232.59,286.50,368.23,458.71,324.60,246.65,810.55,1652.12,1185.26,516.66,503.29,2322.05,1975.84,789.16,393.67,355.53,693.38,835.54,544.93,232.81,132.84,326.33,464.70,363.72,276.79,198.87,379.80,346.64,336.56,208.98,1158.36,1489.49,1340.18,1042.73,179.69,388.50,497.17,582.12,423.57,238.27;
221.84,291.45,380.04,451.35,324.63,229.39,774.37,1508.70,1091.15,478.56,469.73,1949.97,1803.46,714.58,360.38,330.11,631.31,816.79,539.92,206.88,116.58,325.56,458.69,352.79,265.52,188.35,365.28,332.71,324.68,202.92,1114.86,1307.99,1240.82,980.31,160.60,363.35,469.64,598.49,413.66,231.25]';
i=1;
while i<14
    img=inv_solve(inv_model, data(:,1), data(:,i));
    subplot(3,5,i)
    frame=i;
    title(['Frame ',num2str(frame)])
    %img.calc_colours.ref_level= 0;
    show_fem(img,[1,1]) 
    k=k+1;
    i=i+1;
end

%%
full_data=[232.83,388.31,264.37,466.07,318.45,289.16,607.02,1605.34,1208.72,516.66,496.24,2684.94,2197.27,866.44,418.02,229.94,623.43,714.03,532.00,242.55,153.57,340.97,494.39,391.74,319.32,213.37,374.74,338.67,337.32,223.83,1218.22,1660.76,1335.17,1274.45,222.26,388.50,547.03,592.47,410.25,265.61;
237.95,301.72,362.72,479.65,320.57,270.52,753.29,1911.68,1124.73,502.90,573.18,2696.04,1868.08,853.74,419.04,397.59,618.96,714.03,544.19,243.56,153.54,346.30,516.48,407.24,316.45,209.08,386.16,341.21,340.55,223.89,1219.94,1571.10,1335.17,1219.60,222.29,388.56,544.53,564.95,403.89,266.99;
235.07,301.69,356.98,460.63,322.61,270.39,772.87,1652.12,1134.32,518.99,585.14,2418.10,2129.94,886.39,430.27,388.50,585.60,708.29,547.03,241.28,157.64,366.30,554.69,414.36,331.91,211.66,371.18,338.67,340.97,226.75,1184.94,1529.34,1170.35,1288.04,220.15,382.76,545.42,562.20,400.64,269.53;
239.05,303.52,358.97,455.10,330.38,268.59,772.87,1637.75,1124.73,504.89,569.07,2418.10,2211.52,959.68,425.68,231.79,244.96,276.98,270.48,163.56,261.60,665.06,753.05,777.56,628.56,209.93,373.62,340.90,340.12,262.00,1215.82,1590.61,1390.44,892.27,245.98,385.64,528.74,779.54,350.67,265.55;
238.21,410.35,271.07,458.71,326.72,288.93,606.00,1689.33,1317.01,521.23,473.14,2845.37,1803.46,947.81,408.59,225.37,242.65,757.88,566.47,171.22,262.34,623.84,739.62,797.42,602.81,209.88,372.17,334.87,338.75,260.78,1218.22,1541.03,1328.89,895.53,241.89,394.54,529.50,740.62,355.36,265.61;
236.86,396.77,263.75,473.97,328.58,294.15,644.02,1930.54,1160.43,528.48,479.57,2418.10,1967.10,884.80,414.80,226.36,241.57,280.89,265.81,165.75,263.46,648.69,690.10,792.08,621.28,211.38,387.39,340.27,336.95,259.12,1219.94,1378.34,1378.84,884.67,237.78,385.64,545.42,733.62,346.47,268.53;
234.00,401.90,264.64,458.44,322.59,289.55,663.28,1634.42,1328.89,523.70,486.16,2431.65,2050.19,899.79,420.03,224.39,242.65,282.30,264.73,165.74,265.71,648.69,690.10,777.56,607.19,213.47,387.39,335.13,340.12,259.95,1219.94,1415.09,1200.74,894.98,239.83,403.45,531.45,731.83,353.63,269.88;
234.95,394.01,264.87,458.71,322.10,288.93,627.94,1905.07,1176.49,514.17,501.91,2439.89,1922.39,939.98,416.76,225.25,241.51,274.20,264.73,166.27,254.05,650.51,740.62,764.67,587.71,209.03,374.55,342.30,339.52,261.63,1218.22,1565.96,1288.04,863.36,240.16,388.59,529.50,750.95,353.63,267.07;
236.86,392.53,267.36,464.37,324.65,280.16,637.77,1689.33,1232.56,518.99,497.24,2684.94,2129.94,923.54,415.79,224.50,242.72,789.16,549.54,247.34,149.88,323.59,459.98,359.05,294.93,207.39,374.74,332.44,340.55,218.00,1241.91,1479.55,1335.17,1210.40,211.53,403.45,524.14,569.36,417.02,259.98;
232.59,286.50,368.23,458.71,324.60,246.65,810.55,1652.12,1185.26,516.66,503.29,2322.05,1975.84,789.16,393.67,355.53,693.38,835.54,544.93,232.81,132.84,326.33,464.70,363.72,276.79,198.87,379.80,346.64,336.56,208.98,1158.36,1489.49,1340.18,1042.73,179.69,388.50,497.17,582.12,423.57,238.27;
221.84,291.45,380.04,451.35,324.63,229.39,774.37,1508.70,1091.15,478.56,469.73,1949.97,1803.46,714.58,360.38,330.11,631.31,816.79,539.92,206.88,116.58,325.56,458.69,352.79,265.52,188.35,365.28,332.71,324.68,202.92,1114.86,1307.99,1240.82,980.31,160.60,363.35,469.64,598.49,413.66,231.25;
221.15,293.11,373.62,446.25,330.83,224.86,784.72,1574.79,1082.61,491.12,471.42,1752.23,1565.96,763.48,369.34,336.74,618.25,749.82,540.55,208.66,128.33,354.04,536.37,399.92,300.86,192.84,368.80,340.27,332.64,211.75,1191.64,1409.20,1249.63,1081.41,182.51,379.87,490.49,607.91,403.89,243.93;
235.78,307.07,357.35,462.37,330.93,252.64,728.28,1764.63,1267.82,491.12,517.93,2418.10,1633.59,810.04,409.62,348.82,546.50,693.19,538.05,233.52,140.54,333.51,496.31,799.84,581.33,203.09,367.60,338.97,336.56,254.17,1135.43,1571.10,1272.49,787.77,224.44,382.71,541.31,761.55,358.57,256.27;
235.07,405.26,271.28,454.87,322.61,280.42,634.78,1614.86,1181.48,524.74,466.83,2684.94,1839.04,907.64,419.15,221.92,239.19,277.60,265.51,164.33,257.53,618.20,752.32,797.42,600.37,207.34,384.82,332.44,335.50,253.42,1192.60,1508.70,1220.98,814.63,230.75,382.71,527.03,752.64,355.53,254.95;
231.30,402.40,276.61,462.05,328.79,272.95,619.46,1725.26,1160.43,509.66,442.39,2037.21,1633.59,823.40,386.11,214.77,239.77,288.63,273.46,156.66,215.03,658.67,699.47,799.84,590.86,197.47,373.46,338.97,334.78,247.94,1163.11,1378.34,1256.73,725.29,198.44,379.93,496.13,795.12,346.21,246.13;
229.61,396.77,270.47,466.07,324.66,267.15,629.64,1725.26,1094.62,481.42,441.52,2221.86,1821.56,794.54,386.11,219.26,236.83,284.97,269.09,160.45,226.08,621.28,715.41,786.10,597.88,199.05,364.13,335.38,337.49,251.42,1191.64,1571.10,1283.60,805.84,220.93,371.55,528.74,761.55,351.21,253.83;
243.16,411.10,274.58,462.05,324.65,285.10,653.30,1905.07,1247.78,532.89,397.41,1508.70,1129.91,716.74,389.05,221.72,605.20,782.89,565.74,243.96,146.96,340.12,516.04,387.32,320.92,207.00,369.81,332.52,347.74,222.77,1089.18,1456.11,1141.31,1244.10,208.51,368.95,568.34,594.30,410.31,258.95;
254.82,298.21,369.25,465.71,337.46,288.59,852.92,2133.62,1686.59,566.16,474.70,1551.57,1005.80,681.76,383.78,369.02,600.78,777.56,542.00,245.57,150.35,339.14,523.73,370.38,324.91,209.72,380.76,326.30,354.23,219.99,1249.63,1571.10,1260.14,1216.85,206.66,371.67,539.75,575.67,400.70,261.22;
249.80,301.61,370.10,456.80,337.35,280.17,942.04,2189.25,1791.32,604.36,448.29,1233.27,966.30,655.70,370.96,353.73,585.29,776.05,534.97,233.77,137.06,348.21,518.99,366.54,311.35,198.04,383.61,326.30,351.89,215.34,1135.43,1451.44,1200.74,1102.69,185.74,382.54,530.86,582.12,410.25,247.57;
251.91,307.02,378.52,465.71,330.83,277.18,965.10,1954.21,1820.42,566.16,429.74,1251.11,984.82,660.63,375.87,351.31,581.37,750.95,535.70,238.44,136.69,341.75,505.28,373.67,306.19,201.45,384.90,324.24,348.96,216.16,1161.02,1565.96,1113.55,1111.71,197.01,366.16,533.35,575.67,417.04,255.85;
255.05,305.20,377.29,469.42,328.82,289.55,917.61,2051.83,1634.42,603.48,469.18,1305.44,1005.60,646.78,392.47,374.41,587.48,727.40,571.19,242.94,150.74,354.54,511.81,382.45,319.68,208.18,373.59,328.76,354.64,222.72,1108.59,1499.64,1329.33,1259.76,212.37,379.96,560.05,588.71,417.02,258.91;
256.22,301.74,365.27,460.41,335.26,299.67,954.51,2431.65,1759.43,617.98,473.46,1437.13,914.68,673.49,384.22,382.71,587.71,733.92,533.35,247.19,149.47,355.59,507.21,382.45,314.83,205.58,378.30,318.11,345.58,222.81,1187.80,1515.93,1274.45,1180.23,202.60,371.67,560.32,574.62,403.79,253.74;
253.74,303.44,371.44,456.80,335.09,284.39,914.68,1942.96,1661.63,617.98,430.27,1245.20,898.68,609.58,373.55,348.94,580.77,733.92,560.95,231.90,134.87,344.39,525.07,371.70,306.50,199.82,373.62,324.60,354.24,218.08,1068.66,1565.96,1246.67,1099.64,186.69,382.54,544.53,582.12,410.25,247.62;
253.63,305.33,362.72,456.96,330.91,287.96,979.95,2491.14,2001.24,584.23,433.33,1222.02,913.67,623.29,385.04,358.70,602.31,743.96,545.42,239.05,142.79,352.49,521.23,384.08,314.22,203.15,372.17,322.21,348.43,217.20,1190.03,1397.13,1317.01,1081.89,203.73,366.06,550.30,574.62,407.06,256.16;
260.17,305.33,365.27,458.44,324.65,290.01,942.04,2371.14,1683.86,612.01,446.30,1288.45,913.67,648.48,393.40,379.80,591.76,765.01,556.18,248.92,150.78,344.76,518.67,381.05,330.03,207.34,373.46,316.35,357.25,223.92,1184.94,1651.27,1185.57,1207.38,214.78,374.26,551.22,594.30,410.25,265.69;
261.50,303.44,359.83,479.88,335.27,289.80,974.63,2228.14,1653.84,628.56,457.40,1447.39,1024.07,661.67,395.94,377.01,587.48,714.58,570.30,244.32,150.30,345.11,537.34,390.38,322.97,210.52,382.34,322.56,357.01,224.93,1108.59,1499.64,1158.06,1112.76,207.75,371.62,584.95,588.71,413.55,262.64;
257.22,299.95,372.33,477.92,337.47,290.17,954.51,1977.30,1942.96,607.74,448.89,1268.20,945.87,648.48,379.40,353.73,571.15,714.58,539.75,233.05,135.16,348.09,522.96,386.92,316.41,202.18,369.81,314.55,343.22,218.15,1164.61,1508.70,1260.14,1099.64,185.58,377.01,534.19,575.67,420.44,246.43;
252.44,305.25,367.07,462.05,339.70,281.03,1020.82,2310.24,1942.96,606.13,441.25,1204.71,897.72,628.51,381.39,361.09,559.02,716.74,524.82,233.05,139.90,349.25,526.56,398.99,595.34,204.39,367.60,322.10,355.97,253.85,1161.02,1369.96,1233.27,771.56,224.40,371.67,544.53,795.12,360.51,261.44;
257.37,398.23,268.27,460.02,332.98,291.11,925.19,2228.14,2317.30,604.36,365.27,1444.52,939.66,624.40,375.45,229.94,245.89,285.13,263.92,157.97,268.81,625.56,753.62,794.54,588.98,206.55,369.81,326.40,351.63,262.00,1112.76,1728.20,1272.49,843.52,237.87,379.96,535.70,819.08,361.20,253.63;
256.09,410.73,267.09,460.41,326.72,274.39,912.37,2371.14,1672.19,594.62,345.44,1215.48,912.37,630.93,362.72,213.88,236.83,283.23,268.74,151.43,217.95,648.69,761.46,774.63,540.94,193.63,371.18,312.57,342.21,246.66,1164.61,1444.52,1194.54,724.85,188.03,360.34,531.45,749.82,368.26,232.62;
234.22,392.53,269.21,460.46,322.61,233.89,857.55,2071.81,1878.07,545.42,317.38,1085.27,899.37,536.37,311.34,209.88,236.47,280.76,272.03,134.66,174.78,644.78,760.21,814.63,520.88,178.64,354.78,322.51,330.93,236.57,959.51,1468.59,1022.65,690.10,159.06,328.00,465.84,742.09,348.15,205.95;
217.97,398.07,271.07,435.51,316.42,205.82,851.86,1778.36,1590.61,493.18,311.69,1091.15,897.72,502.37,292.57,210.14,238.08,284.24,267.83,130.87,174.02,656.77,762.56,787.77,509.38,175.38,358.40,310.74,336.77,240.06,1025.71,1381.84,1095.62,704.00,167.11,331.72,456.83,716.53,357.45,215.24;
226.90,403.85,268.27,439.26,318.31,218.12,800.62,2199.29,1849.77,487.98,313.56,1041.44,939.66,524.14,311.34,213.47,236.73,284.24,272.49,137.99,182.06,612.53,743.10,845.93,516.46,180.04,360.67,322.59,330.23,240.88,1025.71,1450.86,1058.37,704.27,170.17,334.24,457.11,721.83,360.51,215.67;
233.16,394.99,267.36,437.67,310.79,232.49,915.41,2329.22,1942.96,508.10,320.35,1129.91,899.37,535.70,325.30,209.12,235.29,282.67,265.76,140.23,190.85,644.22,753.62,815.04,527.48,183.31,357.03,318.31,336.24,238.13,1067.50,1378.34,1147.01,739.62,176.70,339.10,496.87,719.34,350.81,218.64;
237.56,412.07,271.54,466.02,320.29,242.77,924.73,2197.27,1942.96,532.89,321.65,1089.18,949.76,537.96,330.23,210.58,236.37,282.56,271.79,143.57,196.40,650.51,699.47,791.04,521.23,186.10,361.61,312.63,333.03,240.29,1020.82,1410.80,1123.65,755.00,184.09,343.49,490.96,716.53,348.43,221.46;
235.82,394.99,270.62,442.39,316.59,239.31,899.79,2465.11,1764.63,520.88,328.59,1138.78,899.79,549.00,344.01,214.36,236.15,282.43,266.89,144.58,196.07,621.28,753.62,840.46,538.29,186.85,361.83,320.29,337.84,244.40,1041.66,1311.40,1051.90,739.62,187.39,341.36,486.75,719.34,350.94,223.45;
241.09,399.03,269.91,466.23,318.58,245.47,999.67,2249.47,2076.90,548.75,331.08,1147.01,884.28,576.65,336.56,213.13,239.97,276.24,265.76,144.80,198.78,600.82,738.47,768.35,526.14,184.03,359.31,324.42,346.69,242.17,1105.76,1302.07,1081.65,738.85,188.01,348.30,486.75,739.39,348.56,227.41;
240.78,399.36,276.11,451.56,316.54,247.03,982.65,1977.30,2514.98,548.66,330.53,1199.76,915.99,555.17,350.55,214.91,239.97,277.73,265.76,145.92,198.79,644.22,712.17,795.12,518.24,188.82,366.43,316.54,333.51,244.08,1043.38,1415.09,1120.16,779.99,185.29,353.35,516.46,729.23,359.95,227.17;
243.47,398.07,268.05,434.46,320.44,238.19,986.27,2590.82,2150.43,542.36,320.02,1276.03,915.99,573.43,350.12,220.20,236.66,276.37,265.76,143.96,207.33,654.79,719.91,780.35,505.14,187.30,365.28,314.41,333.59,250.12,1117.77,1508.05,1246.67,797.13,195.39,353.55,495.20,726.52,355.80,231.50;
244.89,402.21,267.09,437.67,322.51,251.22,991.42,2781.90,2122.63,562.03,328.78,1181.48,966.30,604.53,365.75,216.42,237.93,277.31,265.26,149.54,218.12,646.78,742.71,768.70,554.10,192.91,367.60,326.40,337.84,249.09,1114.86,1515.93,1123.65,771.04,204.46,370.74,534.97,765.01,350.52,247.32;
252.00,403.15,266.89,448.04,324.49,290.38,919.22,2310.24,2456.62,618.56,356.59,1347.09,947.33,672.85,391.47,219.83,242.57,281.51,265.26,158.30,242.67,635.22,737.17,795.12,566.05,204.09,373.46,322.46,355.31,253.80,1181.48,1359.33,1300.40,853.39,238.64,370.92,557.13,791.04,363.57,261.66;
253.69,409.06,268.49,462.05,326.72,294.85,1016.80,2641.86,2249.47,613.58,361.96,1373.88,1020.82,673.49,387.52,226.80,246.06,279.24,274.15,161.16,262.34,648.69,739.62,754.27,560.32,209.12,374.55,326.06,349.99,260.78,1191.64,1400.77,1260.14,873.95,240.81,376.52,577.56,822.55,353.69,262.97;
251.15,417.09,265.72,451.35,320.57,298.69,989.20,2703.52,2245.15,625.51,356.19,1468.59,948.46,674.01,387.93,225.25,245.03,276.98,265.00,159.05,259.39,640.80,728.06,815.04,576.65,206.46,383.60,324.01,351.63,257.48,1122.31,1525.96,1311.40,852.92,234.48,379.87,546.26,810.04,353.63,261.30;
248.51,396.77,265.52,454.87,324.55,293.21,1105.50,2533.31,2420.79,629.08,355.33,1265.89,965.10,628.51,367.48,219.83,239.19,284.97,266.08,155.14,226.42,642.55,749.18,799.06,556.74,195.78,362.89,320.50,342.21,248.37,1043.38,1333.37,1274.45,755.49,204.09,368.88,521.23,783.62,361.09,241.51;
240.31,394.99,266.45,442.85,320.59,275.72,1004.06,2533.31,2045.29,614.99,338.02,1222.02,948.46,622.60,361.96,214.77,239.11,280.32,269.09,151.99,208.12,639.35,721.33,362.77,535.93,195.16,362.97,316.25,338.85,249.09,1045.98,1390.44,1219.60,771.56,197.76,363.57,533.35,795.12,356.01,246.20;
251.08,392.53,264.41,460.61,330.50,284.60,989.20,2085.47,2211.52,642.15,344.01,1194.22,947.33,607.91,387.52,221.82,242.23,284.80,265.00,155.59,233.65,639.35,747.83,815.04,572.79,205.35,367.48,316.25,346.14,256.66,1067.73,1553.70,1245.57,814.63,220.10,374.26,576.65,836.10,358.15,258.99;
258.42,394.14,268.48,475.92,320.59,293.31,974.63,2666.74,2076.90,606.00,367.86,1265.89,912.37,640.75,379.40,221.82,240.44,284.62,273.59,160.06,252.96,653.89,710.73,811.06,544.28,209.88,368.72,320.09,360.80,258.71,1066.58,1499.64,1123.65,863.36,239.73,371.55,560.95,754.27,358.49,264.32;
256.09,405.30,268.48,458.44,318.58,297.70,993.65,2247.31,2610.88,648.85,351.76,1362.21,981.93,648.48,379.40,224.39,245.89,286.72,271.89,160.00,244.53,644.22,739.62,779.72,571.90,206.46,375.87,324.55,352.30,255.05,1158.36,1490.75,1182.42,814.63,220.14,369.00,536.37,795.12,351.21,256.36;
244.89,399.65,268.27,456.80,322.61,277.72,974.63,2007.36,1972.91,594.62,340.57,1288.45,883.88,620.00,373.16,217.15,236.91,278.65,270.76,152.42,207.67,640.80,751.43,794.83,526.14,197.34,366.39,320.29,346.69,250.25,1165.51,1489.49,1102.69,738.85,196.40,363.65,532.48,783.62,351.13,243.99;
242.72,405.26,268.48,448.02,320.59,273.75,1045.98,2199.29,2703.52,617.98,348.21,1177.42,869.42,595.82,373.91,217.15,239.11,279.99,272.71,156.18,224.15,647.29,730.12,811.06,551.34,203.72,375.87,326.56,349.99,256.48,1165.51,1333.37,1169.44,755.49,212.40,373.78,537.96,772.43,346.21,252.49;
255.56,395.46,265.31,460.41,320.59,296.30,1059.50,2163.78,2456.62,633.09,354.90,1327.55,967.16,640.75,391.25,225.10,238.01,287.97,265.81,159.05,250.21,624.03,737.17,789.16,571.90,206.46,373.46,322.10,347.71,253.42,1164.61,1381.84,1177.42,851.98,236.30,363.47,539.75,772.43,348.82,262.97;
256.27,395.46,269.21,466.25,324.60,300.75,1087.47,2431.65,1802.35,606.34,369.69,1228.31,897.72,665.28,387.93,220.97,243.72,283.86,267.16,159.10,245.15,632.89,689.17,761.55,535.14,204.86,371.08,322.10,349.99,258.29,1191.64,1565.96,1288.45,796.74,217.62,369.00,542.58,819.08,355.53,255.05;
249.80,394.01,273.46,453.36,326.49,279.07,989.20,2282.63,2376.23,629.08,338.75,1208.38,896.48,624.81,361.96,218.16,239.66,281.51,272.71,153.67,215.47,653.89,749.18,804.15,538.02,197.82,374.74,318.21,346.68,247.59,1064.97,1479.55,1219.94,731.83,198.44,373.62,534.19,799.06,351.13,238.15;
247.24,414.08,266.23,449.81,333.08,281.79,1021.43,2465.11,2158.03,584.23,347.06,1274.06,983.55,620.00,378.61,221.72,240.31,286.72,270.20,155.01,232.20,598.53,710.73,772.43,532.92,200.76,377.29,318.55,349.99,250.69,1105.76,1398.69,1135.43,824.14,218.04,358.15,538.88,799.06,356.08,253.74;
253.04,418.60,269.66,448.04,326.40,288.19,993.83,2122.63,2273.64,610.27,364.89,1372.90,931.26,680.08,381.81,220.87,243.37,284.80,272.71,158.10,251.91,631.31,749.18,752.64,568.38,209.03,372.33,326.30,346.07,260.72,1115.12,1607.71,1163.11,832.45,236.38,363.65,577.56,783.62,361.09,264.32;
254.95,396.55,268.24,470.05,322.61,298.69,1001.38,3017.39,2338.88,634.83,370.47,1437.13,1001.00,648.48,394.23,228.70,241.57,275.67,265.81,159.71,259.73,642.55,738.47,823.40,565.19,208.87,368.72,321.98,343.22,257.48,1219.94,1499.64,1170.35,843.30,231.61,371.62,551.22,765.01,353.55,261.55;
249.72,412.38,268.27,468.07,326.72,285.91,1062.91,2867.52,2348.67,604.82,341.75,1222.02,967.67,632.08,368.34,218.07,654.79,812.28,554.91,241.42,133.57,329.87,475.35,351.08,295.80,198.99,374.74,320.20,352.96,213.51,1091.15,1479.55,1219.60,996.46,180.69,368.80,528.74,606.38,413.55,243.99;
245.03,294.76,361.55,460.61,326.72,284.51,1051.24,2564.79,2348.67,610.27,427.98,1274.06,984.82,653.30,375.87,361.20,605.11,672.79,267.44,156.31,227.23,634.78,750.38,806.93,549.16,198.93,379.80,318.21,355.46,250.69,1045.98,1515.93,1154.83,814.63,215.18,363.65,536.37,768.35,350.67,255.05;
256.02,413.98,266.00,447.88,318.51,299.44,1034.64,3277.16,2894.78,635.56,361.77,1268.20,915.41,656.29,382.57,222.97,239.26,278.30,266.88,158.16,249.92,653.89,738.47,799.06,547.00,204.05,373.46,326.06,349.99,261.60,1122.31,1592.91,1163.11,884.67,243.70,370.74,555.17,760.54,356.08,266.80;
252.38,400.64,262.83,451.35,328.15,297.15,1064.97,2641.86,2456.62,665.28,364.08,1338.35,928.82,657.15,378.61,225.25,245.03,279.99,268.24,160.68,263.83,644.22,705.67,764.84,576.65,209.08,367.48,324.13,357.25,257.07,1066.58,1580.76,1147.01,852.92,238.84,371.62,576.65,774.63,353.69,268.38;
250.77,395.46,270.13,448.04,320.57,289.52,1001.38,2730.19,2211.52,628.56,364.89,1296.65,963.57,640.75,379.40,220.67,240.31,283.06,266.08,157.09,136.71,318.58,461.08,334.30,291.19,202.35,369.81,316.54,341.03,214.36,1108.59,1451.44,1246.67,1088.45,187.93,366.25,556.18,574.62,406.90,248.82;
248.51,294.63,374.10,446.25,318.45,288.59,1082.61,2794.26,2191.24,594.98,445.04,1265.89,945.87,664.16,373.91,365.94,687.31,870.29,568.24,250.79,136.32,330.17,471.42,332.41,289.48,200.60,367.48,320.50,352.96,218.08,1044.89,1409.20,1194.22,1095.12,197.89,363.22,539.75,566.47,413.46,256.36;
254.67,296.50,379.55,446.25,316.62,298.17,1034.64,2718.67,1975.84,606.13,462.05,1281.59,967.84,657.15,392.47,400.31,729.23,899.79,568.69,258.78,146.37,325.70,476.66,334.42,307.76,208.93,374.55,318.11,355.31,219.95,1191.64,1622.11,1170.35,1192.60,210.38,373.93,555.17,575.67,416.54,267.03;
254.59,294.78,378.61,454.87,314.60,304.89,1066.35,2867.52,1972.91,610.49,460.85,1328.89,942.04,691.61,388.31,388.33,720.76,826.06,586.48,258.78,145.22,325.70,454.37,338.50,299.81,209.78,382.28,324.01,353.26,220.90,1102.43,1465.59,1300.40,1066.35,207.29,366.36,544.53,565.74,423.87,264.28;
249.93,291.38,380.51,453.36,318.55,294.35,1051.24,2666.74,2348.67,594.98,452.19,1188.11,882.31,640.75,380.51,365.64,723.70,927.30,581.07,245.12,134.87,325.70,476.52,338.50,293.58,198.28,368.72,324.55,343.22,214.09,1085.27,1364.61,1288.04,1081.41,186.20,373.93,559.62,581.03,427.09,247.66;
248.72,294.80,384.22,462.44,324.66,292.42,1034.64,2228.14,2348.67,617.98,441.79,1338.35,912.37,648.48,382.84,374.26,708.29,903.83,596.10,252.76,138.93,327.68,458.69,338.43,291.98,205.47,368.72,314.32,343.22,218.08,1066.58,1359.33,1123.65,1039.73,202.48,366.31,565.74,594.30,420.10,256.16;
253.69,293.10,373.62,458.44,316.59,300.55,1051.24,2867.52,2348.67,604.36,462.05,1458.47,928.82,670.26,385.42,393.18,757.47,888.65,588.98,256.52,147.28,324.16,476.52,334.80,298.15,210.64,375.87,328.15,358.47,224.72,1129.91,1508.70,1340.18,1053.23,212.40,379.80,567.12,588.71,413.34,267.11;
251.21,294.78,376.64,464.07,316.54,300.75,1066.35,2564.79,2045.29,599.22,478.50,1318.75,998.91,648.02,396.40,397.34,702.15,884.80,587.13,250.00,147.25,319.89,454.35,339.70,297.02,206.29,375.87,328.15,349.99,219.95,1126.36,1415.63,1282.39,1210.40,210.42,371.67,540.55,573.43,406.99,256.32;
250.68,288.11,373.62,444.46,322.61,276.63,1082.61,2228.14,2073.51,646.01,438.55,1199.76,932.50,647.45,375.45,378.48,687.31,856.24,563.69,235.65,138.52,330.97,455.37,337.64,287.25,199.64,371.08,324.01,342.60,218.70,1164.61,1490.75,1347.09,1141.88,204.40,374.38,532.46,594.30,403.79,253.83;
252.32,296.46,370.96,442.65,322.61,287.32,980.31,2730.19,2420.79,622.37,482.25,1265.89,927.15,662.61,375.45,382.42,719.34,819.60,556.38,249.87,145.58,324.16,467.93,338.82,300.86,204.86,366.39,324.49,351.89,219.81,1241.91,1571.10,1317.01,1155.71,204.75,371.67,544.53,576.65,407.10,251.21;
249.80,288.18,376.31,453.24,322.46,278.84,979.95,2600.80,1905.07,619.51,419.32,1155.12,948.46,605.49,369.69,345.95,671.41,876.11,582.87,225.25,127.87,311.89,448.86,343.15,276.19,191.93,365.27,318.39,349.57,206.41,1046.63,1398.69,1230.78,948.46,172.17,360.67,500.00,598.49,403.90,225.41;
230.39,293.11,366.21,442.85,310.88,228.49,989.20,2389.08,1761.50,546.78,377.29,1187.80,948.46,536.99,307.67,331.72,704.27,843.30,563.66,188.41,112.72,314.96,445.63,322.26,256.29,177.34,366.09,318.45,327.73,204.39,957.00,1525.96,1155.71,867.43,151.36,332.08,452.81,561.52,407.11,213.64;
220.77,284.76,366.65,422.76,308.74,215.44,967.16,2371.14,1864.37,500.86,388.03,1114.86,882.31,503.72,305.54,336.24,697.47,866.31,556.74,184.86,113.21,317.41,447.52,326.30,263.91,181.53,359.48,308.92,329.95,204.46,1016.80,1450.86,1180.23,910.78,153.38,332.08,469.01,550.01,407.10,214.35;
233.05,288.06,379.01,448.02,306.81,241.98,1019.21,2294.01,1868.08,547.19,405.21,1108.59,899.79,564.95,344.61,357.65,690.10,893.21,576.32,214.94,127.27,329.69,475.41,328.46,290.58,196.52,365.20,320.54,338.26,215.25,1122.31,1456.11,1245.57,1030.67,188.63,345.80,504.89,589.76,420.10,251.21;
252.38,296.50,371.44,466.07,320.50,286.19,966.47,2420.79,2317.30,588.25,471.02,1468.59,944.11,653.30,376.81,406.29,720.76,839.11,594.50,247.72,150.68,334.30,451.07,340.88,300.94,211.82,369.81,321.70,346.07,225.83,1102.43,1456.11,1185.57,1155.71,229.36,365.94,559.62,553.62,427.09,271.35;
246.66,301.72,370.87,460.41,320.37,297.70,1035.91,2488.21,2348.67,581.37,508.85,1460.83,947.33,708.08,365.28,422.76,750.46,822.55,588.63,250.25,155.18,327.55,451.07,342.30,311.94,218.92,387.39,324.01,352.55,229.91,1199.76,1728.20,1356.95,1181.48,229.40,382.76,573.50,573.43,420.10,286.55;
255.94,296.38,368.34,473.18,316.54,294.96,1005.99,2894.78,2399.51,633.09,507.28,1485.12,985.73,751.43,390.85,444.69,726.81,822.55,561.52,250.94,154.81,331.60,468.01,343.89,321.85,216.28,369.81,320.09,353.26,234.95,1151.33,1390.44,1263.20,1247.78,232.12,388.59,588.94,569.36,413.02,293.00;
256.22,293.08,359.45,475.92,318.21,298.17,1050.36,2548.90,2310.24,660.85,498.20,1543.12,996.46,765.27,388.31,445.63,743.81,840.91,555.47,255.43,155.68,325.07,466.92,338.50,326.94,216.25,378.02,328.58,365.04,235.14,1163.11,1680.25,1272.49,1247.78,231.67,388.50,590.39,556.18,406.48,288.14;
257.30,293.04,361.55,469.42,322.21,292.06,1115.92,2491.14,1802.35,616.28,508.68,1689.33,1016.01,732.72,402.08,434.15,765.01,780.35,579.88,249.58,155.65,324.42,451.07,340.88,316.20,220.97,385.77,318.11,355.60,233.04,1177.42,1571.10,1328.89,1247.78,228.43,374.38,611.66,550.30,406.65,287.89;
255.00,296.49,374.10,475.35,316.49,290.39,1020.82,2491.14,2703.52,616.23,517.40,1386.37,1016.01,722.40,388.31,440.23,761.55,777.56,566.47,253.25,153.84,320.57,454.37,341.78,327.68,220.81,379.77,330.69,349.33,233.04,1066.58,1602.21,1320.93,1131.00,231.71,374.38,591.76,545.42,416.54,286.21;
253.15,293.11,359.45,456.45,324.60,296.43,1098.63,2191.24,1777.29,637.77,505.70,1543.12,1036.33,754.02,391.63,445.44,723.12,826.06,560.95,253.25,153.84,333.67,470.60,342.97,319.30,217.16,391.19,326.06,365.75,231.96,1191.64,1665.13,1335.17,1188.11,232.62,379.46,621.28,562.20,413.02,281.83]';
%%
k=1;
i=1;
maxima_tot=[];
while i<82
    img=inv_solve(inv_model, baseline, full_data(:,k));
    %subplot(3,5,i)
    %frame=i;
    %title(['Frame ',num2str(frame)])
    img.calc_colours.ref_level= X;
    img.calc_colours.clim= Y;
    cb = colorbar; 
    t_l=linspace(1,255,10);
    set(cb,'YTick', t_l'); set(cb,'YTickLabel', t_v');
    maxima_tot=[maxima_tot, max(img.elem_data)];
    %show_fem(img,[1,1]) 
    k=k+1;
    i=i+1;
end
plot(maxima_tot)
%%
plot(maxima_tot(30:70),'b--')
hold on
plot(envMean(30:70),'r','LineWidth',1.5)
legend('\fontsize{17}Max. Rel. Impedance variation over time','\fontsize{17}Envelope')
xlabel('\fontsize{17}Time [s]')
ylabel('\fontsize{17}Maximum Relative Impedance Variation |Z| [Ohm]')
title('\fontsize{17}40s normal breathing')
grid on

%%

%% respiri forzati
respiro_forzato=[443.73,786.71,522.21,914.58,592.77,553.27,1096.55,3310.32,2144.59,885.44,948.12,4908.87,3458.05,1662.79,725.08,438.43,453.51,545.34,517.32,318.03,487.70,1226.25,1327.45,715.53,576.56,432.51,707.75,663.95,645.94,428.78,2016.35,2842.50,2217.77,2239.17,402.38,678.42,959.64,1086.90,799.54,545.73;
448.43,578.50,735.38,902.24,592.74,513.39,1507.42,3358.76,2127.78,874.83,1104.63,4427.58,3253.06,1806.94,725.76,776.16,1356.36,1632.64,1099.53,483.45,281.83,656.26,935.42,708.74,582.65,425.15,709.95,667.58,646.83,423.16,2187.06,2601.99,2455.98,2057.42,392.22,678.18,988.42,1058.02,784.48,539.38;
437.02,571.97,730.14,903.74,603.71,487.02,1492.95,3122.78,1893.22,871.00,995.66,3866.22,3323.67,1562.79,704.24,708.29,1217.10,1599.98,1069.60,443.26,246.96,636.88,908.13,703.22,535.46,398.66,700.98,658.04,636.88,409.92,2139.97,2555.39,2277.08,1806.94,321.75,635.07,879.59,1032.54,765.51,472.48;
389.60,575.33,730.89,844.12,596.22,391.72,1340.85,2836.52,1920.40,759.23,861.52,2985.91,3153.47,1280.21,571.89,659.36,1210.37,1629.69,1123.94,349.99,211.70,618.48,911.24,666.37,476.60,367.32,685.44,642.13,619.08,391.89,1897.50,2568.58,2208.70,1748.25,276.99,596.38,801.36,1065.66,790.09,442.46;
372.63,571.97,731.26,837.90,575.25,365.55,1364.25,2555.39,1796.24,743.62,819.38,2890.51,2811.80,1241.67,546.05,663.83,1243.67,1529.38,1062.13,346.29,214.95,624.05,894.96,666.37,491.13,367.32,703.20,657.04,628.15,398.26,1744.08,2767.55,2187.06,1708.59,292.40,603.19,798.55,1019.89,791.43,444.51;
378.34,575.33,721.74,841.18,565.13,385.00,1397.83,2733.83,1863.10,732.86,870.48,2759.83,2698.23,1282.85,575.14,695.16,1271.85,1483.65,1110.81,355.57,220.28,646.27,911.24,690.33,491.68,370.09,685.44,646.34,626.91,396.86,1807.24,2555.39,2131.82,1594.87,290.03,592.68,833.21,1028.20,797.86,440.29;
384.01,571.97,751.04,841.02,571.35,392.49,1338.71,2836.52,1972.81,748.14,882.27,3415.62,3055.02,1236.20,588.90,688.18,1207.14,1564.59,1074.56,371.37,230.60,654.42,946.75,727.89,536.92,387.35,698.69,644.52,645.91,413.82,1956.95,2660.04,2062.90,1834.70,309.44,607.46,879.59,1023.46,790.09,467.90;
401.10,585.42,735.38,864.21,589.04,410.78,1329.41,2965.26,2004.46,761.97,973.95,3863.20,3077.63,1455.78,643.12,639.05,1083.75,1355.06,1055.62,386.15,246.71,704.61,1060.88,766.07,575.84,408.64,709.63,669.22,637.71,421.57,1907.94,2265.45,2240.35,1735.55,334.70,635.12,899.94,1086.43,770.81,501.34;
430.16,585.17,710.76,874.13,582.18,472.28,1354.67,3077.63,1963.25,828.41,1044.07,4636.57,3140.44,1694.43,709.86,683.56,953.20,1203.76,993.20,431.11,285.99,669.86,979.56,748.73,587.83,442.57,712.09,655.95,658.75,428.49,2131.82,2890.51,2362.50,2254.59,415.55,664.98,953.15,1036.42,800.47,577.04;
436.08,575.30,745.41,921.21,575.30,489.26,1446.83,3027.10,2220.63,870.35,1144.76,4908.87,3140.44,1723.38,741.31,801.47,1189.61,1458.69,1075.60,468.24,301.86,680.74,937.70,738.73,601.82,452.77,721.80,668.42,663.95,442.50,1956.95,2629.11,2651.23,2298.99,433.00,682.62,1020.11,1033.46,827.28,591.22;
452.77,592.74,752.08,982.32,611.00,472.09,1307.72,2890.51,2220.63,877.14,1208.16,7022.24,3490.93,1955.78,750.93,857.97,1281.53,1452.09,1156.22,471.06,301.86,664.20,921.21,725.40,620.42,461.34,723.42,678.36,673.92,448.62,2131.82,2962.53,2304.73,2104.02,429.44,712.72,990.34,988.42,797.51,609.30;
442.94,578.38,718.52,900.97,575.30,495.75,1387.53,3645.11,2072.14,906.37,1180.22,6916.10,3484.28,1866.83,780.70,889.17,1242.07,1390.47,1132.42,466.32,300.93,659.87,922.72,750.16,612.74,467.96,716.97,676.02,652.78,457.00,2156.55,2568.58,2417.42,2257.59,425.50,706.90,1010.00,1038.87,784.88,598.69;
449.35,588.82,714.48,919.86,588.94,480.41,1375.27,3581.02,1946.46,906.37,1194.12,7501.57,3750.78,1832.76,763.76,904.67,1227.22,1404.59,1055.62,463.84,303.75,651.39,961.64,718.52,625.22,459.15,718.77,672.12,670.91,452.80,2144.59,2985.91,2500.52,2140.48,428.82,701.84,1037.70,995.66,791.15,602.61;
453.51,571.63,709.41,903.12,592.51,489.18,1450.81,3358.76,2144.59,907.46,1225.48,5714.03,3909.21,1807.24,775.48,835.48,1252.21,1486.39,1054.21,470.77,301.87,637.08,910.88,729.49,599.96,442.57,716.97,651.64,670.33,444.54,2312.44,2663.98,2573.02,2415.21,418.46,722.53,969.40,1012.87,754.38,552.03;
433.47,561.89,730.89,884.03,607.49,480.67,1418.26,3055.02,2300.26,914.58,1015.65,4636.57,3122.78,1612.98,687.01,752.37,1247.01,1455.78,1017.46,439.67,274.74,645.24,966.37,717.61,548.67,419.39,714.69,650.01,644.34,424.93,2195.31,2776.45,2534.72,2184.34,360.00,708.46,908.09,1061.07,764.83,501.48;
403.32,552.59,719.63,860.62,607.40,419.65,1316.34,3150.20,2107.92,837.93,886.21,3554.91,3004.16,1390.47,632.91,693.05,1210.84,1515.55,1007.85,372.63,236.25,645.03,906.37,702.77,505.18,385.62,719.24,665.93,618.45,410.44,1938.80,2699.26,2302.17,1803.55,306.55,651.93,855.44,1069.60,760.79,463.54;
398.24,549.48,739.87,871.00,592.77,403.34,1305.04,2880.46,1976.03,801.12,904.20,3302.76,2880.46,1371.61,617.48,701.47,1175.60,1543.98,1073.20,379.15,233.43,630.08,922.72,706.13,506.29,382.50,696.34,658.68,641.56,404.84,1918.18,2690.05,2062.90,1837.61,314.62,660.81,877.99,1025.88,765.51,477.09;
403.32,558.82,725.54,881.87,603.74,421.36,1323.07,3325.59,2053.33,815.38,908.13,3341.07,3325.59,1368.52,628.63,707.57,1216.35,1428.97,1074.23,385.94,241.49,628.83,924.33,696.50,511.47,386.52,703.20,642.67,634.95,405.16,2067.97,2602.91,2326.14,1803.55,323.73,631.01,894.62,1015.48,760.22,465.75;
401.30,568.57,734.41,874.65,596.38,427.06,1350.91,2942.36,2127.78,783.04,897.89,3554.91,3251.26,1435.10,625.69,698.19,1228.38,1416.47,1036.77,397.92,242.09,626.54,937.61,712.55,524.18,383.76,694.22,661.46,630.24,408.81,1874.70,2795.67,2102.56,1880.93,333.55,626.98,862.83,1005.29,743.52,472.31;
403.74,562.11,727.00,864.21,589.11,409.46,1340.85,2942.36,2026.28,774.60,905.91,3583.43,2942.36,1390.47,620.23,683.37,1161.59,1389.21,1050.19,377.10,241.40,654.31,959.23,744.81,538.21,386.79,694.22,653.69,640.97,410.60,1963.25,2479.54,2102.56,2006.14,322.74,634.46,849.61,1025.88,766.14,463.21;
394.67,571.97,712.39,889.02,603.76,396.88,1331.99,3251.26,2087.18,798.15,878.63,3092.98,2965.26,1438.20,602.78,423.32,455.44,532.69,512.88,382.08,239.13,621.36,939.55,686.65,521.70,393.57,724.19,653.69,632.83,408.73,2111.36,2840.10,2184.34,1914.87,329.58,643.46,891.94,1067.88,771.51,484.19;
416.99,562.08,724.65,871.28,592.74,427.06,1392.58,2916.09,2058.78,808.78,946.61,3863.20,3397.03,1424.11,646.70,729.41,1244.58,1458.04,1093.40,411.35,256.04,635.92,976.28,785.39,573.12,410.03,700.98,649.39,632.83,428.78,2167.64,2865.59,2245.06,2160.23,358.77,656.06,922.80,1050.07,753.78,517.44;
419.35,592.39,704.90,903.12,611.26,439.95,1427.75,2890.51,2144.59,828.41,966.08,4043.88,3002.75,1508.32,685.81,428.68,455.78,537.73,1062.57,435.79,267.71,637.42,870.07,693.52,542.54,428.72,723.87,668.21,647.70,430.46,2177.29,2876.72,2663.98,2240.35,398.05,693.52,937.83,1054.88,788.55,578.10;
440.77,582.10,735.38,909.50,607.49,486.71,1397.83,3122.78,2144.59,896.27,1140.94,5834.77,3244.10,1707.55,739.40,832.93,1374.32,1598.49,1144.29,474.01,295.15,636.41,884.32,698.45,577.90,446.60,738.86,668.21,663.05,434.28,2156.55,2687.01,2591.92,2325.48,423.72,702.19,980.79,1008.17,794.04,603.19;
452.56,571.74,740.95,912.51,600.01,487.02,1432.79,3358.76,2188.71,881.01,1198.50,5084.82,3364.71,1966.82,735.59,872.42,1367.72,1573.26,1141.17,479.61,299.57,655.24,905.60,691.89,591.39,459.11,721.33,655.95,671.94,446.50,2177.29,3092.98,2629.11,2100.13,434.64,724.19,1013.95,1025.93,792.16,613.68;
452.34,574.99,728.98,907.11,582.18,485.98,1465.72,3061.00,2080.56,892.68,1212.70,5723.81,3354.80,1824.77,750.93,905.01,1465.06,1599.98,1149.42,480.92,301.41,633.79,896.99,686.53,589.11,452.82,718.77,668.42,654.39,448.59,2061.98,2953.07,2304.73,2240.35,436.53,698.35,1034.39,1000.65,798.55,621.17;
447.14,565.28,719.63,891.01,582.19,487.87,1387.53,3221.15,2160.23,917.95,1221.75,5400.57,3612.64,1873.67,753.49,938.34,1374.32,1544.56,1096.48,462.59,300.59,655.27,875.07,680.77,588.90,463.50,726.58,659.54,655.31,459.01,2118.28,3148.57,2285.15,2289.52,429.64,702.50,1034.39,998.20,774.48,595.29;
443.26,565.22,728.98,908.13,607.46,475.20,1429.42,3388.86,2220.63,900.02,1157.76,5400.57,3244.10,1829.88,763.76,842.39,1356.36,1666.41,1059.14,465.10,289.82,631.22,911.24,690.28,540.57,440.56,712.34,672.77,655.19,430.67,2021.94,2766.44,2362.50,2222.35,402.20,718.48,959.64,1005.29,787.70,548.78;
430.56,562.11,715.53,889.02,611.20,461.40,1419.90,2861.90,2053.33,860.99,1007.05,3737.07,3092.98,1687.11,679.98,745.57,1374.32,1598.49,1049.52,424.82,259.86,612.20,870.73,668.03,515.21,403.67,716.97,653.69,650.14,415.83,1925.23,2836.52,2260.60,1965.23,354.93,660.73,928.65,1015.48,770.07,501.58;
410.59,555.59,715.53,884.86,607.32,417.34,1358.32,3325.59,2091.95,789.47,887.85,3863.20,3153.47,1450.17,632.91,722.11,1317.89,1603.42,1039.99,385.51,238.44,609.96,896.99,652.68,490.39,392.00,719.24,653.69,641.74,406.94,1938.80,2396.29,2325.48,1828.60,324.12,639.22,850.99,1015.48,765.51,470.23;
398.05,552.56,730.89,854.00,592.74,389.14,1309.24,3221.15,1938.80,803.98,857.84,3077.63,3150.20,1315.86,597.85,690.28,1308.77,1682.36,1074.56,375.83,230.05,603.87,859.39,645.44,488.69,382.39,716.97,650.01,636.23,401.40,1908.66,2628.16,2115.30,1727.68,314.46,619.03,858.33,1038.87,771.51,461.31;
399.67,558.90,720.70,877.99,582.19,404.22,1419.90,2942.36,1968.81,778.29,867.16,3175.00,3150.20,1385.30,615.43,696.49,1298.70,1513.37,1111.17,376.27,231.68,612.74,870.07,659.77,497.83,382.14,710.08,643.18,639.71,408.33,1955.78,2375.00,2245.06,1933.11,313.10,622.97,848.59,997.42,771.51,463.29;
394.07,552.56,742.12,837.93,592.77,396.88,1307.72,2728.51,2030.64,789.47,892.12,3726.21,2737.04,1404.45,624.56,696.49,1357.80,1561.19,1051.64,384.82,232.78,601.38,859.39,657.44,487.60,379.43,687.70,642.67,620.97,405.26,1816.26,2541.55,2102.56,1920.77,318.06,630.97,871.90,1007.48,759.60,474.71;
400.89,561.97,730.14,847.69,596.35,396.92,1349.63,3153.47,1999.43,767.27,893.39,3536.27,3055.02,1315.86,624.56,725.96,1416.47,1582.30,1039.99,385.94,233.86,615.43,897.33,654.30,486.34,380.53,689.51,654.31,634.26,403.59,1840.21,2663.98,2325.48,1861.08,318.82,635.07,855.44,1051.04,772.16,461.18;
396.79,552.58,724.85,844.12,588.82,403.43,1320.05,2942.36,2064.28,751.35,892.12,3583.43,2942.36,1431.87,620.76,701.84,1414.99,1666.41,1098.35,384.44,235.00,617.30,865.53,660.02,492.77,385.39,694.31,659.29,632.83,401.84,2026.28,2733.83,2402.06,1956.95,330.85,630.97,885.77,1058.58,761.32,484.18;
410.59,568.64,721.74,867.77,589.21,428.82,1404.45,3122.78,1968.81,798.15,973.95,3863.20,3554.91,1575.10,675.44,734.08,1429.73,1651.38,1071.65,423.25,259.26,622.33,865.53,693.52,536.86,415.57,712.34,661.05,651.64,419.47,2057.42,2766.44,2382.74,2073.54,369.09,674.28,953.15,1031.39,775.33,525.37;
437.18,575.10,735.51,891.94,596.38,466.15,1393.01,2890.51,1976.03,849.74,1072.30,5235.57,3140.44,1766.69,749.45,814.05,1344.77,1679.38,1144.29,474.35,293.38,645.65,884.32,685.12,570.64,442.55,724.19,665.49,647.70,432.51,2177.29,2876.72,2573.02,2184.34,425.27,692.56,978.82,1025.93,812.68,584.41;
446.19,575.10,715.53,891.01,575.25,481.53,1415.14,3150.20,2188.71,885.44,1136.85,5037.39,3364.71,1947.62,778.52,895.48,1385.86,1687.11,1106.90,471.75,298.66,657.93,872.73,678.82,582.47,456.97,719.18,658.68,667.47,442.28,2162.87,2859.46,2426.33,2252.79,426.95,702.50,1018.34,1047.11,790.09,603.47;
454.65,575.10,744.36,918.64,585.67,490.20,1383.22,3471.09,2188.71,911.08,1180.39,7331.06,3622.54,1947.62,756.55,918.64,1465.72,1544.56,1116.88,477.87,297.89,655.27,882.74,686.53,600.55,461.28,721.80,660.31,683.12,454.33,2043.90,2962.53,2555.39,2203.65,433.69,712.72,1010.75,1058.33,780.60,603.34;
447.30,568.50,734.41,934.10,600.05,480.56,1448.26,3815.87,1943.39,914.58,1202.76,5359.87,3909.21,2034.15,763.76,896.72,1418.56,1603.42,1142.81,476.64,297.75,636.33,881.01,702.62,579.14,450.73,735.57,654.31,671.94,448.54,2057.42,2634.83,2533.86,2222.35,423.72,722.90,1018.34,993.09,815.47,592.08;
453.16,561.89,736.65,893.91,607.40,490.31,1457.23,3358.76,2004.46,885.34,1123.05,6300.40,3612.64,1976.84,730.30,821.20,1392.72,1659.44,1109.67,466.96,294.30,622.23,855.83,698.04,550.34,440.42,738.86,672.77,661.44,434.43,2187.06,2601.99,2317.63,2046.13,405.93,697.19,980.79,1015.65,775.33,534.40;
427.34,549.45,744.36,863.64,611.11,459.42,1436.34,3124.38,2034.15,864.21,964.67,3767.44,3325.59,1606.66,680.74,739.62,1398.83,1564.59,1098.35,415.63,252.52,602.41,871.73,662.53,513.38,396.95,707.75,642.13,627.54,410.44,2002.78,2836.52,2164.46,1787.82,334.80,674.53,914.42,1013.14,754.38,488.99;
398.42,558.90,719.63,847.69,600.01,399.10,1373.77,2942.36,1893.22,789.14,892.12,3221.15,3278.55,1404.45,624.05,704.61,1308.77,1582.30,1098.90,364.32,225.32,603.87,851.57,656.74,489.72,379.31,712.39,638.51,622.33,406.74,1824.77,2402.06,2349.51,1708.59,299.52,626.98,852.32,1013.46,791.43,457.00;
387.46,568.57,719.63,847.60,582.10,380.23,1324.89,3153.47,2002.78,754.05,900.06,3122.78,3221.15,1371.61,610.68,691.18,1308.77,1670.54,1074.23,369.25,224.26,606.00,871.73,643.81,498.28,379.19,717.07,638.51,634.95,403.29,2005.72,2534.72,2302.17,1866.83,306.05,622.93,877.99,1072.23,771.51,454.75;
404.59,549.45,743.26,867.77,582.10,400.45,1390.75,3153.47,2062.44,788.55,910.29,3583.43,2780.94,1356.10,638.60,706.90,1335.34,1607.96,1040.52,384.23,232.20,616.11,859.39,670.09,493.44,388.56,703.22,653.69,636.88,410.35,2067.97,2455.98,2375.00,1861.08,321.53,639.26,864.34,1017.73,755.46,470.23;
400.89,552.58,744.36,892.49,600.05,408.73,1349.63,2836.52,2087.18,798.15,940.08,3561.97,3055.02,1390.47,636.88,706.52,1376.36,1629.69,1074.56,387.46,239.62,617.30,847.31,681.38,497.59,389.73,702.62,659.29,633.33,413.72,1919.29,2698.23,2351.55,1970.01,319.79,634.91,863.40,1049.28,793.51,477.02;
397.45,555.73,737.76,878.28,578.66,405.01,1410.28,3122.78,2115.80,754.05,920.72,3458.05,2859.46,1361.47,635.76,711.64,1322.10,1607.96,1124.24,390.73,239.04,617.30,877.99,661.53,503.22,400.10,698.74,663.10,636.11,410.25,2057.42,2660.04,2365.95,1907.94,347.67,643.42,906.18,1017.73,802.98,499.02;
419.53,571.94,730.14,911.08,588.94,439.16,1375.40,3175.00,2080.56,840.56,1004.02,4610.74,3561.97,1568.40,717.55,775.38,1386.97,1699.28,1136.08,443.30,272.18,644.37,871.73,676.85,538.21,432.63,709.95,646.34,662.31,430.27,2075.40,2909.63,2382.74,2176.21,402.20,683.37,940.03,1050.07,811.03,561.52;
440.77,575.10,769.55,902.24,585.67,478.48,1477.71,3278.55,2080.56,881.62,1153.97,4884.32,3358.76,1832.76,741.31,834.87,1321.74,1618.27,1142.81,480.56,303.38,656.43,892.79,707.25,590.19,452.77,743.86,649.39,647.70,448.09,1938.80,2910.92,2629.11,2320.24,436.39,692.56,995.66,1036.42,817.23,618.04;
456.76,585.59,731.26,903.12,599.87,489.18,1384.19,3150.20,2115.80,870.35,1217.10,6506.12,4019.90,1910.48,744.81,896.38,1404.45,1666.41,1129.70,472.55,305.27,653.79,908.60,681.12,593.65,454.88,735.57,656.67,676.47,448.28,1986.19,3037.30,2642.51,2340.75,432.89,708.59,1037.70,993.09,793.12,622.37;
447.14,575.30,724.85,919.86,595.99,484.77,1358.32,3150.20,1932.73,911.08,1197.07,6520.57,4043.88,2026.28,750.93,886.21,1374.32,1544.56,1097.24,465.73,305.32,627.38,890.49,682.13,599.25,459.15,709.95,652.35,663.05,450.34,2077.74,2909.63,2336.07,2203.65,437.06,702.50,1055.62,1042.05,774.48,605.83;
449.81,578.59,736.32,887.99,599.87,475.42,1477.71,3632.52,1975.22,903.12,1266.08,6421.44,3388.86,1970.01,763.76,930.46,1398.83,1527.51,1104.35,460.76,302.34,639.04,874.62,706.72,597.08,463.54,745.91,668.42,658.69,457.00,2075.40,2601.99,2423.35,2203.65,438.25,702.77,1059.14,985.50,793.12,602.11;
453.34,578.66,729.98,926.31,596.39,478.55,1429.42,3767.44,2125.77,903.62,1217.10,5743.51,3620.05,1994.85,773.90,921.70,1444.31,1527.51,1133.56,468.24,300.49,640.37,855.83,678.82,592.48,452.81,738.86,659.29,672.94,450.65,2252.79,2612.18,2285.15,2270.32,433.53,708.46,1062.57,1055.68,773.58,587.92;
446.60,568.62,737.76,886.94,607.40,477.48,1477.71,3388.86,2212.66,911.28,1080.51,4636.57,3278.55,1723.38,727.89,834.02,1409.84,1515.55,1059.14,464.77,287.22,612.44,860.09,693.96,549.27,423.31,726.02,653.69,662.31,432.51,2164.99,2533.86,2375.00,2193.10,403.05,703.20,973.81,1023.91,753.13,534.34;
416.99,549.48,715.53,874.13,619.03,440.81,1411.01,3175.00,2151.85,831.58,955.56,4575.29,3196.97,1568.40,663.51,734.39,1455.78,1525.10,1017.96,401.86,250.61,622.97,863.84,661.53,509.17,393.57,726.58,657.37,625.58,410.44,2164.99,2840.10,2254.59,1775.70,331.46,656.30,873.39,1063.32,754.38,477.11;
390.17,549.49,730.89,844.37,592.68,381.57,1301.80,2917.38,2053.33,767.27,876.65,3665.53,3122.78,1398.83,583.17,685.47,1370.13,1589.80,1051.16,351.07,227.42,621.87,887.48,660.85,485.70,379.19,692.08,655.49,636.84,408.44,2100.13,2601.99,2402.06,1757.26,305.31,619.03,864.34,1052.13,762.25,463.29;
385.51,552.59,725.94,844.37,592.60,373.04,1324.89,2619.66,1869.22,778.07,880.16,3302.76,2759.83,1348.47,587.50,701.47,1322.10,1653.97,1051.46,354.85,225.34,626.81,870.07,655.08,487.04,378.93,689.51,645.76,636.23,405.16,2067.97,2634.83,2119.77,1773.36,308.14,630.69,839.13,1081.63,772.16,465.71;
390.30,555.73,730.89,863.91,575.30,380.23,1373.77,2687.01,1938.80,779.98,895.67,3175.00,2836.52,1418.26,589.91,716.40,1304.69,1586.25,1074.23,366.90,228.95,608.81,845.54,647.06,493.44,387.03,716.69,641.56,625.58,413.49,2005.72,2660.04,2272.16,1785.43,315.71,611.00,846.30,1069.98,772.76,470.21;
397.24,558.91,737.22,837.93,589.21,381.57,1269.81,2687.01,2058.78,748.64,858.83,3153.47,3030.00,1277.91,598.16,694.66,1343.88,1670.54,1074.23,357.42,227.92,606.35,870.07,635.36,481.72,379.31,703.20,660.96,615.23,401.52,1982.51,2687.01,2062.90,1807.24,309.05,618.73,874.83,1058.58,767.77,465.50;
384.84,558.91,724.85,860.99,578.74,374.42,1357.14,3116.44,2091.95,761.97,895.67,3196.97,3122.78,1404.45,606.00,731.91,1342.87,1582.30,1073.78,371.23,234.46,612.20,860.09,648.66,503.22,391.89,698.74,659.29,632.08,413.91,2021.51,2767.55,2365.95,1839.88,330.85,622.87,870.35,1025.88,771.51,496.43;
422.56,555.72,747.68,857.67,585.51,431.37,1401.85,3030.00,2094.83,822.18,993.04,4189.66,3458.05,1550.95,700.83,749.69,1343.50,1719.38,1098.69,429.26,263.47,632.50,881.01,686.53,528.54,419.68,723.87,648.08,634.26,419.47,2156.55,2821.14,2591.92,1907.94,384.36,656.06,931.34,1074.75,783.07,542.97;
434.16,582.15,738.50,918.64,589.11,474.10,1387.53,3263.91,2095.79,846.93,1096.55,5519.65,3244.10,1799.89,724.01,800.39,1310.54,1760.96,1126.40,463.84,293.42,652.52,874.62,678.38,562.27,444.57,733.91,655.95,660.55,436.43,2026.28,2731.70,2670.93,2270.32,428.75,688.78,1028.71,1028.71,811.64,595.99;
441.27,581.94,744.36,886.94,600.01,490.31,1415.14,3002.75,2160.23,853.38,1198.50,6831.24,3750.78,1866.83,755.85,894.92,1379.91,1679.38,1102.88,471.05,299.62,659.47,903.74,683.12,580.29,450.73,741.27,647.38,666.46,446.50,2088.13,2910.92,2591.92,2289.52,439.00,693.05,1007.05,1081.10,785.87,605.54;
440.95,582.10,714.48,895.86,596.38,483.18,1373.77,3221.15,2182.16,896.27,1277.70,6065.82,3484.28,1910.48,752.37,879.41,1338.84,1659.44,1113.69,474.35,303.38,636.41,918.32,689.51,592.51,456.97,746.28,671.43,663.14,456.97,2111.36,2573.02,2231.58,2360.43,419.37,683.16,1048.32,1015.65,792.16,629.14;
446.40,578.50,724.85,886.94,575.10,467.93,1415.14,3168.33,2135.37,870.35,1327.45,8122.55,4071.82,2121.76,787.55,947.41,1392.72,1575.10,1102.88,455.00,296.98,648.42,870.73,714.08,606.47,459.15,753.71,679.16,680.39,454.80,2121.76,2687.01,2466.11,2307.93,425.11,708.68,1030.42,1009.57,806.05,614.37;
452.34,562.03,716.55,900.97,592.78,479.56,1496.27,3415.62,1994.43,915.02,1297.33,5834.77,3761.86,2043.90,792.03,902.51,1305.04,1521.40,1080.11,461.38,297.02,632.50,894.96,698.45,602.92,463.50,748.14,663.10,659.63,463.42,2144.59,2629.11,2382.74,2360.43,427.56,719.01,1037.70,1005.56,792.16,625.13;
444.57,571.82,722.74,902.24,578.74,474.10,1397.83,3595.51,2144.59,903.12,1257.27,6008.33,4061.28,2121.76,773.90,913.10,1399.41,1527.51,1047.83,461.07,291.71,648.31,870.73,703.00,613.68,457.00,721.33,673.76,656.21,463.36,2043.90,2926.51,2382.74,2360.43,423.43,697.99,1020.11,1007.48,779.68,629.71;
454.20,571.94,727.00,956.89,611.26,465.10,1357.14,3364.71,1987.83,892.68,1236.20,6520.57,3622.54,2086.71,763.76,913.10,1393.01,1529.38,1061.57,461.67,302.64,636.88,870.73,687.09,604.94,457.00,709.95,655.95,672.10,450.61,2226.37,2871.76,2285.15,2100.13,438.04,702.50,1047.11,1023.07,792.16,595.06;
437.18,552.51,716.55,886.94,596.22,483.84,1457.23,3595.51,2260.00,867.77,1069.15,4866.15,3804.31,1806.94,722.69,787.86,1308.89,1599.98,1035.78,453.19,290.84,627.22,872.73,702.06,561.99,432.74,738.67,664.73,640.98,426.32,2160.23,2842.50,2217.77,2158.65,402.38,713.00,940.03,1020.95,782.29,545.87;
419.87,546.34,715.53,874.13,611.26,439.16,1333.35,3150.20,2080.56,885.34,968.78,3718.12,3278.55,1557.03,674.24,755.46,1353.24,1618.94,1029.56,407.75,255.27,623.40,885.66,665.84,521.03,402.09,716.97,640.97,630.90,411.87,2069.35,2430.07,2135.88,1785.43,343.13,669.67,891.94,1023.46,783.07,504.14;
403.32,555.73,742.74,881.77,603.57,393.32,1305.04,2942.36,1994.43,792.39,897.89,3583.43,2859.46,1429.73,599.25,714.25,1278.79,1629.69,1039.99,365.16,231.69,614.37,901.74,656.74,494.75,393.24,698.69,642.13,634.26,411.98,1910.48,2699.26,2245.06,1933.11,313.32,611.29,872.14,1052.13,784.48,465.75;
390.94,555.73,737.76,881.30,588.68,395.48,1392.58,2859.46,2087.18,748.14,924.70,3561.97,2909.63,1366.65,607.04,712.04,1335.34,1509.94,1062.88,388.07,238.46,615.89,874.62,683.16,511.53,386.52,698.69,654.31,629.54,416.89,1929.35,2767.55,2351.55,1894.65,329.20,603.02,858.33,1009.57,761.32,470.21;
401.10,558.90,721.11,860.99,568.57,429.67,1432.79,3325.59,2033.27,724.13,954.60,3836.36,2875.48,1412.19,642.63,715.92,1371.61,1612.11,1050.73,405.39,247.52,628.40,899.60,669.86,513.38,393.24,685.44,653.69,624.76,417.44,2021.51,2396.29,2231.58,2008.26,340.69,589.11,867.19,1058.58,772.76,472.15;
410.91,561.89,741.83,844.12,585.64,428.75,1331.99,3002.75,2064.28,748.99,971.41,3536.27,3077.63,1409.84,654.45,767.27,1357.80,1642.74,1098.90,421.68,262.01,610.68,915.98,678.38,544.79,408.73,700.98,663.72,653.03,430.17,1852.05,2466.11,2377.10,2239.17,384.95,639.26,903.47,1013.14,797.86,517.32;
432.82,565.22,749.96,903.12,575.33,481.66,1496.27,2942.36,2002.78,786.53,1107.39,5425.44,3473.28,1775.70,724.01,807.34,1404.45,1515.55,1069.60,466.61,294.22,641.67,876.37,690.28,568.25,442.57,729.02,660.31,651.04,434.43,2002.36,2642.51,2318.28,2289.52,425.27,660.49,1000.08,1069.60,800.47,584.63;
452.97,582.19,728.03,899.11,582.19,497.03,1512.64,3536.27,2072.14,841.18,1212.70,6916.10,3484.28,1966.82,775.48,880.59,1424.11,1629.69,1101.27,477.91,307.14,675.26,872.73,698.45,610.05,456.97,716.69,662.31,657.72,456.80,2046.13,3032.91,2629.11,2372.20,450.00,688.72,1007.05,1050.07,833.21,610.72;
446.19,575.30,737.76,912.51,600.04,473.30,1454.81,3077.63,2033.27,888.98,1257.27,6520.57,3750.78,2035.47,787.55,920.10,1378.82,1561.39,1095.59,464.42,309.33,655.24,906.49,687.09,608.83,463.53,738.67,671.43,681.30,450.61,2075.40,3032.91,2591.92,2075.40,443.55,697.76,1028.71,1018.34,818.34,625.94;
450.89,578.66,739.87,911.08,588.82,470.34,1497.85,3175.00,2046.13,828.38,1272.82,6101.13,3484.28,1966.82,793.72,922.07,1350.01,1482.63,1113.69,450.84,309.33,652.52,888.07,687.48,623.58,459.11,731.44,651.64,650.14,456.92,1966.82,2663.98,2285.15,2379.21,447.12,703.20,1051.64,1042.05,798.55,605.83;
450.89,581.82,737.76,877.89,585.67,492.57,1487.25,3168.33,2229.84,837.93,1189.61,6065.82,3612.64,1866.83,750.93,879.41,1361.47,1592.96,1078.73,474.35,303.33,635.76,915.98,709.35,577.04,430.72,736.32,655.95,661.05,434.49,2177.29,2836.52,2651.23,2104.02,421.29,647.51,955.56,1020.95,766.73,549.35;
429.37,552.45,725.94,874.65,592.78,467.32,1458.04,2942.36,2053.33,786.71,1044.07,4540.64,3215.92,1644.36,681.17,780.87,1356.10,1562.79,1083.49,434.69,264.10,633.47,875.07,672.69,532.95,408.54,721.74,669.98,636.88,417.34,2002.78,2402.79,2382.74,2061.98,353.97,619.03,920.10,1036.48,762.25,484.19;
404.92,562.11,720.70,877.99,585.42,403.43,1415.14,2836.52,1918.18,764.48,978.77,3912.34,2942.36,1371.61,615.43,732.90,1373.77,1670.54,1097.86,374.04,235.58,630.69,868.29,652.68,506.43,383.88,716.69,654.31,634.26,404.72,2005.72,2800.25,2349.51,1726.60,312.39,596.29,868.53,1054.39,791.43,461.31;
388.31,568.62,738.84,841.18,589.11,374.47,1301.80,2917.38,1810.03,714.54,903.62,3251.26,2660.04,1292.22,579.14,696.08,1275.41,1612.11,1086.16,355.95,229.53,630.69,877.07,647.06,510.38,385.39,703.20,656.03,622.33,410.44,1933.11,2426.33,2140.48,1885.82,308.70,589.16,846.30,1041.16,800.74,461.31;
396.56,558.90,736.32,867.88,588.68,401.94,1340.85,2859.46,2026.28,753.71,942.91,3960.15,3150.20,1332.73,643.81,733.72,1322.10,1646.22,1063.14,394.50,242.01,626.03,892.23,658.39,514.85,391.89,683.37,638.51,644.52,415.83,2026.28,2568.58,2365.95,1849.40,350.66,618.84,896.99,1051.04,778.27,496.43;
425.32,555.69,727.00,864.21,592.77,440.94,1392.58,3325.59,2121.76,788.55,1012.87,4114.83,3388.86,1625.63,690.49,787.52,1405.90,1638.81,1120.61,438.81,270.04,626.03,910.57,698.04,539.42,421.45,696.50,648.08,651.04,430.67,1893.22,2836.52,2184.34,2131.82,392.04,656.37,918.28,1005.29,779.46,549.06;
434.55,571.94,756.75,915.02,574.99,483.84,1411.01,3415.62,2020.22,854.00,1083.75,4236.56,3583.43,1653.97,731.75,812.26,1431.87,1666.41,1092.10,475.89,289.19,657.93,905.60,697.46,567.30,440.58,703.22,660.31,647.70,436.02,2131.82,2555.39,2612.18,2274.00,427.86,660.33,967.07,1010.70,794.04,558.17;
439.06,585.59,731.26,887.99,595.85,506.24,1497.85,3251.26,2127.78,850.89,1145.55,5154.96,3737.07,1747.42,757.50,807.65,1338.84,1592.96,1172.98,492.85,292.71,645.70,894.92,698.45,561.99,436.58,707.55,663.95,646.66,432.17,2144.59,2836.52,2274.00,2073.54,422.93,688.64,1005.29,1039.28,797.20,545.87;
445.97,578.50,730.14,892.68,607.40,514.46,1545.52,3263.91,2226.37,891.94,1070.18,4884.32,3258.47,1858.39,756.55,768.98,1332.98,1504.75,1116.88,496.18,289.16,641.67,881.62,712.26,578.41,432.68,714.69,667.58,642.67,434.28,2094.83,2712.72,2346.80,2158.65,414.20,697.76,1009.57,989.53,807.92,562.03;
435.87,589.11,736.65,895.07,589.21,520.58,1528.07,3251.26,2115.80,834.66,1158.41,5714.03,3759.09,1840.21,766.45,801.28,1367.72,1707.55,1185.67,490.96,290.91,645.70,877.18,687.48,564.17,425.19,689.92,641.74,651.64,430.27,1881.98,2445.21,2150.29,2177.29,420.51,677.90,976.43,1018.34,777.61,536.60;
433.00,575.30,726.40,881.01,600.04,507.43,1553.30,3002.75,2226.37,860.62,1080.51,4155.48,3114.86,1680.87,714.86,781.24,1409.84,1684.85,1135.39,472.73,280.76,645.70,885.66,685.12,551.53,423.02,703.22,655.19,639.39,421.20,2061.98,2821.14,2426.33,2176.21,406.11,652.04,918.28,1039.28,789.34,540.17;
418.97,578.75,746.43,871.00,571.89,460.41,1457.23,3397.03,2188.71,818.66,960.48,4610.74,3129.17,1581.47,674.24,775.06,1393.01,1581.47,1072.49,420.55,290.88,648.42,879.16,678.38,534.58,417.92,696.50,658.68,650.14,423.09,1883.72,2447.51,2500.52,1956.95,404.22,647.38,946.21,1064.02,788.55,522.85;
418.55,582.10,714.48,864.21,578.74,478.55,1421.70,2942.36,2094.83,800.93,1077.16,4636.57,3354.80,1639.27,719.94,728.92,1327.45,1603.42,1176.28,472.35,251.38,621.87,885.66,706.72,540.54,402.23,694.31,647.38,624.88,417.74,2026.28,2377.10,2350.19,2080.56,353.87,665.35,930.46,1020.95,825.31,511.83;
422.35,581.94,735.51,892.49,575.30,477.48,1496.27,3210.72,2121.76,825.31,1088.64,3899.88,3129.17,1644.36,697.97,781.84,1282.85,1592.96,1108.89,474.39,267.14,633.76,883.71,689.51,557.09,414.35,703.06,646.66,631.30,430.67,1883.72,2591.92,2431.57,2002.36,387.48,660.87,933.42,1101.83,792.03,536.89;
428.28,596.35,727.00,888.98,582.15,502.74,1410.57,2995.70,2127.78,800.47,1100.36,4908.87,3129.17,1723.38,705.69,769.55,1305.04,1644.36,1185.67,483.45,275.33,635.00,870.73,700.06,570.10,425.19,698.74,651.64,643.52,425.06,1816.26,2573.02,2298.99,2046.13,392.22,656.20,988.42,1086.43,788.55,517.15;
435.19,568.41,733.39,895.86,582.18,483.84,1393.71,3251.26,2188.71,828.41,1100.64,4441.25,3370.70,1581.47,708.50,799.99,1458.69,1550.95,1110.31,465.17,284.21,626.03,866.38,704.04,560.14,409.01,714.48,646.66,657.93,430.17,2061.98,2670.93,2431.57,2176.21,407.91,660.13,981.13,1063.32,783.07,537.28;
424.59,568.41,720.70,874.13,592.77,483.82,1476.53,3310.32,2107.92,864.45,1092.92,4216.82,3196.97,1612.98,712.55,775.38,1404.45,1656.82,1118.27,464.93,285.81,628.63,885.66,686.53,551.08,417.60,700.69,649.39,657.08,424.93,2100.13,2865.59,2591.92,2274.00,406.38,656.06,924.82,1018.34,808.78,530.93;
 435.08,578.66,709.41,860.62,582.18,489.27,1528.07,3055.02,2300.26,854.26,1085.09,4441.25,3620.05,1792.31,745.39,755.94,1338.84,1557.03,1081.37,469.10,284.09,632.50,879.16,684.63,557.09,415.75,694.22,659.54,636.11,419.47,2035.47,2466.11,2346.80,2289.52,407.80,673.76,951.08,1031.39,770.07,522.77;
435.08,578.50,719.63,888.69,596.22,489.27,1467.70,3554.91,2004.46,840.56,1077.69,5359.87,3114.86,1639.27,733.17,755.94,1315.86,1504.75,1123.05,466.32,283.24,627.22,862.02,706.72,573.31,410.83,712.39,646.66,657.08,424.58,2144.59,2481.94,2445.21,2240.35,411.01,664.61,983.41,1019.89,783.07,519.79;
433.00,568.50,720.70,892.68,585.68,480.67,1529.38,2800.25,2121.76,857.01,1108.24,4884.32,3750.78,1713.83,750.29,751.57,1338.84,1651.38,1110.31,471.34,281.67,638.60,898.88,691.89,554.07,417.68,717.07,639.04,646.83,426.53,2067.97,2426.33,2445.21,2088.13,410.92,660.49,948.88,1038.87,771.51,519.79;
434.91,565.22,740.87,877.89,575.30,479.61,1429.42,3473.28,2243.29,867.77,1107.39,4657.55,3148.57,1679.13,749.45,745.24,1294.03,1625.63,1131.13,470.77,284.15,635.00,885.66,693.96,563.78,414.38,714.69,650.90,642.48,428.49,1944.92,2485.14,2651.23,2140.48,403.90,660.63,940.03,1000.65,795.72,522.92;
432.25,558.87,713.40,860.62,582.18,489.26,1497.85,3150.20,2160.23,834.75,1086.90,4216.82,3215.92,1766.69,714.08,779.46,1332.73,1577.97,1132.42,469.10,285.89,624.81,860.09,698.45,559.20,419.68,714.71,655.95,651.93,428.72,1982.51,2842.50,2396.29,2240.35,409.92,660.81,981.13,1047.11,801.36,522.56;
434.55,575.30,719.63,860.62,585.68,484.93,1443.83,3358.76,2293.93,837.90,1069.15,5140.70,3129.17,1797.76,731.75,781.57,1392.72,1625.63,1146.81,461.95,282.51,642.96,896.68,698.45,573.67,421.34,717.07,647.38,639.39,426.78,2047.92,2821.14,2500.52,2098.20,393.81,687.96,969.40,1018.34,816.29,533.83;
430.74,571.82,709.41,864.21,574.99,491.48,1419.90,3511.12,2252.79,877.89,1065.91,4478.34,3884.47,1672.98,714.86,751.82,1330.76,1568.40,1145.63,467.62,277.70,647.02,872.84,707.25,563.23,417.92,717.07,661.05,653.61,428.57,1933.11,2821.14,2455.98,2209.27,400.87,669.53,955.56,1018.34,794.90,533.96;
429.73,578.50,707.33,867.33,592.78,495.93,1467.53,3388.86,2182.16,867.88,1112.47,4427.58,3612.64,1824.77,730.30,767.77,1350.01,1510.30,1081.37,466.60,282.48,641.67,883.71,696.34,559.20,419.64,714.48,655.49,651.64,432.27,1863.10,2447.51,2317.63,2250.40,403.90,679.21,953.20,1050.07,788.55,548.62]';
%%
k=10;
i=1;
maxima_forz=[];
while i<11
    img=inv_solve(inv_model, respiro_forzato(:,32), respiro_forzato(:,k));
    subplot(2,5,i)
    %frame=i;
    %title(['Frame ',num2str(frame)])
    img.calc_colours.ref_level= X;
    img.calc_colours.clim= Y;
    cb = colorbar; 
    t_l=linspace(1,255,10);
    set(cb,'YTick', t_l'); set(cb,'YTickLabel', t_v');
    maxima_forz=[maxima_forz, max(img.elem_data)];
    show_fem(img,[1,1]) 
    k=k+1;
    i=i+1;
end
%%
k=18;
img=inv_solve(inv_model, respiro_forzato(:,32), respiro_forzato(:,k));
img.calc_colours.ref_level= 0;
img.calc_colours.clim= Y;
cb = colorbar; 
t_l=linspace(1,255,10);
set(cb,'YTick', t_l'); set(cb,'YTickLabel', t_v');
title(['\fontsize{17}Frame ',num2str(k)])
show_fem(img,[1,1]) 
%%
plot(maxima_forz(2:100))

%% 
k=90;
i=1;
while i<16
    img=inv_solve(inv_model, respiro_forzato(:,32), respiro_forzato(:,k));
    subplot(3,5,i)
    frame=k;
    title(['Frame ',num2str(frame)])
    img.calc_colours.ref_level= X;
    img.calc_colours.clim= Y;
    cb = colorbar; 
    t_l=linspace(1,255,10);
    set(cb,'YTick', t_l'); set(cb,'YTickLabel', t_v');
    %maxima_forz=[maxima_forz, max(img.elem_data)];
    show_fem(img,[1,1]) 
    k=k+1;
    i=i+1;
end %X=-591, Y=2225
%%
plot(1:100, maxima_forz(1:100), '--','LineWidth',1.5)
hold on
%plot(11,maxima_forz(11),'rx', 'LineWidth',1.5,'MarkerSize',10)
%plot(27,maxima_forz(27),'rx','LineWidth',1.5, 'MarkerSize',10)
%plot(39,maxima_forz(39),'rx','LineWidth',1.5, 'MarkerSize',10)
%plot(50,maxima_forz(50),'rx','LineWidth',1.5, 'MarkerSize',10)
%plot(63,maxima_forz(63),'rx','LineWidth',1.5 ,'MarkerSize',10)
%plot(77,maxima_forz(77),'rx','LineWidth',1.5, 'MarkerSize',10)

plot(1:100,y(1:100),'r','LineWidth',1.5)
legend('Raw data','Filtered Data')
title('Maximum Impedance during forced breath')
xlabel('Time [s]')
ylabel('Maximum relative impedance variation |Z| [Ohm]')
legend
grid on
hold off
%%
%%
plot(maxima_forz(1:100),'b--')
hold on
plot(envMeanF(1:100),'r','LineWidth',1.5)
legend('\fontsize{17}Max. Rel. Impedance variation over time','\fontsize{17}Envelope')
xlabel('\fontsize{17}Time [s]')
ylabel('\fontsize{17}Maximum Relative Impedance Variation |Z| [Ohm]')
title('\fontsize{17}100s forced breathing')
grid on


%% moving average
t = linspace(0,100,1);
rng default
windowSize = 3; 
b = (1/windowSize)*ones(1,windowSize);
a = 1;

y = filter(b,a,maxima_forz);
disp(y)

%% inviluppo
envHigh=[];
envLow=[];
x=maxima_tot';
[envHigh, envLow] = envelope(x,'peak');
envMean = (envHigh+envLow)/2;
%% inviluppo respiro forzato
envHighF=[];
envLowF=[];
x=maxima_forz';
[envHighF, envLowF] = envelope(x,'peak');
envMeanF = (envHighF+envLowF)/2;
%%
% Find upper and lower envelopes of a given signal
% The idea is from Envelope1.1 by Lei Wang, but here it works well when the signal contains
% successive equal samples and also includes first and last samples of the signal in the envelopes.
% inputs:
%   sig: vector of input signal
%   method: method of interpolation (defined as in interp1)
% outputs:
%   upperenv: upper envelope of the input signal
%   lowerenv: lower envelope of the input signal
function [upperenv lowerenv] = envelope(sig, method)
if nargin == 1 
    method = 'linear';
end
upperind = find(diff(sign(diff(sig))) < 0) + 1;
lowerind = find(diff(sign(diff(sig))) > 0) + 1;
f = 1;
l = length(sig);
try
    upperind = [f upperind l];
    lowerind = [f lowerind l];
catch 
    upperind = [f; upperind; l];
    lowerind = [f; lowerind; l];
end
xi = f : l;
upperenv = interp1(upperind, sig(upperind), xi, method, 'extrap');
lowerenv = interp1(lowerind, sig(lowerind), xi, method, 'extrap');
end